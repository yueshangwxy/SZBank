{"remainingRequest":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\src\\views\\indicators\\assetSearch\\assetSearch.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\src\\views\\indicators\\assetSearch\\assetSearch.vue","mtime":1651838218327},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650772030926},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650772030306},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650772030926},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650772056629}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 首页传来的关键字\r\n      keywords: '',\r\n      tabList: [\r\n        { label: \"全部表\", name: \"all\" },\r\n        { label: \"我的表\", name: \"mine\" },\r\n      ],\r\n      activeTab: \"all\",\r\n      // 树形控件\r\n      filterText: \"\",\r\n      defaultProps: {\r\n        id: \"contentsId\",\r\n        children: \"children\",\r\n        label: \"name\",\r\n      },\r\n      treeData: [],\r\n      treeDataAll: [],\r\n      treeDataMine: [],\r\n      // 目录列表\r\n      catalogueList: [],\r\n      // 资产类型\r\n      assetType: \"all\",\r\n      // 一级目录\r\n      firstType: \"all\",\r\n      firstList: [],\r\n      // 二级目录\r\n      secondType: \"all\",\r\n      secondList: [],\r\n      // 三级目录\r\n      thirdType: \"all\",\r\n      thirdList: [],\r\n      // 精准筛选\r\n      // 属主部门\r\n      deptCode: '',\r\n      table: {\r\n        project: ''\r\n      },\r\n      api: {\r\n        application: ''\r\n      },\r\n      target: {\r\n        targetName: '',\r\n        targetCode: '',\r\n        targetType: '',\r\n        classifyOne: '',\r\n        classifyTwo: '',\r\n      },\r\n      label: {\r\n        classifyName: '',\r\n        objectCode: '',\r\n        fromCode: '',\r\n      },\r\n      // 列表部分\r\n      tableData: [],\r\n      // 收藏\r\n      save: true,\r\n      // 分页\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      total: 50,\r\n      // 数据预览\r\n      dataPreVis: false,\r\n      preDataList: [],\r\n      preDataProp: [],\r\n      // 申请权限\r\n      authorityVis: false,\r\n      // 加入购物车参数\r\n      request: {\r\n        assetId: \"\",\r\n        beginTime: \"\",\r\n        endTime: \"\",\r\n      },\r\n      // 直接申请\r\n      directApplyVis: false,\r\n      daterange: \"\",\r\n      radio: \"2\",\r\n      // 提示弹窗\r\n      tipDialog: false,\r\n\r\n      nodeData: [],\r\n      // 应用列表\r\n      appList: [],\r\n      // 指标类型列表\r\n      targetTypeList: [],\r\n      // 一级分类列表\r\n      classifyOneList: [],\r\n      // 二级分类列表\r\n      classifyTwoList: [],\r\n      // 部门树\r\n      deptTreeList: [],\r\n    };\r\n  },\r\n  watch: {\r\n    $route(to, from) {\r\n      console.log(to, from, \"$route\");\r\n      this.getRouteData();\r\n    },\r\n    save(val) {\r\n      console.log(val);\r\n    },\r\n    // 节点过滤\r\n    filterText(val) {\r\n      this.$refs.tree.filter(val);\r\n    },\r\n    // 树状图tab\r\n    activeTab(val) {\r\n      if (val === \"all\") {\r\n        this.treeData = this.treeDataAll;\r\n        this.getListByKeywords()\r\n      } else {\r\n        this.treeData = this.treeDataMine;\r\n        this.getListByKeywords()\r\n      }\r\n    },\r\n    // 目录联动\r\n    // 资产类型\r\n    assetType(val) {\r\n      if (val === \"all\") {\r\n        this.thirdList = [];\r\n      } else if (val === \"table\") {\r\n        this.secondType = \"all\";\r\n      } else if (val === \"api\") {\r\n        this.secondType = \"all\";\r\n      } else if (val === \"target\") {\r\n        this.secondType = \"all\";\r\n      } else if (val === \"label\") {\r\n        this.secondType = \"all\";\r\n      }\r\n    },\r\n    // 一级\r\n    firstType(val) {\r\n      let data;\r\n      data = this.firstList.filter(item=>{\r\n          return item.contentsId == val\r\n      })\r\n      if(data.length<1) {\r\n          this.secondList = []\r\n      }else {\r\n          this.secondList = JSON.parse(JSON.stringify(data[0].children))\r\n          if(this.secondList.length>0) {\r\n              this.secondList.unshift({\r\n                  contentsId: 'all',\r\n                  name: '全部',\r\n                  children: []\r\n              })\r\n          }\r\n      }\r\n    },\r\n    // 二级\r\n    secondType(val) {\r\n      let data;\r\n      data = this.secondList.filter(item=>{\r\n          return item.contentsId == val\r\n      })\r\n      console.log(data,333);\r\n      if(data.length<1) {\r\n          this.thirdList = []\r\n      }else {\r\n          this.thirdList = JSON.parse(JSON.stringify(data[0].children))\r\n          if(this.thirdList.length>0) {\r\n              this.thirdList.unshift({\r\n                  contentsId: 'all',\r\n                  name: '全部',\r\n                  children: []\r\n              })\r\n          }\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    // 首页跳转\r\n    this.getRouteData();\r\n    // 树状图初始数据\r\n    this.$api.getAllCatalogueList({}).then(res => {\r\n        this.treeData = res\r\n        this.treeDataAll = res\r\n    })\r\n    // 我的表目录树\r\n    this.$api.getAuthTree({}).then(res => {\r\n      this.treeDataMine = res.data\r\n    })\r\n    // 全部目录 \r\n    this.$api.getAllCatalogueList({}).then(res => {\r\n        console.log(res,'chushihua');\r\n        this.firstList = res\r\n        this.firstList.unshift({\r\n            contentsId: 'all',\r\n            name: '全部',\r\n            children: []\r\n        })\r\n    })\r\n    // 查询所有应用   appList\r\n    // 查询指标类型, 一级分类，二级分类      \r\n    // 查询部门树    \r\n    this.$api.getAppList({}).then(res => {\r\n      this.appList = res.data\r\n    })\r\n    this.$api.getTargetSelect({}).then(res => {\r\n      this.targetTypeList = res.data.targetTypeList\r\n      this.classifyOneList = res.data.classifyOneList\r\n      this.classifyTwoList = res.data.classifyTwoList\r\n    })\r\n    this.$api.getDeptTree({}).then(res => {\r\n      this.deptTreeList = res.data\r\n    })\r\n    // 初始化列表\r\n    this.getListByKeywords();\r\n\r\n    // 数据预览\r\n    this.preDataProp = [\r\n      {\r\n        prop: \"A1\",\r\n        label: \"A1\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"A2\",\r\n        label: \"A2\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"A3\",\r\n        label: \"A3\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"A4\",\r\n        label: \"A4\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"A5\",\r\n        label: \"A5\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"A6\",\r\n        label: \"A6\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"A7\",\r\n        label: \"A7\",\r\n        align: \"center\",\r\n      },\r\n    ];\r\n    this.preDataList = [\r\n      {\r\n        A1: \"XXXXXXXXX\",\r\n        A2: \"XXXXXXXXX\",\r\n        A3: \"XXXXXXXXX\",\r\n        A4: \"XXXXXXXXX\",\r\n        A5: \"XXXXXXXXX\",\r\n        A6: \"XXXXXXXXX\",\r\n        A7: \"XXXXXXXXX\",\r\n      },\r\n      {\r\n        A1: \"XXXXXXXXX\",\r\n        A2: \"XXXXXXXXX\",\r\n        A3: \"XXXXXXXXX\",\r\n        A4: \"XXXXXXXXX\",\r\n        A5: \"XXXXXXXXX\",\r\n        A6: \"XXXXXXXXX\",\r\n        A7: \"XXXXXXXXX\",\r\n      },\r\n      {\r\n        A1: \"XXXXXXXXX\",\r\n        A2: \"XXXXXXXXX\",\r\n        A3: \"XXXXXXXXX\",\r\n        A4: \"XXXXXXXXX\",\r\n        A5: \"XXXXXXXXX\",\r\n        A6: \"XXXXXXXXX\",\r\n        A7: \"XXXXXXXXX\",\r\n      },\r\n      {\r\n        A1: \"XXXXXXXXX\",\r\n        A2: \"XXXXXXXXX\",\r\n        A3: \"XXXXXXXXX\",\r\n        A4: \"XXXXXXXXX\",\r\n        A5: \"XXXXXXXXX\",\r\n        A6: \"XXXXXXXXX\",\r\n        A7: \"XXXXXXXXX\",\r\n      },\r\n      {\r\n        A1: \"XXXXXXXXX\",\r\n        A2: \"XXXXXXXXX\",\r\n        A3: \"XXXXXXXXX\",\r\n        A4: \"XXXXXXXXX\",\r\n        A5: \"XXXXXXXXX\",\r\n        A6: \"XXXXXXXXX\",\r\n        A7: \"XXXXXXXXX\",\r\n      },\r\n    ];\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    getRouteData() {\r\n      //   console.log(this.$route.query);\r\n      if (this.$route.query.data != undefined) {\r\n        if (typeof this.$route.query.data == \"number\") {\r\n          // 1 表资产 2 API资产 3 指标资产 4 标签资产\r\n          if (this.$route.query.data == 1) {\r\n            this.assetType = \"table\";\r\n          } else if (this.$route.query.data == 2) {\r\n            this.assetType = \"api\";\r\n          } else if (this.$route.query.data == 3) {\r\n            this.assetType = \"target\";\r\n          } else if (this.$route.query.data == 4) {\r\n            this.assetType = \"label\";\r\n          }\r\n        } else if (typeof this.$route.query.data == \"string\") {\r\n          this.keywords = this.$route.query.data\r\n          // 搜索\r\n          if (this.$route.query.from == \"home\") {\r\n            //   从首页搜索\r\n            console.log(this.$route.query.data, \"首页搜索\");\r\n            var index = this.$route.query.index\r\n            if (index != undefined) {\r\n                // 0~3 表数据资产 4~6 指标数据资产 7~9 标签数据资产\r\n                if (index == 0 || index == 1 || index == 2 || index == 3) {\r\n                    this.assetType = \"table\";\r\n                } else if (index == 4 || index == 5 || index == 6) {\r\n                    this.assetType = \"target\";\r\n                } else if (index == 7 || index == 8 || index == 9) {\r\n                    this.assetType = \"label\";\r\n                }\r\n                this.firstType = this.$route.query.firstDir\r\n                this.secondType = this.$route.query.secondDir\r\n                this.thirdType = (this.$route.query.index + 1).toString()\r\n                console.log(this.secondType,'this.secondType')\r\n                console.log(this.thirdType,'this.thirdType')\r\n            }\r\n            console.log(this.$route.query.index)\r\n          } else if (this.$route.query.from == \"other\") {\r\n            //   从其他页搜索\r\n            console.log(this.$route.query.data, \"其他页搜索\");\r\n          }\r\n          // 初始化列表\r\n          this.getListByKeywords();\r\n        }\r\n      }\r\n    },\r\n    // 树状图tab\r\n    handleClick(tab, event) {\r\n      console.log(tab, event);\r\n    },\r\n    // 节点过滤\r\n    filterNode(value, data) {\r\n      if (!value) return true;\r\n      return data.name.indexOf(value.toString()) !== -1;\r\n    },\r\n    // 节点点击   --- 树状图节点点击调接口重新查询列表\r\n    handleNodeClick(data,node) {\r\n      if (!data.children || data.children.length == 0) {\r\n        this.thirdType = data.contentsId\r\n        this.secondType = node.parent.data.contentsId\r\n        this.firstType = node.parent.parent.data.contentsId\r\n        const request = {\r\n          assetType: this.assetType,\r\n          contentsOne: this.firstType,\r\n          contentsTwo: this.secondType,\r\n          contentsThree: this.thirdType,\r\n        }\r\n        this.$api.getAssetPage(request).then((res) => {\r\n          this.total = res.total\r\n          if(this.assetType === 'table') {\r\n            this.tableData = res.tableList\r\n          } else if (this.assetType === 'api') {\r\n            this.tableData = res.apiList\r\n          } else if (this.assetType === 'target') {\r\n            this.tableData = res.targetList\r\n          } else if (this.assetType === 'label') {\r\n            this.tableData = res.labelList\r\n          } else {\r\n            this.tableData = res.obj;\r\n          }\r\n        })\r\n      }\r\n    },\r\n    // 列表查询\r\n    getListByKeywords() {\r\n      this.keywords = localStorage.getItem('searchKeyWords')\r\n      let request = {\r\n        keywords: this.keywords,\r\n        page: this.currentPage,\r\n        size: this.pageSize,\r\n        assetType: this.assetType,\r\n        contentsOne: this.firstType,\r\n        contentsTwo: this.secondType,\r\n        contentsThree: this.thirdType,\r\n        table: this.table,\r\n        api: this.api,\r\n        target: this.target,\r\n        label: this.label,\r\n        deptCode: this.deptCode,\r\n      }\r\n      console.log(request);\r\n      this.$api.getListByKeywords(request).then((res) => {\r\n        this.total = res.total\r\n        if(this.assetType === 'table') {\r\n          this.tableData = res.tableList\r\n        } else if (this.assetType === 'api') {\r\n          this.tableData = res.apiList\r\n        } else if (this.assetType === 'target') {\r\n          this.tableData = res.targetList\r\n        } else if (this.assetType === 'label') {\r\n          this.tableData = res.labelList\r\n        } else {\r\n          this.tableData = res.obj;\r\n        }\r\n      });\r\n    },\r\n    // 分页\r\n    handleCurrentChange(val) {\r\n      this.currentPage = val\r\n      this.getListByKeywords()\r\n    },\r\n    // 我的购物车\r\n    jumpShopCar() {\r\n      this.$router.push({\r\n        path: \"/myShopCar/index\",\r\n      });\r\n    },\r\n    // 我的收藏\r\n    jumpCollection() {\r\n      this.$router.push({\r\n        path: \"/myCollection/index\",\r\n      });\r\n    },\r\n    // 详情查看\r\n    viewDetails(item) {\r\n      this.$api\r\n        .getAssetsDetail({\r\n          assetType: item.assetType,\r\n          id: item.id,\r\n          targetCode: item.targetCode,\r\n          labelCode: item.labelCode\r\n        })\r\n        .then((res) => {\r\n          console.log(res, item.assetType);\r\n          let queryData = {}\r\n          if(item.assetType==='table') {\r\n            queryData = res.data\r\n          } else {\r\n            queryData = res\r\n          }\r\n          this.$router.push({\r\n            path: \"/detailsView/\" + item.assetType,\r\n            query: {\r\n              res: queryData,\r\n            },\r\n          });\r\n        });\r\n    },\r\n    // 数据预览\r\n    previewData(item) {\r\n      this.dataPreVis = true;\r\n    },\r\n    // 添加收藏\r\n    addFavorite(item) {\r\n        this.$api.addFavorite({\r\n            assetId: item.assetId,\r\n            assetType: item.assetType,\r\n        }).then(res => {\r\n            this.$message.success('添加收藏成功!')\r\n            this.getListByKeywords();\r\n        })\r\n    },\r\n    // 删除收藏\r\n    delFavorite(item) {\r\n        this.$api.delFavorite({\r\n            assetId: item.assetId,\r\n            assetType: item.assetType,\r\n        }).then(res => {\r\n            this.$message.success('取消收藏成功!')\r\n            this.getListByKeywords();\r\n        })\r\n    },\r\n    // 申请访问\r\n    applyForAccess(item) {\r\n      this.$api.applyForAccess({\r\n        apiId: item.id\r\n      }).then(res => {\r\n        this.$message.success('申请成功!')\r\n        this.getListByKeywords();\r\n      })\r\n    },\r\n    // 申请权限\r\n    applyForAuthority(item) {\r\n      this.authorityVis = true;\r\n      this.request.assetId = item.id\r\n    },\r\n    // 加入购物车\r\n    addShopCar() {\r\n      this.$api.addShopCar(this.request).then((res) => {\r\n        console.log(res);\r\n        this.authorityVis = false;\r\n      });\r\n    },\r\n    // 直接申请\r\n    directApply() {\r\n      this.authorityVis = false;\r\n      this.directApplyVis = true;\r\n    },\r\n    // 确定申请\r\n    confirmApply() {\r\n      // 关闭申请弹窗\r\n      this.directApplyVis = false;\r\n      // 直接申请权限接口\r\n      this.$api.applyForAuthority({\r\n        id: this.request.assetId\r\n      })\r\n        .then((res) => {\r\n          console.log(res);\r\n          this.tipDialog = true;\r\n        })\r\n        .then(() => {\r\n          this.getListByKeywords()\r\n          // 提示框展示三秒自动关闭\r\n          setTimeout(() => {\r\n            this.tipDialog = false;\r\n          }, 3000);\r\n        });\r\n    },\r\n  },\r\n};\r\n",null]}