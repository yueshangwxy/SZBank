{"remainingRequest":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\pncui-portal-fashional\\src\\views\\dashboard\\indicatorboard\\DepositAnalysis.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\pncui-portal-fashional\\src\\views\\dashboard\\indicatorboard\\DepositAnalysis.vue","mtime":499162500000},{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport echarts from 'echarts'\nimport { mapGetters } from 'vuex'\nimport { depositAnalysis } from '../../../api/dashboard/dashboard.js'\nimport { getYesterday } from '@eladmin/utils/data_format'\n\nexport default {\n  name: 'DepositAnalysis',\n  props: {\n    className: {\n      type: String,\n      default: 'box-card'\n    },\n    width: {\n      type: String,\n      default: '100%'\n    },\n    height: {\n      type: String,\n      default: '100%'\n    },\n    autoResize: {\n      type: Boolean,\n      default: true\n    },\n    date: {\n      type: String,\n      default: getYesterday()\n    }\n  },\n  data() {\n    return {\n      chart: null,\n      sidebarElm: null,\n      chartData: {}\n    }\n  },\n  mounted() {\n    depositAnalysis(this.date).then(res => {\n        this.chartData = res.data\n        this.initChart()\n      }\n    )\n    window.addEventListener('resize', this.onResize)\n  },\n  computed: {\n    ...\n      mapGetters([\n        'sidebar'\n      ])\n  },\n  watch: {\n    sidebar: {\n      deep: true,\n      immediate: true,\n      handler:\n        function(newValue, oldValue) {\n          // console.log('=====watch>>', oldValue, newValue)\n          this.onResize()\n          // result为true，则表示是全部选中\n        }\n    }\n  },\n  beforeDestroy() {\n    if (!this.chart) {\n      return\n    }\n    this.chart.dispose()\n    this.chart = null\n  },\n  methods: {\n    setOptions({ data } = {}) {\n      this.chart.setOption({\n        tooltip: {\n          trigger: 'item',\n          formatter: function(params, ticket, callback) {\n            let res = ''\n            if (params.data.detail) {\n              res = params.data.detail.map(e => e.name + ':' + e.value).join('<br/>')\n            }\n            return res\n          }\n        },\n        legend: {\n          orient: 'vertical',\n          // left: 10,\n          x: '75%', // 图例距离左的距离\n          y: '20%', // 图例上下居中\n          data: data.map(e => e.name)\n        },\n        color: ['#F09937', '#489FF8', '#74C8C4'],\n        series: [\n          {\n            name: '存款结构',\n            type: 'pie',\n            radius: ['45%', '72%'],\n            center: ['35%', '50%'],\n            avoidLabelOverlap: false,\n            label: {\n              show: true,\n              formatter: '{d}%',\n              position: 'outside'\n            },\n            labelLine: {\n              show: true\n            },\n            emphasis: {\n              label: {\n                show: true,\n                fontSize: '15'\n              }\n            },\n            data: data\n          }\n        ]\n      })\n    },\n    onResize() {\n      if (this.chart) {\n        this.chart.resize()\n      }\n    },\n    initChart() {\n      console.log('开始绘制存款结构分析图表...')\n      this.chart = echarts.init(document.querySelector('#card-main-deposit-analysis'))\n      this.setOptions(this.chartData)\n    }\n  }\n}\n",null]}