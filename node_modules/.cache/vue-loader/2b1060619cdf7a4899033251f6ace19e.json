{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\portalHome\\workSheet.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\portalHome\\workSheet.vue","mtime":1655881738431},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters, mapState } from \"vuex\";\r\nimport Avatar from \"@eladmin/assets/images/avatar.png\";\r\nimport RoleSelect from \"@eladmin/components/RoleSelect\";\r\nimport ThemeSelect from \"@portal/components/ThemeSelect\";\r\nimport Logo from \"@portal/layout/components/Sidebar/Logo\";\r\nimport ProcessDetails from \"./workSheet/processDetails.vue\";\r\nimport ApiDetails from \"./workSheet/apiDetails.vue\";\r\nimport { isMiddleAdmin, isSuperAdmin } from \"@/utils/validator\";\r\n\r\nexport default {\r\n  name: \"myWorkSheet\",\r\n  components: {\r\n    RoleSelect,\r\n    ThemeSelect,\r\n    Logo,\r\n    ProcessDetails,\r\n    ApiDetails,\r\n  },\r\n  data() {\r\n    return {\r\n      Avatar: Avatar,\r\n      logo: require(\"../../../../public/images/logo.png\"),\r\n      activeTab: \"\",\r\n      tabList: [\r\n        {\r\n          name: \"asset\",\r\n          label: \"数据资产平台\",\r\n        },\r\n        {\r\n          name: \"service\",\r\n          label: \"数据服务平台\",\r\n        },\r\n        {\r\n          name: \"laboratory\",\r\n          label: \"数据查询平台\",\r\n        },\r\n      ],\r\n      // radio\r\n      radio: 0,\r\n      // name: '',\r\n      // dept: '',\r\n      apiAddress: \"\",\r\n      apiName: \"\",\r\n      status: \"\",\r\n      serviceStatus:\"\",\r\n      // date: '',\r\n      searchInput: \"\",\r\n      dept: \"\",\r\n      dateValue: \"\",\r\n      startTime: \"\",\r\n      endTime: \"\",\r\n      // 部门树\r\n      deptTreeList: [],\r\n      // 表格\r\n      tableData: [],\r\n      propList: [],\r\n      // 分页\r\n      pageSize: 10,\r\n      total: 10,\r\n      currentPage: 1,\r\n      // 审批弹窗\r\n      approveDialog: false,\r\n      ruleForm: {\r\n        apprComment: \"\",\r\n      },\r\n      rules: {\r\n        apprComment: [\r\n          { required: true, message: \"请输入审批意见\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n      selectedRow: {},\r\n      // 应用服务关系\r\n      appServiceVis: false,\r\n      activeName: \"first\",\r\n      diaDataProp: [],\r\n      diaDataList: [],\r\n      curAppCode: \"\",\r\n      // 审批链路\r\n      linkVisible: false,\r\n      linkDataProp: [],\r\n      linkDataList: [],\r\n      // 流程详情弹窗\r\n      detailVis: false,\r\n      tableId: \"\",\r\n      // 服务审批\r\n      serviceApprove: false,\r\n      serviceForm: {\r\n        approveStatus: \"\",\r\n      },\r\n      serviceRules: {\r\n        approveStatus: [\r\n          { required: true, message: \"请选择审批状态\", trigger: \"change\" },\r\n        ],\r\n      },\r\n      // api详情弹窗\r\n      apiDetailVis: false,\r\n      apiId: \"\",\r\n      //实验室详情弹窗\r\n      labDetailVis: false,\r\n      labDetail: {},\r\n      labApproveDialog: false,\r\n      // 数据资产平台  流程审批开关\r\n      processFlag: true,\r\n      labLinkVisible: false,\r\n      labLinkDataProp : [],\r\n    };\r\n  },\r\n  watch: {\r\n    activeTab(val) {\r\n      if (val === \"asset\") {\r\n        this.propList = [\r\n          {\r\n            prop: \"PROC_INST_ID\",\r\n            label: \"申请编号\",\r\n          },\r\n          {\r\n            prop: \"DEPT_NAME\",\r\n            label: \"申请部门\",\r\n          },\r\n          {\r\n            prop: \"CRT_USER\",\r\n            label: \"申请人\",\r\n          },\r\n          {\r\n            prop: \"TABLE_NAME\",\r\n            label: \"表英文名\",\r\n          },\r\n          {\r\n            prop: \"TABLE_COMMENT\",\r\n            label: \"表中文名\",\r\n          },\r\n          {\r\n            prop: \"EFF_BEGIN_TIME\",\r\n            label: \"权限开始日期\",\r\n          },\r\n          {\r\n            prop: \"EFF_END_TIME\",\r\n            type: \"endTime\",\r\n            label: \"权限结束日期\",\r\n          },\r\n          {\r\n            prop: \"CRT_DATE\",\r\n            label: \"申请时间\",\r\n          },\r\n          {\r\n            prop: \"STATUS_DESC\",\r\n            label: \"状态\",\r\n            type: \"tag\",\r\n            tagType: (row) => {\r\n              return row.STATUS_DESC === \"已通过\"\r\n                ? \"info\"\r\n                : row.STATUS_DESC === \"草稿\"\r\n                ? \"\"\r\n                : row.STATUS_DESC === \"待审批\"\r\n                ? \"warning\"\r\n                : \"danger\";\r\n            },\r\n            render: (row) => {\r\n              return row.STATUS_DESC;\r\n            },\r\n          },\r\n        ];\r\n        this.radio = 0;\r\n        this.reset();\r\n        this.initList();\r\n      } else if (val === \"service\") {\r\n        this.propList = [\r\n          {\r\n            prop: \"indexName\",\r\n            label: \"api名称\",\r\n          },\r\n          {\r\n            prop: \"apiDescription\",\r\n            label: \"api描述\",\r\n          },\r\n          {\r\n            prop: \"applicantName\",\r\n            label: \"申请人\",\r\n          },\r\n          {\r\n            prop: \"dept\",\r\n            label: \"申请部门\",\r\n          },\r\n          {\r\n            prop: \"applyDate\",\r\n            label: \"申请时间\",\r\n          },\r\n          {\r\n            prop: \"status\",\r\n            label: \"状态\",\r\n            type: \"tag\",\r\n            tagType: (row) => {\r\n              return row.status == 1\r\n                ? \"info\"\r\n                : row.status == 2\r\n                ? \"warning\"\r\n                : \"danger\";\r\n            },\r\n            render: (row) => {\r\n              return row.status == 1\r\n                ? \"通过\"\r\n                : row.status == 2\r\n                ? \"申请中\"\r\n                : \"拒绝\";\r\n            },\r\n          },\r\n        ];\r\n        this.radio = 0;\r\n        this.reset();\r\n        this.initList();\r\n      } else if (val === \"laboratory\") {\r\n        this.propList = [\r\n          {\r\n            prop: \"id\",\r\n            label: \"申请编号\",\r\n          },\r\n          {\r\n            prop: \"tableName\",\r\n            label: \"表或视名(包含项目)\",\r\n          },\r\n          {\r\n            prop: \"sqlTextShow\",\r\n            label: \"申请口径\",\r\n          },\r\n          {\r\n            prop: \"applyDescription\",\r\n            label: \"申请说明\",\r\n          },\r\n          {\r\n            prop: \"applyUserName\",\r\n            label: \"申请人\",\r\n          },\r\n          {\r\n            prop: \"applyDeptName\",\r\n            label: \"申请人部门\",\r\n          },\r\n          {\r\n            prop: \"applyTimeShow\",\r\n            label: \"申请时间\",\r\n          },\r\n          {\r\n            prop: \"applyStatus\",\r\n            label: \"申请状态\",\r\n            type: \"tag\",\r\n            tagType: (row) => {\r\n              return row.applyStatus === \"03\" ||\r\n                row.applyStatus === \"05\" ||\r\n                row.applyStatus === \"06\" ||\r\n                row.applyStatus === \"07\"\r\n                ? \"info\"\r\n                : row.applyStatus === \"00\"\r\n                ? \"warning\"\r\n                : \"danger\";\r\n            },\r\n            render: (row) => {\r\n              return row.applyStatus === \"03\" ||\r\n                row.applyStatus === \"05\" ||\r\n                row.applyStatus === \"06\" ||\r\n                row.applyStatus === \"07\"\r\n                ? \"已通过\"\r\n                : row.applyStatus === \"00\"\r\n                ? \"待审批\"\r\n                : \"已拒绝\";\r\n            },\r\n          },\r\n        ];\r\n        this.radio = 0;\r\n        this.reset();\r\n        this.initList();\r\n      }\r\n    },\r\n    radio(val) {\r\n      if (val == 0) {\r\n        this.reset();\r\n        this.initList();\r\n        console.log(\"我的申请\");\r\n      } else if (val == 1) {\r\n        this.reset();\r\n        this.initList();\r\n        console.log(\"待我审批\");\r\n      } else {\r\n        this.reset();\r\n        this.initList();\r\n        console.log(\"我已审批\");\r\n      }\r\n    },\r\n    dateValue(val) {\r\n      if (val) {\r\n        this.startTime = this.$formatDate(val[0]);\r\n        this.endTime = this.$formatDate(val[1]);\r\n      } else {\r\n        this.startTime = \"\";\r\n        this.endTime = \"\";\r\n      }\r\n    },\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    this.activeTab = \"asset\";\r\n    this.$api.getDeptTree({}).then((res) => {\r\n      this.deptTreeList = res.data;\r\n    }); /* 办理环节 0 运行 1 已处理，结束  2 退回 */\r\n    this.linkDataProp = [\r\n      {\r\n        prop: \"status\",\r\n        label: \"办理环节\",\r\n        type: \"tag\",\r\n        align: \"center\",\r\n        tagType: (row) => {\r\n          return row.status === \"1\"\r\n            ? \"info\"\r\n            : row.status === \"0\"\r\n            ? \"warning\"\r\n            : \"danger\";\r\n        },\r\n        render: (row) => {\r\n          return row.status === \"1\"\r\n            ? \"已处理，结束\"\r\n            : row.status === \"0\"\r\n            ? \"运行\"\r\n            : \"退回\";\r\n        },\r\n      },\r\n      {\r\n        prop: \"assignee\",\r\n        label: \"办理人\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"apprComment\",\r\n        label: \"办理意见\",\r\n      },\r\n      {\r\n        prop: \"duration\",\r\n        label: \"办理时效(工作日)\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"updDateStr\",\r\n        label: \"更新时间\",\r\n      },\r\n    ];\r\n    this.labLinkDataProp = [\r\n      {\r\n        prop: \"status\",\r\n        label: \"办理环节\",\r\n        type: \"tag\",\r\n        align: \"center\",\r\n        tagType: (row) => {\r\n          return row.status === \"03\"||row.status === \"05\"||row.status === \"06\"||row.status === \"07\"\r\n              ? \"info\"\r\n              : row.status === \"00\"\r\n                  ? \"warning\"\r\n                  : \"danger\";\r\n        },\r\n        render: (row) => {\r\n          return row.status === \"03\"||row.status === \"05\"||row.status === \"06\"||row.status === \"07\"\r\n              ? \"已处理，结束\"\r\n              : row.status === \"00\"\r\n                  ? \"运行\"\r\n                  : \"退回\";\r\n        },\r\n      },\r\n      {\r\n        prop: \"assignee\",\r\n        label: \"办理人\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"apprComment\",\r\n        label: \"办理意见\",\r\n      },\r\n      {\r\n        prop: \"duration\",\r\n        label: \"办理时效\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        prop: \"updDateStr\",\r\n        label: \"更新时间\",\r\n      },\r\n    ];\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"sidebar\", \"device\", \"user\", \"baseApi\"]),\r\n    ...mapState({\r\n      showBreadcrumb: (state) => state.settings.showBreadcrumb,\r\n    }),\r\n    showLogo() {\r\n      return this.$store.state.settings.sidebarLogo;\r\n    },\r\n    show: {\r\n      get() {\r\n        return this.$store.state.settings.showSettings;\r\n      },\r\n      set(val) {\r\n        this.$store.dispatch(\"settings/changeSetting\", {\r\n          key: \"showSettings\",\r\n          value: val,\r\n        });\r\n      },\r\n    },\r\n    isSuperLogin() {\r\n      return isMiddleAdmin() || isSuperAdmin();\r\n    },\r\n    isSuperLogin2(){\r\n      return isSuperAdmin();\r\n    }\r\n  },\r\n  methods: {\r\n    // 正常时间\r\n    transEndTime(time) {\r\n      if (time && time.includes(\"9999\")) {\r\n        return \"永久\";\r\n      } else {\r\n        return time;\r\n      }\r\n    },\r\n    // 退出登录提示\r\n    open() {\r\n      this.$confirm(\"确定注销并退出系统吗？\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      }).then(() => {\r\n        this.logout();\r\n      });\r\n    },\r\n    // 退出登录\r\n    logout() {\r\n      this.$store.dispatch(\"LogOut\").then(() => {\r\n        location.reload();\r\n      });\r\n    },\r\n    // 重置\r\n    reset() {\r\n      this.searchInput = \"\";\r\n      this.dept = \"\";\r\n      this.apiAddress = \"\";\r\n      this.apiName = \"\";\r\n      this.status = \"\";\r\n      this.serviceStatus = \"\";\r\n      this.dateValue = \"\";\r\n    },\r\n    // 列表查询  -- 从第一页开始查  搜索按钮\r\n    initList() {\r\n      this.currentPage = 1;\r\n      this.queryList();\r\n    },\r\n    // 列表查询 -- 当前页\r\n    queryList() {\r\n      if (this.activeTab === \"asset\") {\r\n        console.log(\"asset查询\");\r\n        this.queryProcessList();\r\n      } else if (this.activeTab === \"service\") {\r\n        console.log(\"service查询\");\r\n        this.queryServiceList();\r\n      } else if (this.activeTab === \"laboratory\") {\r\n        console.log(\"laboratory查询\");\r\n        this.queryLaboratoryList();\r\n      }\r\n    },\r\n    // 列表查询  数据资产平台  -- 流程\r\n    queryProcessList() {\r\n      let request = {\r\n        page: String(this.currentPage),\r\n        size: String(this.pageSize),\r\n        deptCode: this.dept,\r\n        name: this.searchInput,\r\n        crtDateBeg: this.startTime,\r\n        crtDateEnd: this.endTime,\r\n      };\r\n      console.log(request);\r\n      if (this.radio == 0) {\r\n        request.state = this.status;\r\n        this.$api.appliedProcess(request).then((res) => {\r\n          console.log(res);\r\n          let data = res.data;\r\n          this.tableData = data.records;\r\n          this.total = data.total;\r\n        });\r\n      } else if (this.radio == 1) {\r\n        // 待我审批\r\n        this.$api.waitApprove(request).then((res) => {\r\n          console.log(res);\r\n          let data = res.data;\r\n          this.tableData = data.records;\r\n          this.total = data.total;\r\n        });\r\n      } else if (this.radio == 2) {\r\n        // 我已审批\r\n        this.$api.alreadyApprove(request).then((res) => {\r\n          console.log(res);\r\n          let data = res.data;\r\n          this.tableData = data.records;\r\n          this.total = data.total;\r\n        });\r\n      }\r\n    },\r\n    // 列表查询  数据服务平台\r\n    queryServiceList() {\r\n      console.log(\"service\");\r\n      let request = {\r\n        page: this.currentPage,\r\n        size: this.pageSize,\r\n        interfaceAds: this.apiAddress,\r\n        indexName: this.apiName,\r\n        beginTime: this.startTime,\r\n        endTime: this.endTime,\r\n        status: this.serviceStatus,\r\n      };\r\n      this.$api.qryServiceWorkSheet(request).then((res) => {\r\n        console.log(res);\r\n        this.tableData = res.data.records;\r\n        this.total = res.data.total;\r\n      });\r\n    },\r\n    // 列表查询 \r\n    queryLaboratoryList() {\r\n      console.log(\"laboratory\");\r\n      let request = {\r\n        pageNum: this.currentPage,\r\n        pageSize: this.pageSize,\r\n        beginTime: this.startTime,\r\n        endTime: this.endTime,\r\n        queryState: this.status,\r\n        dataType: this.radio,\r\n      };\r\n      this.$api.qryLabWorkSheet(request).then((res) => {\r\n        console.log(res);\r\n        this.tableData = res.data.records;\r\n        this.total = res.data.total;\r\n      });\r\n    },\r\n    // 详情\r\n    viewDetails(row) {\r\n      if (this.activeTab === \"asset\") {\r\n        this.tableId = row.BUSINESS_KEY;\r\n        this.detailVis = true;\r\n      } else if (this.activeTab === \"service\") {\r\n        this.apiId = row.apiId;\r\n        this.apiDetailVis = true;\r\n      } else if (this.activeTab === \"laboratory\") {\r\n        this.labDetail = row;\r\n        this.labDetailVis = true;\r\n      }\r\n    },\r\n    // 关闭详情\r\n    handleClose() {\r\n      this.detailVis = false;\r\n      this.apiDetailVis = false;\r\n      this.labDetailVis = false;\r\n    },\r\n    // 审批按钮\r\n    approveBtn(row) {\r\n      if (this.activeTab === \"laboratory\") this.labApproveDialog = true;\r\n      else this.approveDialog = true;\r\n      this.selectedRow = row;\r\n      this.$nextTick(() => {\r\n        this.$refs[\"ruleForm\"].resetFields();\r\n      });\r\n    },\r\n    // 审批  -- 通过\r\n    pass(formName) {\r\n      console.log(\"通过\", this.selectedRow.TASK_ID);\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid && this.processFlag) {\r\n          this.processFlag = false;\r\n          this.$api\r\n            .completeTask({\r\n              taskId: this.selectedRow.TASK_ID,\r\n              submitType: \"0\",\r\n              assignee: \"\",\r\n              apprComment: this.ruleForm.apprComment,\r\n            })\r\n            .then((res) => {\r\n              if (res.code == 0 || res.code == 200) {\r\n                this.approveDialog = false;\r\n                this.$message.success(res.msg);\r\n                this.queryProcessList();\r\n              } else {\r\n                this.$message.error(res.msg);\r\n              }\r\n              this.processFlag = true;\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 审批  -- 拒绝\r\n    reject(formName) {\r\n      console.log(\"拒绝\", this.selectedRow.TASK_ID);\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid && this.processFlag) {\r\n          this.processFlag = false;\r\n          this.$api\r\n            .completeTask({\r\n              taskId: this.selectedRow.TASK_ID,\r\n              submitType: \"1\",\r\n              assignee: \"\",\r\n              apprComment: this.ruleForm.apprComment,\r\n            })\r\n            .then((res) => {\r\n              if (res.code == 0 || res.code == 200) {\r\n                this.approveDialog = false;\r\n                this.$message.success(res.msg);\r\n                this.queryProcessList();\r\n              } else {\r\n                this.$message.error(res.msg);\r\n              }\r\n              this.processFlag = true;\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 实验室审批  -- 通过\r\n    labPass(formName) {\r\n      console.log(\"通过\", this.selectedRow.id);\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.$api\r\n            .labCompleteTask({\r\n              id: this.selectedRow.id,\r\n              applyState: \"03\",\r\n              approvalOpinion: this.ruleForm.apprComment,\r\n            })\r\n            .then((res) => {\r\n              if (res.returnCode == 0 || res.returnCode == 200) {\r\n                this.labApproveDialog = false;\r\n                this.$message.success(res.returnMsg);\r\n                this.queryLaboratoryList();\r\n              } else {\r\n                this.$message.error(res.returnMsg);\r\n              }\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 实验室审批  -- 拒绝\r\n    labReject(formName) {\r\n      console.log(\"拒绝\", this.selectedRow.id);\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.$api\r\n            .labCompleteTask({\r\n              id: this.selectedRow.id,\r\n              applyState: \"04\",\r\n              approvalOpinion: this.ruleForm.apprComment,\r\n            })\r\n            .then((res) => {\r\n              if (res.returnCode == 0 || res.returnCode == 200) {\r\n                this.labApproveDialog = false;\r\n                this.$message.success(res.returnMsg);\r\n                this.queryLaboratoryList();\r\n              } else {\r\n                this.$message.error(res.returnMsg);\r\n              }\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 实验室审批链路\r\n    labApproveLink(row) {\r\n      this.labLinkVisible = true;\r\n      this.$api.labApprovalLink({ id: row.id }).then((res) => {\r\n        //console.log(res, 233331111111111111111);\r\n        this.linkDataList = res.data;\r\n      });\r\n    },\r\n    // 审批链路\r\n    approveLink(row) {\r\n      console.log(row.PROC_INST_ID);\r\n      this.linkVisible = true;\r\n\r\n      this.$api.approvalLink({ procInstId: row.PROC_INST_ID }).then((res) => {\r\n        console.log(res, 23333);\r\n        this.linkDataList = res.data;\r\n      });\r\n    },\r\n    // 服务平台  -- 审批\r\n    applyForApiAuth(row) {\r\n      this.serviceApprove = true;\r\n      this.selectedRow = row;\r\n      this.$nextTick(() => {\r\n        this.$refs[\"serviceForm\"].resetFields();\r\n      });\r\n    },\r\n    // 服务平台审批确定\r\n    confirmApproval() {\r\n      this.$refs[\"serviceForm\"].validate((valid) => {\r\n        if (valid) {\r\n          this.$api\r\n            .applyForApiAuth({\r\n              id: this.selectedRow.id,\r\n              status: this.serviceForm.approveStatus,\r\n            })\r\n            .then((res) => {\r\n              if (res.code == 200 || res.code == 0) {\r\n                this.$message.success(res.msg);\r\n                this.queryList();\r\n                this.serviceApprove = false;\r\n              } else {\r\n                this.$message.error(res.msg);\r\n                this.serviceApprove = false;\r\n              }\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 应用服务关系\r\n    appService(row) {\r\n      console.log(\"应用服务关系\");\r\n      this.diaDataProp = [\r\n        {\r\n          prop: \"name\",\r\n          label: \"名称\",\r\n          align: \"center\",\r\n        },\r\n        {\r\n          prop: \"description\",\r\n          label: \"描述\",\r\n          align: \"center\",\r\n        },\r\n      ];\r\n      this.appServiceVis = true;\r\n      this.curAppCode = row.appCode;\r\n      this.$api\r\n        .qryAppService({\r\n          appCode: this.curAppCode,\r\n        })\r\n        .then((res) => {\r\n          console.log(res, 23333);\r\n          this.diaDataList = res.data;\r\n        });\r\n    },\r\n    // 弹窗tab\r\n    handleClick(tab, event) {\r\n      console.log(tab.name);\r\n      if (tab.name === \"first\") {\r\n        this.$api\r\n          .qryAppService({\r\n            appCode: this.curAppCode,\r\n          })\r\n          .then((res) => {\r\n            this.diaDataList = res.data;\r\n          });\r\n      } else {\r\n        this.$api\r\n          .qryAppAccessService({\r\n            appCode: this.curAppCode,\r\n          })\r\n          .then((res) => {\r\n            this.diaDataList = res.data;\r\n          });\r\n      }\r\n    },\r\n    // 分页\r\n    handleCurrentChange(val) {\r\n      console.log(val);\r\n      this.currentPage = val;\r\n      this.queryList();\r\n    },\r\n  },\r\n};\r\n",null]}