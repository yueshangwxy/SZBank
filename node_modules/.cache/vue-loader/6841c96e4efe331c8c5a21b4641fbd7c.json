{"remainingRequest":"D:\\SZBank\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\SZBank\\src\\views\\indicators\\dataServicePlatform\\applyForDoc.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\SZBank\\src\\views\\indicators\\dataServicePlatform\\applyForDoc.vue","mtime":1654824275284},{"path":"D:\\SZBank\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\SZBank\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\SZBank\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\SZBank\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport selectUser from \"./selectUser.vue\";\r\nexport default {\r\n  components: { selectUser },\r\n  data() {\r\n    return {\r\n      title: \"文件申请\",\r\n      editPage: true,\r\n      showSelectUser: false,\r\n      id: \"\",\r\n      ruleForm: {\r\n        name: \"\",\r\n        description: \"\",\r\n        overtime: \"\",\r\n        currentLimit: \"\",\r\n        type: \"\",\r\n        destinationAddress: \"\",\r\n        latestGenerationTime: \"\",\r\n        separator: \"\",\r\n        fileFormat: \"\",\r\n        serviceType: \"2\",\r\n        status: \"\",\r\n        dept: \"\",\r\n        dockName: \"\",\r\n        belongUser: \"\",\r\n        fieldList: \"\",\r\n        belongApplication: \"\",\r\n        belongApplicationName: \"\",\r\n        sitPath: \"\",\r\n        prePath: \"\",\r\n        serviceParamList: [\r\n          {\r\n            name: \"\",\r\n            type: \"\",\r\n            parameterType: \"\", // 1入参 2出参\r\n            description: \"\",\r\n            defaultValue: \"\",\r\n            isPass: \"\",\r\n          },\r\n        ],\r\n        applicationInfoList: [],\r\n      },\r\n      // 部门树\r\n      deptTree: [],\r\n      // 表单\r\n      labelPosition: \"top\",\r\n      rules: {\r\n        name: [{ required: true, message: \"请输入名称\", trigger: \"blur\" }],\r\n        description: [\r\n          { required: true, message: \"请输入描述\", trigger: \"blur\" },\r\n        ],\r\n        destinationAddress: [\r\n          { required: true, message: \"请输入目标地址\", trigger: \"blur\" },\r\n        ],\r\n        latestGenerationTime: [\r\n          { required: true, message: \"请选择时间\", trigger: \"change\" },\r\n        ],\r\n        separator: [\r\n          { required: true, message: \"请输入分隔符\", trigger: \"blur\" },\r\n        ],\r\n        fileFormat: [\r\n          { required: true, message: \"请选择格式\", trigger: \"change\" },\r\n        ],\r\n        status: [\r\n          { required: true, message: \"请选择接口状态\", trigger: \"change\" },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initData();\r\n  },\r\n  // beforeRouteLeave(to, from, next) {\r\n  //   if (to.name === \"myService\") {\r\n  //     this.$store.commit(\"SET_KEEPALIVE\", true);\r\n  //   } else {\r\n  //     this.$store.commit(\"SET_KEEPALIVE\", false);\r\n  //   }\r\n  //   next();\r\n  // },\r\n  // watch: {\r\n  //   $route(e) {\r\n  //     if (e.name === \"applyForDoc\") {\r\n  //       this.initData();\r\n  //     }\r\n  //   },\r\n  // },\r\n  methods: {\r\n    initData() {\r\n      this.editPage = this.$route.name === \"editDoc\" ? true : false;\r\n      if (this.editPage) {\r\n        this.title = this.$route.meta.title;\r\n      }\r\n      this.$api.findDeptTree({}).then((res) => {\r\n        this.deptTree = res.data;\r\n      });\r\n      if (this.$route.name === \"editDoc\") {\r\n        this.id = this.$route.query.id ? this.$route.query.id : \"\";\r\n        this.$api\r\n          .viewServiceDetail({\r\n            id: this.id,\r\n          })\r\n          .then((res) => {\r\n            this.ruleForm = res.data;\r\n          });\r\n      }\r\n    },\r\n    slectBelongUser(user) {\r\n      if (user && user.username) {\r\n        this.$set(this.ruleForm, \"dockName\", user.nickName);\r\n        this.$set(this.ruleForm, \"belongUser\", user.username);\r\n      }\r\n      this.showSelectUser = !this.showSelectUser;\r\n    },\r\n    // 取消\r\n    cancel() {\r\n      console.log(\"取消\");\r\n      let currentView = this.$store.state.tagsView.visitedViews[0];\r\n      for (currentView of this.$store.state.tagsView.visitedViews) {\r\n        if (currentView.path === this.$route.path) {\r\n          break;\r\n        }\r\n      }\r\n      this.$store.dispatch(\"tagsView/delView\", currentView).then(() => {\r\n        this.$router.push({\r\n          path: \"/dataServicePlatform/myService\",\r\n        });\r\n      });\r\n    },\r\n    // 提交申请\r\n    submitApplication() {\r\n      console.log(\"提交申请\", this.ruleForm);\r\n      this.$refs.ruleForm.validate((valid) => {\r\n        if (valid) {\r\n          this.$api.applyForService(this.ruleForm).then((res) => {\r\n            if (res.code == 0 || res.code == 200) {\r\n              this.$message.success(res.msg);\r\n              this.cancel();\r\n            } else {\r\n              this.$message.error(res.msg);\r\n            }\r\n          });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 确认更新\r\n    confirmModify() {\r\n      console.log(\"确定修改\", this.ruleForm);\r\n      this.$refs.ruleForm.validate((valid) => {\r\n        if (valid) {\r\n          this.$api.serviceUpdate(this.ruleForm).then((res) => {\r\n            if (res.code == 0 || res.code == 200) {\r\n              this.$message.success(res.msg);\r\n              this.cancel();\r\n            } else {\r\n              this.$message.error(res.msg);\r\n            }\r\n          });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n",null]}