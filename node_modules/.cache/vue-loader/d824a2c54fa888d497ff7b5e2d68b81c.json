{"remainingRequest":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\src\\views\\indicators\\indicator\\approve\\checkApprove.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\src\\views\\indicators\\indicator\\approve\\checkApprove.vue","mtime":1644369310591},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Treeselect from '@riophae/vue-treeselect'\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\nimport { updateStatus,getByIeCode } from '../../../../api/indicators/indIndicatorInfo'\nexport default {\n  name: \"checkApprove\" ,\n  props: {\n    id: null\n  },\n  components: {\n    Treeselect\n  },\n  dicts: ['IE_PROP', 'IE_TYPE', 'IE_METHOD', 'CALC_FREQ', 'IE_STATUS', 'IE_DATA_UNIT', 'RETENTION'],\n  data() {\n    return {\n      active: null,\n      approveDialog: false,\n      title: '指标审批',\n      gdtitle: '指标审批',\n      form: {},\n      depts: [] // 部门数组\n    }\n  },\n  watch: {\n    id: 'changeData' // 值可以为methods的方法名\n},\n  mounted() {\n\n  },\n  methods: {\n    //监听form中iecode的变化\n    changeData(value,oldvalue){\n\n      if (this.id) {\n        getByIeCode(this.id).then(res => {\n          if (res.code === 0) {\n            this.form = res.data\n      //当指标状态为已提交时\n      if ( this.form.status === '1') {\n        this.active = 1\n      }\n      //当指标状态为11待科技审批时\n      if ( this.form.status === '11') {\n        this.active = 2\n      }\n      //当指标状态为2科技已审批\n      if ( this.form.status === '2') {\n        this.active = 2\n      }\n      //当指标状态为4已上线时\n      if ( this.form.status === '4') {\n        this.active = 3\n      }\n          }\n        })\n      }\n      if (this.id) {\n        getByIeCode(this.id).then(res => {\n          if (res.code === 0) {\n            this.form = res.data\n          }\n        })\n      }\n    },\n    checkApprove(status) {\n      // 审批拒绝必须输入审批意见\n      if (status === 3) {\n        if (this.form.approvalOpinion == null || this.form.approvalOpinion.trim() == '') {\n          this.$message.error({\n            message: '审批拒绝必须输入审批意见'\n          })\n          return false\n        }\n      }\n      // 审批通过时判断原先状态进行状态修改\n      if (status === 2) {\n        if (this.form.status == 1) {\n          status = 11\n        }\n        if (this.form.status == 11) {\n          status = 2\n        }\n        if (this.form.status == 2) {\n          status = 4\n        }\n        if (this.form.status == 4) {\n          status = 5\n        }\n      }\n     /* this.$confirm(`确定审批所选数据吗？`, '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {*/\n        const param = []\n        const indIndicatorInfo = {\n          'id': this.form.id,\n          'ieCode': this.form.ieCode,\n          'status': status,\n          'approvalOpinion': this.form.approvalOpinion\n        }\n        param.push(indIndicatorInfo)\n        updateStatus(param).then(returnData => {\n          if (returnData.code === 0) {\n            this.$message.success({\n              message: '操作成功!'\n            })\n            this.approveDialog = false\n            this.$emit('success',true)\n            this.$parent.crud.toQuery()\n          } else {\n            this.$message.error({\n              message: '操作失败!错误原因:' + returnData.msg\n            })\n            this.approveDialog = false\n          }\n        })\n     /* })*/\n    }\n  }\n}\n\n",null]}