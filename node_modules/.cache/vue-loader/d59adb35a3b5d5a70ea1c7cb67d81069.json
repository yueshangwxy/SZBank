{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\portalHome\\workSheet.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\portalHome\\workSheet.vue","mtime":1652778689823},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n    mapGetters,\n    mapState\n} from \"vuex\";\nimport Avatar from \"@eladmin/assets/images/avatar.png\";\nimport RoleSelect from \"@eladmin/components/RoleSelect\";\nimport ThemeSelect from \"@portal/components/ThemeSelect\";\nimport Logo from \"@portal/layout/components/Sidebar/Logo\";\n\nexport default {\n    name: \"myWorkSheet\",\n    components: {\n        RoleSelect,\n        ThemeSelect,\n        Logo,\n    },\n    data() {\n        return {\n            Avatar: Avatar,\n            logo: require('../../../../public/images/logo.png'),\n            activeTab: '',\n            tabList: [\n                {\n                    name: 'asset',\n                    label: '数据资产平台',\n                },\n                {\n                    name: 'service',\n                    label: '数据服务平台',\n                },\n                {\n                    name: 'laboratory',\n                    label: '数据实验室',\n                },\n            ],\n            // radio\n            radio: 0,\n            // name: '',\n            // dept: '',\n            apiAddress: '',\n            apiName: '',\n            status: '',\n            // date: '',\n            searchInput: '',\n            dept: '',\n            status: '',\n            dateValue: '',\n            startTime: '',\n            endTime: '',\n            // 部门树\n            deptTreeList: [],\n            // 表格\n            tableData: [],\n            propList: [],\n            // 分页\n            pageSize: 10,\n            total: 10,\n            currentPage: 1,\n            // 审批弹窗\n            approveDialog: false,\n            apprComment: '',\n            selectedRow: {},\n            // 应用服务关系\n            appServiceVis: false,\n            activeName: 'first',\n            diaDataProp: [],\n            diaDataList: [],\n            curAppCode: '',\n        };\n    },\n    watch: {\n        activeTab(val) {\n            if(val==='asset') {\n                this.propList = [\n                    {\n                        prop: 'PROC_INST_ID',\n                        label: '申请编号',\n                    },\n                    {\n                        prop: 'NAME',\n                        label: '申请名称',\n                    }, \n                    {\n                        prop: 'DEPT_NAME',\n                        label: '申请部门',\n                    },\n                    {\n                        prop: 'CRT_USER',\n                        label: '申请人',\n                    },\n                    {\n                        prop: 'CRT_DATE',\n                        label: '申请时间',\n                    },\n                    {\n                        prop: 'STATUS_DESC',\n                        label: '状态',\n                        type: 'tag',\n                        tagType: (row)=> {\n                            return row.STATUS_DESC === '已通过' ? 'info' : (row.STATUS_DESC === '草稿' ? '' : (row.STATUS_DESC ==='待审批' ? 'warning': 'danger'))\n                        }\n                    },  \n                ]\n                this.radio = 0\n                this.reset()\n                this.initList()\n            }else if(val==='service') {\n                this.radio = 0\n                this.reset()\n                this.initList()\n                this.propList = [\n                    {\n                        prop: 'num',\n                        label: '申请编号',\n                    },\n                    {\n                        prop: 'address',\n                        label: 'api地址',\n                    },\n                    {\n                        prop: 'name',\n                        label: 'api名称',\n                    },\n                    {\n                        prop: 'desc',\n                        label: 'api描述',\n                    },    \n                    {\n                        prop: 'applicant',\n                        label: '申请人',\n                    },\n                    {\n                        prop: 'dept',\n                        label: '申请部门',\n                    },\n                    {\n                        prop: 'time',\n                        label: '申请时间',\n                    },\n                    {\n                        prop: 'status',\n                        label: '状态',\n                    },   \n                ]\n                this.$api.qryWorkSheetList().then(res => {\n                    console.log(res);\n                    this.tableData = res.serviceList\n                })\n            }else {\n                this.radio = 0\n                this.reset()\n                this.initList()\n                this.propList = [\n                    {\n                        prop: 'num',\n                        label: '实验室编号',\n                    },\n                    {\n                        prop: 'name',\n                        label: '实验室名称',\n                    }, \n                    {\n                        prop: 'dept',\n                        label: '申请部门',\n                    },\n                    {\n                        prop: 'applicant',\n                        label: '申请人',\n                    },\n                    {\n                        prop: 'time',\n                        label: '申请时间',\n                    },\n                    {\n                        prop: 'status',\n                        label: '状态',\n                    },  \n                ]\n                this.$api.qryWorkSheetList().then(res => {\n                    console.log(res);\n                    this.tableData = res.labList\n                })\n            }\n        },\n        radio(val) {\n            if(val==0) {\n                this.reset()\n                this.initList()\n                console.log('我的申请');\n            } else if(val==1) {\n                this.reset()\n                this.initList()\n                console.log('待我审批');\n            } else {\n                this.reset()\n                this.initList()\n                console.log('我已审批');\n            }\n        },\n        dateValue(val) {\n            if(val) {\n                this.startTime = this.$formatDate(val[0])\n                this.endTime = this.$formatDate(val[1]) \n            } else {\n                this.startTime = ''\n                this.endTime = ''\n            }\n        }\n    },\n    created() {\n        \n    },\n    mounted() {\n        this.activeTab = 'asset'\n        this.$api.getDeptTree({}).then(res => {\n            this.deptTreeList = res.data\n        })\n    },\n    computed: {\n        ...mapGetters([\"sidebar\", \"device\", \"user\", \"baseApi\"]),\n        ...mapState({\n            showBreadcrumb: (state) => state.settings.showBreadcrumb,\n        }),\n        showLogo() {\n            return this.$store.state.settings.sidebarLogo;\n        },\n        show: {\n            get() {\n                return this.$store.state.settings.showSettings;\n            },\n            set(val) {\n                this.$store.dispatch(\"settings/changeSetting\", {\n                    key: \"showSettings\",\n                    value: val,\n                });\n            },\n        },\n    },\n    created() {\n        \n    },\n    methods: {\n        // 退出登录提示\n        open() {\n            this.$confirm(\"确定注销并退出系统吗？\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            }).then(() => {\n                this.logout();\n            });\n        },\n        // 退出登录\n        logout() {\n            this.$store.dispatch(\"LogOut\").then(() => {\n                location.reload();\n            });\n        },\n        // 重置\n        reset() {\n            this.searchInput = ''\n            this.dept = ''\n            this.apiAddress = ''\n            this.apiName = ''\n            this.status = ''\n            this.dateValue = ''\n        },\n        // 列表查询  -- 从第一页开始查  搜索按钮\n        initList() {\n            this.currentPage = 1\n            this.queryList()\n        },\n        // 列表查询 -- 当前页\n        queryList() {\n            if(this.activeTab==='asset') {\n                console.log('asset查询');\n                this.queryProcessList()\n            } else if(this.activeTab==='service') {\n                console.log('service查询');\n                this.queryServiceList()\n            } else if(this.activeTab==='laboratory') {\n                console.log('laboratory查询');\n                this.queryLaboratoryList()\n            }\n        },\n        // 列表查询  数据资产平台  -- 流程\n        queryProcessList() {\n            let request = {\n                page: String(this.currentPage),\n                size: String(this.pageSize),\n                deptCode: this.dept,\n                name: this.searchInput,\n                crtDateBeg: this.startTime,\n                crtDateEnd: this.endTime,\n            }\n            console.log(request);\n            if(this.radio == 0) {\n                request.state = this.status\n                this.$api.appliedProcess(request).then(res => {\n                    console.log(res);\n                    let data = res.data\n                    this.tableData = data.records\n                    this.total = data.total\n                })\n            } else if(this.radio == 1) {  // 待我审批\n                this.$api.waitApprove(request).then(res => {\n                    console.log(res);\n                    let data = res.data\n                    this.tableData = data.records\n                    this.total = data.total\n                })\n            } else if(this.radio == 2) {  // 我已审批\n                this.$api.alreadyApprove(request).then(res => {\n                    console.log(res);\n                    let data = res.data\n                    this.tableData = data.records\n                    this.total = data.total\n                })\n            }\n            \n            \n        },\n        // 列表查询  数据服务平台\n        queryServiceList() {\n            console.log('service');\n        },\n        // 列表查询  数据实验室\n        queryLaboratoryList() {\n            console.log('laboratory');\n        },\n        // 详情\n        viewDetails(row) {\n            console.log(row);\n            if(this.activeTab === 'asset') {\n                this.$router.push({\n                    path: '/detailsView/table',\n                    query: {\n                        id: row.tableId\n                    }\n                })\n\n            }\n        },\n        // 审批按钮\n        approveBtn(row) {\n            this.approveDialog = true\n            this.apprComment = ''\n            this.selectedRow = row\n        },\n        // 审批  -- 通过\n        pass() {\n            console.log('通过',this.selectedRow.TASK_ID);\n            this.$api.completeTask({\n                taskId: this.selectedRow.TASK_ID,\n                submitType: '0',\n                assignee: '',\n                apprComment: this.apprComment,\n            }).then(res => {\n                if(res.code==0 || res.code==200) {\n                    this.approveDialog = false\n                    this.$message.success(res.msg)\n                    this.queryProcessList()\n                } else {\n                    this.$message.error(res.msg)\n                }\n            })\n        },\n        // 审批  -- 拒绝\n        reject() {\n            console.log('拒绝',this.selectedRow.TASK_ID);\n            this.$api.completeTask({\n                taskId: this.selectedRow.TASK_ID,\n                submitType: '1',\n                assignee: '',\n                apprComment: this.apprComment,\n            }).then(res => {\n                if(res.code==0 || res.code==200) {\n                    this.approveDialog = false\n                    this.$message.success(res.msg)\n                    this.queryProcessList()\n                } else {\n                    this.$message.error(res.msg)\n                }\n            })\n        },\n        // 应用服务关系\n        appService(row) {\n            console.log('应用服务关系');\n            this.diaDataProp = [\n                {\n                    prop: 'name',\n                    label: '名称',\n                    align: 'center',\n                },\n                {\n                    prop: 'description',\n                    label: '描述',\n                    align: 'center',\n                }\n            ]\n            this.appServiceVis = true\n            this.curAppCode = row.appCode\n            this.$api.qryAppService({\n                appCode: this.curAppCode\n            }).then(res => {\n                console.log(res,23333);\n                this.diaDataList = res.data\n            })\n        },\n        // 弹窗tab\n        handleClick(tab,event) {\n            console.log(tab.name);\n            if(tab.name==='first') {\n                this.$api.qryAppService({\n                    appCode: this.curAppCode\n                }).then(res => {\n                    this.diaDataList = res.data\n                })\n            }else {\n                this.$api.qryAppAccessService({\n                    appCode: this.curAppCode\n                }).then(res => {\n                    this.diaDataList = res.data\n                })\n            }\n        },\n        // 分页\n        handleCurrentChange(val) {\n            console.log(val);\n            this.currentPage = val\n            this.queryList()\n        }\n    },\n};\n",null]}