{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\dataServicePlatform\\applyForApi.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\dataServicePlatform\\applyForApi.vue","mtime":1652668096597},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            title: 'API申请',\r\n            editPage: false,\r\n            id: '',\r\n            ruleForm: {\r\n                name: '',\r\n                description: '',\r\n                overtime: '',\r\n                currentLimit: '',\r\n                type: '',\r\n                destinationAddress: '',\r\n                latestGenerationTime: '',\r\n                separator: '',\r\n                fileFormat: '',\r\n                serviceType: '1',\r\n                status: '',\r\n                dept: '',            \r\n                belongUser: '',            \r\n                fieldList: '',            \r\n                belongApplication: '',            \r\n                belongApplicationName: '',            \r\n                sitPath: '',            \r\n                prePath: '',            \r\n                serviceParamList: [\r\n                    {\r\n                        name: '',\r\n                        type: '',\r\n                        parameterType: '1', // 1入参 2出参\r\n                        description: '',\r\n                        defaultValue: '',\r\n                        isPass: '',\r\n                    },\r\n                    {\r\n                        name: '',\r\n                        type: '',\r\n                        parameterType: '2', // 1入参 2出参\r\n                        description: '',\r\n                        defaultValue: '',\r\n                        isPass: '',\r\n                    }\r\n                ],  \r\n                applicationInfoList: [],\r\n            },\r\n            labelPosition: 'top',\r\n            rules: {\r\n                name: [\r\n                    { required: true, message: '请输入名称', trigger: 'blur' },\r\n                ],\r\n                description: [\r\n                    { required: true, message: '请输入描述', trigger: 'blur' },\r\n                ],\r\n                overtime: [\r\n                    { required: true, message: '请输入超时', trigger: 'blur' },\r\n                ],\r\n                currentLimit: [\r\n                    { required: true, message: '请输入限流', trigger: 'blur' },\r\n                ],\r\n                type: [\r\n                    { required: true, message: '请选择接口类型', trigger: 'change' },\r\n                ],\r\n                dept: [\r\n                    { required: true, message: '请选择所属部门', trigger: 'change' },\r\n                ],\r\n                belongUser: [\r\n                    { required: true, message: '请输入对接人', trigger: 'blur' },\r\n                ],\r\n                status: [\r\n                    { required: true, message: '请选择接口状态', trigger: 'change' },\r\n                ],\r\n                sitPath: [\r\n                    { required: true, message: '请输入测试地址', trigger: 'blur' },\r\n                ],\r\n                prePath: [\r\n                    { required: true, message: '请输入生产地址', trigger: 'blur' },\r\n                ],\r\n                belongApplication: [\r\n                    { required: true, message: '请选择归属应用', trigger: 'change' },\r\n                ],\r\n                applicationInfoList: [\r\n                    { required: true, message: '请选择可访问应用', trigger: 'change' },\r\n                ],\r\n                applicationInfoList: [\r\n                    { required: true, message: '请选择可访问应用', trigger: 'change' },\r\n                ],\r\n                paramsName: [\r\n                    { required: true, message: '请输入参数名称', trigger: 'blur' },\r\n                ],\r\n                paramsType: [\r\n                    { required: true, message: '请选择参数类型', trigger: 'change' },\r\n                ],\r\n                paramsIsPass: [\r\n                    { required: true, message: '请选择参数是否必传', trigger: 'change' },\r\n                ],\r\n                paramsDefault: [\r\n                    { required: true, message: '请输入默认值', trigger: 'blur' },\r\n                ],\r\n                paramsDesc: [\r\n                    { required: true, message: '请输入参数说明', trigger: 'blur' },\r\n                ],\r\n            },\r\n            // 应用列表\r\n            appList: [],\r\n            // 部门树\r\n            deptTree: [],\r\n        }\r\n    },\r\n    created() { \r\n        this.editPage = this.$route.name === 'API编辑' ? true : false\r\n        if(this.editPage) {\r\n            this.title = 'API编辑'\r\n        }\r\n        this.$api.findDeptTree({}).then(res => {\r\n            console.log(res);\r\n            this.deptTree = res.data\r\n        })\r\n        this.$api.qryOpenApp({}).then(res=>{\r\n            this.appList = res.data\r\n        })\r\n    },\r\n    mounted() {\r\n        this.id = this.$route.query.id ? this.$route.query.id : ''\r\n        if(this.$route.name === 'API编辑') {\r\n            this.$api.viewServiceDetail({\r\n                id: this.id\r\n            }).then(res => {\r\n                console.log(res);\r\n                this.ruleForm = res.data\r\n            })\r\n        }\r\n    },\r\n    methods: {\r\n        // 添加入参\r\n        addReqParams() {\r\n            this.ruleForm.serviceParamList.push({\r\n                name: '',\r\n                type: '',\r\n                parameterType: '1',\r\n                description: '',\r\n                defaultValue: '',\r\n                isPass: '',\r\n            })\r\n        },\r\n        // 删除入参\r\n        delReqParams(index) {\r\n            this.ruleForm.serviceParamList.splice(index,1)\r\n        },\r\n        // 添加出参\r\n        addResParams() {\r\n            this.ruleForm.serviceParamList.push({\r\n                name: '',\r\n                type: '',\r\n                parameterType: '2',\r\n                description: '',\r\n                defaultValue: '',\r\n                isPass: '',\r\n            })\r\n        },\r\n        // 删除出参\r\n        delResParams(index) {\r\n            console.log(index);\r\n            this.ruleForm.serviceParamList.splice(index,1)\r\n        },\r\n        // 取消\r\n        cancel() {\r\n            console.log('取消');\r\n            let currentView = this.$store.state.tagsView.visitedViews[0]\r\n            for (currentView of this.$store.state.tagsView.visitedViews) {\r\n                if (currentView.path === this.$route.path) {\r\n                break\r\n                }\r\n            }\r\n            this.$store.dispatch('tagsView/delView', currentView).then(() => {\r\n                this.$router.push({\r\n                    path: '/dataServicePlatform/myService',\r\n                })\r\n            \r\n            })\r\n        },\r\n        // 提交申请\r\n        submitApplication() {\r\n            console.log('提交申请');\r\n            this.$refs.ruleForm.validate((valid) => {\r\n                if (valid) {\r\n                    console.log(this.ruleForm);\r\n                    this.$api.applyForService(this.ruleForm).then(res=>{\r\n                        console.log(res);\r\n                        if(res.code==0 || res.code==200) {\r\n                            this.$message.success(res.msg)\r\n                            this.cancel()\r\n                        } else {\r\n                            this.$message.error(res.msg)\r\n                        }\r\n                    })\r\n                } else {\r\n                    return false;\r\n                }\r\n            })\r\n        },\r\n        // 确认更新\r\n        confirmModify() {\r\n            console.log('确定修改');\r\n            this.$refs.ruleForm.validate((valid) => {\r\n                if (valid) {\r\n                    console.log(this.ruleForm);\r\n                    this.$api.serviceUpdate(this.ruleForm).then(res=>{\r\n                        if(res.code==0 || res.code==200) {\r\n                            this.$message.success(res.msg)\r\n                            this.cancel()\r\n                        } else {\r\n                            this.$message.error(res.msg)\r\n                        }\r\n                    })\r\n                } else {\r\n                    return false;\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\r\n",null]}