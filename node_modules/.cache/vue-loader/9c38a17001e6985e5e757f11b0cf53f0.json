{"remainingRequest":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\code\\indicator\\Pncui-Indicator\\src\\views\\indicators\\result\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\code\\indicator\\Pncui-Indicator\\src\\views\\indicators\\result\\index.vue","mtime":1637905698180},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport crudIndIndicatorResult, {addFavorites,removeFavorites,saveReadRec} from '../../../api/indicators/indIndicatorResult'\r\n  import CRUD, { presenter, header, form, crud } from '@crud/crud'\r\n  import rrOperation from '@crud/RR.operation'\r\n  import crudOperation from '@crud/CRUD.operation'\r\n  // import udOperation from '@crud/UD.operation'\r\n  import pagination from '@crud/Pagination'\r\n  import category from '../category/category'\r\n  import { getDepts } from '@/utils/system'\r\n  import Treeselect from '@riophae/vue-treeselect'\r\n  import '@riophae/vue-treeselect/dist/vue-treeselect.css'\r\n  //import moment from \"moment\";\r\n  // crud交由presenter持有\r\n  const defaultCrud = CRUD({\r\n    title: '指标计算结果表',\r\n    url: crudIndIndicatorResult.url,\r\n    sort: 'id,desc',\r\n    initQry: false,\r\n    crudMethod: { ...crudIndIndicatorResult.crud }\r\n  })\r\n  const defaultForm = {\r\n    id: null,\r\n    orgId: null,\r\n    ieId: null,\r\n    ieCode: null,\r\n    ieName: null,\r\n    ieValue: null,\r\n    status: null,\r\n    crtUserCode: null,\r\n    crtOrgCode: null,\r\n    crtDate: null,\r\n    updUserCode: null,\r\n    updOrgCode: null,\r\n    updDate: null,\r\n    frequency: null,\r\n    periodDateInterval:null,\r\n    ieKindOneName:null\r\n  }\r\n  export default {\r\n    name: 'IndIndicatorResult',\r\n    components: { Treeselect,pagination, crudOperation, rrOperation, category },\r\n    mixins: [presenter(defaultCrud), header(), form(defaultForm), crud()],\r\n    dicts: ['IND_FIRST_TYPE','RETENTION', 'IE_TYPE', 'IE_STATUS','IND_CURRENCY','YN','IE_FREQUENCY'],\r\n    data() {\r\n      return {\r\n        depts: [],\r\n        defaultProps: {\r\n          children: 'children',\r\n          label: 'label'\r\n        },\r\n        table: {\r\n          columns: {\r\n            id: 'hidden',\r\n            ieId: 'hidden',\r\n            updUserCode: 'hidden',\r\n            updDate: 'hidden'\r\n          }\r\n        },\r\n        permission: {\r\n          add: [''],\r\n          edit: [''],\r\n          del: ['']\r\n        },\r\n        showDialog: false,\r\n        pickerMinDate: \"\",//第一次选中的时间\r\n        pickerOptions: {\r\n          onPick: obj => {\r\n\r\n            this.pickerMinDate = new Date(obj.minDate).getTime();\r\n            console.log(\"times===>,\" + this.pickerTimes + \", pickerMinDate==>\" + this.pickerMinDate)\r\n            this.pickerMaxDate = new Date(obj.maxDate).getTime();\r\n          },\r\n          disabledDate: time => {\r\n            if (this.pickerMinDate) {\r\n              const day1 = 366 * 24 * 3600 * 1000;\r\n              let maxTime = this.pickerMinDate + day1;\r\n              let minTime = this.pickerMinDate - day1;\r\n              return time.getTime() > maxTime || time.getTime() < minTime;\r\n            }\r\n          }\r\n        },\r\n        form:{},\r\n      }\r\n    },\r\n    created() {\r\n      //defaultCrud.query.periodDateInterval = this.timeDefault\r\n      this.crud.optShow.del=false\r\n      this.crud.optShow.edit=false\r\n      this.crud.optShow.add=false\r\n    },\r\n    mounted() {\r\n      this.query.ieName = this.$route.query.ieName\r\n      if(this.query.ieName == null || this.query.ieName == 'undefined'){\r\n        defaultCrud.initQry = false\r\n      }else{\r\n        //CRUD.toQuery\r\n      }\r\n      defaultCrud.refresh()\r\n      this.getDepts();\r\n    },\r\n    computed: {\r\n      // 默认时间\r\n      /*timeDefault () {\r\n        /!*console.log(\"times===>,\" + this.pickerTimes)*!/\r\n        var defalutStartTime = moment().subtract(1,\"year\").format('YYYY-MM-DD')\r\n        var defalutEndTime = moment().format('YYYY-MM-DD')\r\n        return [defalutStartTime, defalutEndTime]\r\n      }*/\r\n    },\r\n    methods: {\r\n      // 获取数据前设置好接口地址\r\n      [CRUD.HOOK.beforeRefresh]() {\r\n        if(defaultCrud.initQry){\r\n          defaultCrud.loading = true\r\n          return true\r\n        }else{\r\n          defaultCrud.initQry = true\r\n          defaultCrud.loading = false\r\n          return false\r\n        }\r\n      },\r\n      viewHandle(row) {\r\n        this.form = row\r\n        this.showDialog = true\r\n        this.saveReadRec(row.id)\r\n      },\r\n      getDepts() {\r\n        getDepts({ enabled: true }).then(res => {\r\n          this.depts = res.content\r\n        })\r\n      },\r\n      saveReadRec(id) {\r\n        saveReadRec(id).then(res => {\r\n          console.log(\"saveReadRec res===>,\" + res)\r\n        })\r\n      },\r\n      addFavorites(data) {\r\n        console.log(\"addFavorites,\" + data)\r\n        if(data == null && !Array.isArray(data)) {\r\n          this.$notify({\r\n            title: '请选择指标结果',\r\n            type: 'warning',\r\n            duration: 2500\r\n          })\r\n          return\r\n        }\r\n        let ids = \"\";\r\n        for(let i = 0; i < data.length; i++) {\r\n          ids += data[i].id + \",\";\r\n        }\r\n        if(ids != null && ids.includes(\",\")) {\r\n          ids = ids.substr(0,ids.length - 1);\r\n        }\r\n        addFavorites(ids).then(res => {\r\n          console.log(\"addFavorites res===>,\" + res)\r\n          if(res.code === 0) {\r\n            defaultCrud.notify(res.msg, CRUD.NOTIFICATION_TYPE.SUCCESS)\r\n          } else {\r\n            defaultCrud.notify(res.msg, CRUD.NOTIFICATION_TYPE.ERROR)\r\n          }\r\n          defaultCrud.refresh()\r\n        })\r\n      },\r\n      removeFavorites(data) {\r\n        console.log(\"removeFavorites,\" + data)\r\n        if(data == null && !Array.isArray(data)) {\r\n          this.$notify({\r\n            title: '请选择指标结果',\r\n            type: 'warning',\r\n            duration: 2500\r\n          })\r\n          return\r\n        }\r\n        let ids = \"\";\r\n        for(let i = 0; i < data.length; i++) {\r\n          ids += data[i].id + \",\";\r\n        }\r\n        if(ids != null && ids.includes(\",\")) {\r\n          ids = ids.substr(0,ids.length - 1);\r\n        }\r\n        removeFavorites(ids).then(res => {\r\n          console.log(\"removeFavorites res===>,\" + res)\r\n          if(res.code === 0) {\r\n            defaultCrud.notify(res.msg, CRUD.NOTIFICATION_TYPE.SUCCESS)\r\n          } else {\r\n            defaultCrud.notify(res.msg, CRUD.NOTIFICATION_TYPE.ERROR)\r\n          }\r\n          defaultCrud.refresh()\r\n        })\r\n      },\r\n      cellStyle(data) {\r\n        if(data.row.readed === 0) {\r\n          return 'font-weight: 1000;color:#1742a5;'\r\n        } else {\r\n          return ''\r\n        }\r\n      },\r\n      refreshList() {\r\n        this.crud.refresh()\r\n      }\r\n    }\r\n  }\r\n",null]}