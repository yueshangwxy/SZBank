{"remainingRequest":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\pncui-workflow\\src\\views\\activiti\\deployment.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\pncui-workflow\\src\\views\\activiti\\deployment.vue","mtime":1650772046048},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650772030926},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650772030306},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650772030926},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650772056629}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport { getBpmnFileNames, publishFileName, deleteDeployment, deployments } from '../../api/workflow/activiti'\n\nexport default {\n  name: 'Deployment',\n  data() {\n    return {\n      rows: [],\n      loading: false,\n      selectBpmn: false,\n      form: {\n        fileName: '',\n        deployName: '',\n        category: ''\n      },\n      bpmnFileNames: [],\n      query: {},\n      page: {\n        // 页码\n        start: 0,\n        // 每页数据条数\n        size: 10,\n        // 总数据条数\n        total: 0\n      },\n      rules: {\n        fileName: [\n          { required: true, message: '文件名称不能为空', trigger: 'change' }\n        ],\n        deployName: [\n          { required: true, message: '部署名称不能为空', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  components: {},\n  mounted() {\n    this.refresh()\n    getBpmnFileNames().then(res => {\n      this.bpmnFileNames = res.data\n    })\n  },\n  methods: {\n    refresh() {\n      deployments(Object.assign({\n          order: 'desc',\n          sort: 'deployTime',\n          size: this.page.size,\n          start: this.page.start\n        }, this.query.name ? { name: this.query.name } : {})\n      ).then(res => {\n        //console.log(res)\n        this.rows = res.data.data\n        this.page.total = res.data.total\n      })\n    },\n    publish() {\n      this.$refs['form'].validate(valid => {\n        if (!valid) {\n          return\n        }\n        publishFileName(this.form.fileName, this.form.deployName, this.form.category).then(res => {\n          this.$message.success('流程发布成功')\n          this.selectBpmn = false\n          this.refresh()\n        }).catch(error => {\n          this.$message.error(error)\n        })\n      })\n    },\n    deleteDeploy(row) {\n      console.log('================', row)\n      this.$confirm('确定要删除流程[' + row.name + ']吗？').then(() => {\n        deleteDeployment(row.id).then(res => {\n          this.$message.success('删除成功')\n          this.refresh()\n        })\n      })\n    },\n    // 当前页改变\n    pageChangeHandler(e) {\n      this.page.start = e\n      this.refresh()\n    },\n    // 每页条数改变\n    sizeChangeHandler(e) {\n      this.page.size = e\n      this.page.start = 1\n      this.refresh()\n    }\n  }\n}\n",null]}