{"remainingRequest":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform\\Pncui-Ind\\src\\views\\indicators\\auth\\index.vue?vue&type=style&index=0&id=019477ac&scoped=true&lang=css&","dependencies":[{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\src\\views\\indicators\\auth\\index.vue","mtime":1647917138741},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\css-loader\\index.js","mtime":1647917126570},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1647917137430},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\postcss-loader\\src\\index.js","mtime":1647917133740},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647917124586},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1647917137429}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.content {\r\n  padding: 20px;\r\n}\r\n\r\n.line {\r\n  border: 1px solid #dfe6ec;\r\n  overflow: auto;\r\n  height: 430px;\r\n  width: 100%;\r\n  margin-top: 10px;\r\n}\r\n\r\n.custom-tree-node {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: revert;\r\n  justify-content: space-between;\r\n  font-size: 14px;\r\n  padding-right: 30px;\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgmBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/indicators/auth","sourcesContent":["<template>\r\n  <el-row :gutter=\"20\" style=\"height:100%\">\r\n    <div class=\"content\" style=\"height:650px !important\">\r\n      <el-col :span=\"10\">\r\n        <el-tabs v-model=\"authActiveName\" @tab-click=\"authHandleClick\">\r\n\r\n          <el-tab-pane label=\"角色\" name=\"role\">\r\n            <el-row>\r\n              <el-col>\r\n                <el-input\r\n                    v-model=\"roleTab.query.blurry\"\r\n                    clearable\r\n                    placeholder=\"输入名称或描述搜索\"\r\n                    style=\"width: 200px;\"\r\n                    class=\"filter-item\"\r\n                    @keyup.enter.native=\"toQueryRole\"\r\n                />\r\n                <el-button class=\"filter-item\" type=\"success\" icon=\"el-icon-search\" @click=\"toQueryRole\">搜索\r\n                </el-button>\r\n              </el-col>\r\n            </el-row>\r\n            <el-row>\r\n              <el-col>\r\n                <el-table\r\n                    v-loading=\"roleTab.loading\"\r\n                    :data=\"roleTab.data\"\r\n                    row-key=\"id\"\r\n                    border\r\n                    height=\"450\"\r\n                    highlight-current-row\r\n                    style=\"width: 100%;margin-top: 10px;\"\r\n                    @current-change=\"onSelectRole\"\r\n                >\r\n                  <el-table-column :show-overflow-tooltip=\"true\" prop=\"name\" label=\"角色名称\" width=\"150px\"/>\r\n                  <el-table-column prop=\"level\" label=\"角色级别\" width=\"100px\">\r\n                    <template slot-scope=\"scope\">\r\n                      {{ scope.row.level }}级\r\n                    </template>\r\n                  </el-table-column>\r\n                  <el-table-column :show-overflow-tooltip=\"true\" prop=\"remark\" label=\"描述\"/>\r\n                </el-table>\r\n                <el-pagination\r\n                    background\r\n                    :total=\"roleTab.total\"\r\n                    :current-page=\"roleTab.page + 1\"\r\n                    style=\"margin-top: 8px;\"\r\n                    layout=\"total, prev, pager, next, sizes\"\r\n                    @size-change=\"roleSizeChange\"\r\n                    @current-change=\"rolePageChange\"\r\n                />\r\n              </el-col>\r\n            </el-row>\r\n\r\n          </el-tab-pane>\r\n          <el-tab-pane v-if=\"false\" label=\"用户权限管理\" name=\"user\">\r\n            <el-input\r\n                v-model=\"userTab.query.blurry\"\r\n                clearable\r\n                placeholder=\"输入名称或邮箱搜索\"\r\n                style=\"width: 200px;\"\r\n                class=\"filter-item\"\r\n                @keyup.enter.native=\"toQueryUser\"\r\n            />\r\n            <el-button class=\"filter-item\" type=\"success\" icon=\"el-icon-search\" @click=\"toQueryUser\">搜索\r\n            </el-button>\r\n            <el-table\r\n                v-loading=\"userTab.loading\"\r\n                :data=\"userTab.data\"\r\n                row-key=\"id\"\r\n                border\r\n                height=\"398\"\r\n                highlight-current-row\r\n                style=\"width: 100%;margin-top: 10px;\"\r\n                @current-change=\"onSelectUser\"\r\n            >\r\n\r\n              <el-table-column :show-overflow-tooltip=\"true\" prop=\"username\" label=\"用户名\" width=\"100px\"/>\r\n              <el-table-column :show-overflow-tooltip=\"true\" prop=\"nickName\" label=\"姓名\" width=\"120px\"/>\r\n              <el-table-column :show-overflow-tooltip=\"true\" prop=\"email\" label=\"邮箱\" width=\"150px\"/>\r\n              <el-table-column :show-overflow-tooltip=\"true\" label=\"部门\">\r\n                <template slot-scope=\"scope\">\r\n                  <div>{{ scope.row.dept.name }}</div>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <el-pagination\r\n                background\r\n                :total=\"userTab.total\"\r\n                :current-page=\"userTab.page + 1\"\r\n                style=\"margin-top: 8px;\"\r\n                layout=\"total, prev, pager, next, sizes\"\r\n                @size-change=\"userSizeChange\"\r\n                @current-change=\"userPageChange\"\r\n            />\r\n          </el-tab-pane>\r\n          <el-tab-pane v-if=\"false\" label=\"机构权限管理\" name=\"dept\">\r\n            <el-input\r\n                v-model=\"deptTab.query.name\"\r\n                clearable\r\n                placeholder=\"输入机构名称搜索\"\r\n                style=\"width: 200px;\"\r\n                class=\"filter-item\"\r\n                @keyup.enter.native=\"toQueryDept\"\r\n            />\r\n            <el-input\r\n                v-model=\"deptTab.query.id\"\r\n                clearable\r\n                placeholder=\"输入机构编号搜索\"\r\n                style=\"width: 200px;\"\r\n                class=\"filter-item\"\r\n                @keyup.enter.native=\"toQueryDept\"\r\n            />\r\n            <el-button class=\"filter-item\" type=\"success\" icon=\"el-icon-search\" @click=\"toQueryDept\">搜索\r\n            </el-button>\r\n\r\n            <el-table\r\n                v-loading=\"deptTab.loading\"\r\n                :data=\"deptTab.data\"\r\n                :expand-row-keys=\"['1']\"\r\n                row-key=\"id\"\r\n                :tree-props=\"{children: 'children', hasChildren: 'hasChildren'}\"\r\n                border\r\n                height=\"430\"\r\n                highlight-current-row\r\n                style=\"width: 100%;margin-top: 10px;\"\r\n                @current-change=\"onSelectDept\"\r\n            >\r\n              <el-table-column prop=\"name\" label=\"机构名称\"/>\r\n              <el-table-column prop=\"id\" label=\"机构编号\" width=\"200px\"/>\r\n            </el-table>\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n      </el-col>\r\n      <el-col :span=\"14\">\r\n        <el-tabs v-model=\"menuActiveName\">\r\n          <el-tab-pane label=\"功能权限\" name=\"admin\">\r\n            <el-row>\r\n              <el-col>\r\n                <el-button\r\n                    class=\"filter-item\"\r\n                    :loading=\"adminTab.menuLoading\"\r\n                    type=\"primary\"\r\n                    icon=\"el-icon-check\"\r\n                    @click=\"doSaveAdminMenus\"\r\n                >保存\r\n                </el-button>\r\n              </el-col>\r\n            </el-row>\r\n            <el-row style=\"margin-top: 10px\">\r\n              <el-col>\r\n                <!--                <div class=\"line\">-->\r\n                <!--                  <el-scrollbar class=\"el-tree treeScroll\">-->\r\n                <div style=\"height: 450px;overflow: scroll;background-color: white;\">\r\n                  <el-tree\r\n                      ref=\"adminMenuTree\"\r\n                      v-loading=\"adminTab.loading\"\r\n                      :data=\"adminTab.data\"\r\n                      :check-strictly=\"adminTab.strictly\"\r\n                      :default-checked-keys=\"adminTab.operators\"\r\n                      :props=\"menuTreeDefaultProps\"\r\n                      accordion\r\n                      show-checkbox\r\n                      style=\"width: 100%;height: max-content;border: none\"\r\n                      node-key=\"id\"\r\n                  >\r\n                      <span slot-scope=\"{ node, data }\" class=\"custom-tree-node\">\r\n                        <span>{{ node.label }}</span>\r\n                        <!--<span v-show=\"data.type==1\" style=\"align:right\">\r\n                          <el-radio-group v-model=\"data.dataAuthType\">\r\n                            <el-radio v-for=\"item in dict['DATA_AUTH_TYPE']\" v-if=\"isNaN(item.value) || currentRoleLevel>item.value\" :label=\"item.value\" style=\"width:60px;overflow: auto;\">{{ item.label }}</el-radio>\r\n                          </el-radio-group>\r\n                        </span>-->\r\n                      </span>\r\n                  </el-tree>\r\n\r\n                </div>\r\n                <!--                  </el-scrollbar>-->\r\n                <!--                </div>-->\r\n\r\n              </el-col>\r\n            </el-row>\r\n          </el-tab-pane>\r\n          <el-tab-pane label=\"指标数据权限\" name=\"index\">\r\n            <el-row>\r\n              <el-col>\r\n                <el-button\r\n                    class=\"filter-item\"\r\n                    :loading=\"indexTab.menuLoading\"\r\n                    type=\"primary\"\r\n                    icon=\"el-icon-check\"\r\n                    @click=\"doSaveAdminIndexs\"\r\n                >保存\r\n                </el-button>\r\n              </el-col>\r\n            </el-row>\r\n            <el-row style=\"margin-top: 10px\">\r\n              <el-col>\r\n<!--                <div class=\"line\">-->\r\n                  <el-row>\r\n                    <el-col :span=\"12\">\r\n                      <!--                      <el-scrollbar class=\"el-tree treeScroll\">-->\r\n                      <div style=\"overflow: scroll;background-color: white;height: 450px\">\r\n                        <el-tree\r\n                            ref=\"adminIndexTree\"\r\n                            v-loading=\"adminTab.loading\"\r\n                            :data=\"indexTab.data\"\r\n                            :check-strictly=\"true\"\r\n                            :default-checked-keys=\"indexTab.operators\"\r\n                            :default-expand-all=\"true\"\r\n                            :props=\"menuTreeDefaultProps\"\r\n                            @check=\"choiceIndChildrenNode\"\r\n                            show-checkbox\r\n                            style=\"width: max-content;height: max-content;border: none\"\r\n                            node-key=\"id\"\r\n                        >\r\n                <span slot-scope=\"{ node, data }\" class=\"custom-tree-node\">\r\n                  <span>{{ node.label }}</span>\r\n                  <!-- <span v-show=\"data.type==1\" style=\"align:right\">\r\n                     <el-radio-group v-model=\"data.dataAuthType\">\r\n                       <el-radio v-for=\"item in dict['DATA_AUTH_TYPE']\" v-if=\"isNaN(item.value) || currentRoleLevel>item.value\" :label=\"item.value\" style=\"width:60px;overflow: auto;\">{{ item.label }}</el-radio>\r\n                     </el-radio-group>\r\n                   </span>-->\r\n                </span>\r\n                        </el-tree>\r\n                      </div>\r\n                      <!--                      </el-scrollbar>-->\r\n                    </el-col>\r\n\r\n                    <el-col :span=\"12\">\r\n<!--                      <el-scrollbar class=\"el-tree treeScroll\">-->\r\n                      <div style=\"overflow: scroll;height: 450px;background-color: white;\">\r\n                        <el-tree\r\n                            ref=\"adminIndexOrgTree\"\r\n                            v-loading=\"indexOrgTab.loading\"\r\n                            :data=\"indexOrgTab.data\"\r\n                            :check-strictly=\"true\"\r\n                            :default-checked-keys=\"indexOrgTab.operators\"\r\n                            :default-expand-all=\"true\"\r\n                            :props=\"menuTreeDefaultProps\"\r\n                            @check=\"choiceChildrenNode\"\r\n                            show-checkbox\r\n                            style=\"width: max-content;height: max-content;border: none\"\r\n                            node-key=\"id\"\r\n                        >\r\n                    <span slot-scope=\"{ node, data }\" class=\"custom-tree-node\">\r\n                      <span>{{ node.label }}</span>\r\n                    </span>\r\n                        </el-tree>\r\n<!--                      </el-scrollbar>-->\r\n                      </div>\r\n                    </el-col>\r\n                  </el-row>\r\n<!--                </div>-->\r\n              </el-col>\r\n            </el-row>\r\n\r\n\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n      </el-col>\r\n    </div>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\n  import request from '@/utils/request'\r\n  import qs from 'qs'\r\n\r\n  export default {\r\n    name: 'Auth',\r\n    dicts: ['DATA_AUTH_TYPE'],\r\n    data() {\r\n      return {\r\n        authActiveName: 'role',\r\n        menuActiveName: 'admin',\r\n\r\n        currentType: 'role',\r\n        currentId: '',\r\n        currentRoleLevel: null,\r\n        menuTreeDefaultProps: {\r\n          children: 'children',\r\n          label: 'name'\r\n        },\r\n        deptTab: {\r\n          query: {\r\n            name: '',\r\n            id: ''\r\n          },\r\n          data: [],\r\n          loading: false\r\n        },\r\n        roleTab: {\r\n          query: {\r\n            blurry: ''\r\n          },\r\n          data: [],\r\n          loading: true,\r\n          total: 0, page: 0, size: 10\r\n        },\r\n        userTab: {\r\n          query: {\r\n            blurry: ''\r\n          },\r\n          data: [],\r\n          loading: true,\r\n          total: 0, page: 0, size: 10\r\n        },\r\n        adminTab: {\r\n          menuLoading: false,\r\n          data: [],\r\n          loading: false,\r\n          operators: [],\r\n          strictly: true\r\n        },\r\n        indexTab: {\r\n          menuLoading: false,\r\n          data: [],\r\n          loading: false,\r\n          operators: [],\r\n          strictly: true\r\n        },\r\n        indexOrgTab: {\r\n          menuLoading: false,\r\n          data: [],\r\n          loading: false,\r\n          operators: [],\r\n          strictly: true\r\n        }\r\n      }\r\n    },\r\n    mounted() {\r\n      this.toQueryRole()\r\n      // this.getAdminmenus()\r\n    },\r\n    methods: {\r\n      authHandleClick(tab, event) {\r\n        if (tab.name === 'dept') {\r\n          this.currentType = 'dept'\r\n          this.$refs.adminMenuTree.setCheckedKeys([])\r\n          this.toQueryDept()\r\n        } else if (tab.name === 'role') {\r\n          this.currentType = 'role'\r\n          this.$refs.adminMenuTree.setCheckedKeys([])\r\n          this.toQueryRole()\r\n        } else if (tab.name === 'user') {\r\n          this.currentType = 'user'\r\n          this.$refs.adminMenuTree.setCheckedKeys([])\r\n          this.toQueryUser()\r\n        }\r\n      },\r\n\r\n      menuHandleClick(tab, event) {\r\n        // this.getAdminmenus()\r\n      },\r\n\r\n      // 机构权限配置\r\n      toQueryDept() {\r\n        var _this = this\r\n        _this.deptTab.loading = true\r\n        // _this.deptTab.data = [];\r\n        request({\r\n          url: '/api/dept' + '?' + qs.stringify(_this.deptTab.query, { indices: false }),\r\n          method: 'get'\r\n        }).then(res => {\r\n          _this.deptTab.data = res.content\r\n          _this.deptTab.loading = false\r\n          //  console.log(_this.deptTab.data)\r\n        })\r\n      },\r\n      onSelectDept(currentRow, oldCurrentRow) {\r\n        // console.log(currentRow,oldCurrentRow)\r\n        if (currentRow) {\r\n          this.adminTab.strictly = true\r\n          this.currentId = currentRow.id\r\n          this.$refs.adminMenuTree.setCheckedKeys([])\r\n          request({\r\n            url: '/auths/menus' + '?' + qs.stringify({ type: 'dept', id: currentRow.id }, { indices: false }),\r\n            method: 'get'\r\n          }).then(res => {\r\n            this.adminTab.data = res\r\n            this.adminTab.loading = false\r\n            this.adminTab.strictly = false\r\n          })\r\n        }\r\n      },\r\n\r\n    // 角色权限配置\r\n    toQueryRole() {\r\n      var _this = this\r\n      _this.roleTab.loading = true\r\n      const sort = 'level,asc'\r\n      this.params = {page: this.roleTab.page, size: this.roleTab.size, sort: sort}\r\n      this.params['blurry'] = _this.roleTab.query.blurry\r\n      request({\r\n        url: '/api/roles' + '?' + qs.stringify(_this.params, {indices: false}),\r\n        method: 'get'\r\n      }).then(res => {\r\n        // console.log(res.content)\r\n        _this.roleTab.data = res.content\r\n        _this.roleTab.total = res.totalElements\r\n        _this.roleTab.loading = false\r\n      })\r\n    },\r\n    onSelectRole(currentRow, oldCurrentRow) {\r\n      if (currentRow) {\r\n        this.currentId = currentRow.id\r\n        this.adminTab.strictly = true\r\n        this.indexOrgTab.strictly = true\r\n        // this.adminTab.loading = true\r\n        this.currentRoleLevel = currentRow.level\r\n        this.$refs.adminMenuTree.setCheckedKeys([])\r\n        request({\r\n          url: '/auths/menus/role/' + currentRow.id,\r\n          method: 'get'\r\n        }).then(res => {\r\n          console.log('======get role auths::', res)\r\n          this.adminTab.data = res.auths\r\n          this.adminTab.operators = res.operators\r\n          this.adminTab.strictly = false\r\n          // this.adminTab.loading = false\r\n        })\r\n        request({\r\n          url: '/auths/roleIndexs/' + currentRow.id,\r\n          method: 'get'\r\n        }).then(res => {\r\n          console.log('======get role auths::', res)\r\n          this.indexTab.data = res.ind.auths\r\n          this.indexTab.operators = res.ind.authorizes\r\n          this.indexTab.strictly = false\r\n\r\n          this.indexOrgTab.data = res.org.auths\r\n          this.indexOrgTab.operators = res.org.authorizes\r\n          this.indexOrgTab.strictly = false\r\n\r\n          // this.adminTab.loading = false\r\n        })\r\n      }\r\n    },\r\n    rolePageChange(e) {\r\n      this.roleTab.page = e - 1\r\n      this.toQueryRole()\r\n    },\r\n    roleSizeChange(e) {\r\n      this.roleTab.page = 0\r\n      this.roleTab.size = e\r\n      this.toQueryRole()\r\n    },\r\n\r\n    // 用户权限配置\r\n    toQueryUser() {\r\n      var _this = this\r\n      _this.userTab.loading = true\r\n      const sort = 'id,desc'\r\n      this.params = {page: this.userTab.page, size: this.userTab.size, sort: sort}\r\n      this.params['blurry'] = _this.userTab.query.blurry\r\n      request({\r\n        url: '/api/users' + '?' + qs.stringify(_this.params, {indices: false}),\r\n        method: 'get'\r\n      }).then(res => {\r\n        // console.log(res.content)\r\n        _this.userTab.data = res.content\r\n        _this.userTab.total = res.totalElements\r\n        _this.userTab.loading = false\r\n      })\r\n    },\r\n    onSelectUser(currentRow, oldCurrentRow) {\r\n      // console.log(currentRow,oldCurrentRow)\r\n      if (currentRow) {\r\n        this.adminTab.strictly = true\r\n        this.currentId = currentRow.id\r\n        this.$refs.adminMenuTree.setCheckedKeys([])\r\n        request({\r\n          url: '/auth/menus' + '?' + qs.stringify({type: 'user', id: currentRow.id}, {indices: false}),\r\n          method: 'get'\r\n        }).then(res => {\r\n          this.adminTab.data = res.auths\r\n          this.adminTab.this.adminTab.strictly = false\r\n        })\r\n      }\r\n    },\r\n    userPageChange(e) {\r\n      this.userTab.page = e - 1\r\n      this.toQueryUser()\r\n    },\r\n    userSizeChange(e) {\r\n      this.userTab.page = 0\r\n      this.userTab.size = e\r\n      this.toQueryUser()\r\n    },\r\n\r\n    // 加载admin菜单\r\n    /* getAdminmenus() {\r\n      var _this = this\r\n      request({\r\n        url: '/api/menus/tree',\r\n        method: 'get'\r\n      }).then(res => {\r\n        _this.adminTab.data = res\r\n        _this.adminTab.loading = false\r\n      })\r\n    },*/\r\n    doSaveAdminMenus() {\r\n      this.adminTab.menuLoading = true\r\n      // var _this = this\r\n      const menus = []\r\n      /* this.$refs.adminMenuTree.getHalfCheckedNodes().forEach(function(data, index) {\r\n        menus.push({id:data.id,auth:data.dataAuthType})\r\n      })*/\r\n      // 得到已选中的 key 值\r\n      console.log('=====getCheckedKeys========', menus, this.$refs.adminMenuTree.getCheckedNodes(false, true))\r\n      this.$refs.adminMenuTree.getCheckedNodes(false, true).forEach(function (data, index) {\r\n        menus.push({resourceId: data.id, authorizeType: '03', dataAuthType: data.dataAuthType})\r\n      })\r\n      request({\r\n        url: '/auths/menus/' + this.currentType + '/' + this.currentId,\r\n        method: 'post',\r\n        data: menus\r\n      }).then(res => {\r\n        this.adminTab.menuLoading = false\r\n        this.$notify({\r\n          title: '保存成功',\r\n          type: 'success',\r\n          duration: 2500\r\n        })\r\n      })\r\n    },\r\n    doSaveAdminIndexs() {\r\n      this.indexTab.menuLoading = true\r\n      // var _this = this\r\n      const indexs = []\r\n      // 得到已选中的 key 值\r\n      console.log('=====getCheckedKeys========', indexs, this.$refs.adminIndexTree.getCheckedNodes(false, true))\r\n      this.$refs.adminIndexTree.getCheckedNodes(false, true).forEach(function (data, index) {\r\n        indexs.push({objCode: data.id, objType: '1'})\r\n      })\r\n\r\n      this.$refs.adminIndexOrgTree.getCheckedNodes(false, true).forEach(function (data, index) {\r\n        indexs.push({objCode: data.id, objType: '2'})\r\n      })\r\n\r\n        request({\r\n          url: '/auths/roleIndexs/' + this.currentId,\r\n          method: 'post',\r\n          data: indexs\r\n        }).then(res => {\r\n          this.indexTab.menuLoading = false\r\n          this.$notify({\r\n            title: '保存成功',\r\n            type: 'success',\r\n            duration: 2500\r\n          })\r\n        })\r\n      },\r\n      choiceChildrenNode(data, selected){\r\n        var isChecked = selected.checkedKeys.includes(data.id);\r\n        if (isChecked) {\r\n          if (data.children) {\r\n              var allChildrens = this.getAllChildren(data);\r\n              allChildrens.forEach(item => {\r\n                this.$refs.adminIndexOrgTree.setChecked(item.id,true);\r\n              })\r\n          }\r\n        } else {\r\n          if (data.children) {\r\n            var allChildrens = this.getAllChildren(data);\r\n            allChildrens.forEach(item => {\r\n              this.$refs.adminIndexOrgTree.setChecked(item.id,false);\r\n            })\r\n          }\r\n        }\r\n      },\r\n\r\n      choiceIndChildrenNode(data, selected){\r\n        var isChecked = selected.checkedKeys.includes(data.id);\r\n        if (isChecked) {\r\n          if (data.children) {\r\n            var allChildrens = this.getAllChildren(data);\r\n            allChildrens.forEach(item => {\r\n              this.$refs.adminIndexTree.setChecked(item.id,true);\r\n            })\r\n          }\r\n        } else {\r\n          if (data.children) {\r\n            var allChildrens = this.getAllChildren(data);\r\n            allChildrens.forEach(item => {\r\n              this.$refs.adminIndexTree.setChecked(item.id,false);\r\n            })\r\n          }\r\n        }\r\n      },\r\n      getAllChildren(node){\r\n        var res = [];\r\n        var nodes = node.children;\r\n        if (nodes != null) {\r\n          for (var i = 0; i < nodes.length; i++) {\r\n              var childNode = nodes[i];\r\n              res.push(childNode);\r\n              var temp = this.getAllChildren(childNode);\r\n              res = res.concat(temp);\r\n          }\r\n        }\r\n        return res;\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.content {\r\n  padding: 20px;\r\n}\r\n\r\n.line {\r\n  border: 1px solid #dfe6ec;\r\n  overflow: auto;\r\n  height: 430px;\r\n  width: 100%;\r\n  margin-top: 10px;\r\n}\r\n\r\n.custom-tree-node {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: revert;\r\n  justify-content: space-between;\r\n  font-size: 14px;\r\n  padding-right: 30px;\r\n}\r\n</style>\r\n"]}]}