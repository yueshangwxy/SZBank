{"remainingRequest":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\src\\views\\indicators\\indicator\\notice.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\src\\views\\indicators\\indicator\\notice.vue","mtime":1644369310607},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Evicce\\Desktop\\工作\\code2\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport crudSysNotice,{topNotice} from '../../../api/indicators/notice'\nimport CRUD, { presenter, header, form, crud } from '@crud/crud'\nimport rrOperation from '@crud/RR.operation'\nimport crudOperation from '@crud/CRUD.operation'\nimport udOperation from '@crud/UD.operation'\nimport pagination from '@crud/Pagination'\nimport {quillEditor} from \"vue-quill-editor\";\nimport quillConfig from \"../../../api/indicators/quill-config\";\nimport $ from 'jquery';\n// crud交由presenter持有\nconst defaultCrud = CRUD({ title: '公告管理', url: crudSysNotice.url, sort: 'sortNo', crudMethod: { ...crudSysNotice.crud }})\nconst defaultForm = { id: null, title: null, content:null, effectDateFrom: null,  effectDateTo: null, sortNo: 1, crtUserCode:null, crtDate:null }\n\n\nexport default {\n  name: 'SysNotice',\n  components: { pagination, crudOperation, rrOperation, udOperation,quillEditor },\n  mixins: [presenter(defaultCrud), header(), form(defaultForm), crud()],\n\n  data() {\n    const checkDateFrom = (rule, value, cb) => {\n      if(this.form.effectDateFrom == null || this.form.effectDateTo == null){\n        return cb();\n      }\n      this.$refs['form'].clearValidate(['effectDateTo']);\n      if(this.form.effectDateFrom > this.form.effectDateTo){\n        return cb(\"开始日期要小于结束日期\");\n      }\n      return cb();\n    };\n    const checkDateTo = (rule, value, cb) => {\n      if(this.form.effectDateFrom == null || this.form.effectDateTo == null){\n        return cb();\n      }\n      this.$refs['form'].clearValidate(['effectDateFrom']);\n      if(this.form.effectDateFrom > this.form.effectDateTo){\n        return cb(\"结束日期要大于开始日期\");\n      }\n      return cb();\n    };\n    return {\n      contentQuillOption: {\n        placeholder: \"请输入公告内容\",\n        theme: 'snow',\n        modules: quillConfig.contentModules\n      },\n      titleQuillOption: {\n        placeholder: \"请输入公告标题\",\n        theme: 'snow',\n        modules: quillConfig.titleModules\n      },\n      permission: {\n        add: ['admin', 'sysNotice:add'],\n        edit: ['admin', 'sysNotice:edit'],\n        del: ['admin', 'sysNotice:del']\n      },\n\n      rules: {\n        title: [\n          { required: true, message: '标题不能为空', trigger: 'blur' }\n        ],\n        content: [\n          { required: true, message: '内容不能为空', trigger: 'blur' }\n        ],\n        effectDateFrom: [\n          { required: true, message: '开始日期不能为空', trigger: 'blur' },\n          { validator: checkDateFrom, trigger: 'blur'}\n        ],\n        effectDateTo: [\n          { required: true, message: '结束日期不能为空', trigger: 'blur' },\n          { validator: checkDateTo, trigger: 'blur'}\n        ]\n      }\n    }\n  },\n  created(){\n    this.crud.resetQuery(false);\n\n  },\n  mounted(){\n    this.query.type= 1;\n    this.crud.refresh();\n  },\n  methods: {\n    // 获取数据前设置好接口地址\n    [CRUD.HOOK.beforeRefresh]() {\n      return true\n    },\n    topNotice(id,sortNo) {\n      if(sortNo == 1) {\n        this.$confirm('确认是否取消置顶?', '取消置顶', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          topNotice(id,sortNo).then(res => {\n            if(res.code ==0) {\n              this.$notify({\n                title: '取消置顶成功',\n                type: 'success',\n                duration: 2500\n              })\n            }\n          })\n        }).catch(() => {})\n      }else {\n        this.$confirm('确认是否置顶?', '置顶', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          topNotice(id,sortNo).then(res => {\n            if(res.code ==0) {\n              this.$notify({\n                title: '置顶成功',\n                type: 'success',\n                duration: 2500\n              })\n            }\n          })\n        }).catch(() => {})\n      }\n    }\n  }\n}\n",null]}