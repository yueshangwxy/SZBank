{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\dataLab\\sqlAnalysis\\sqlAnalysis.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\dataLab\\sqlAnalysis\\sqlAnalysis.vue","mtime":1652774979570},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {getTablesWithPermissions,getListBySQL,downLoad} from \"@/api/dataLab/sqlAnalysis\";\nexport default {\n  name: 'SqlAnalysis',\n  data() {\n    return {\n      // 树形控件\n      filterText: '',\n      defaultProps: {\n        id:'id',\n        children: 'children',\n        label: 'tableName'\n      },\n      treeData: [],\n      // 文本域\n      textarea: '',\n      description: '',\n      // 表格\n      tableList: [],\n      propList: [],\n      // 分页\n      pageSize: 10,\n      currentPage: 1,\n      total: 0,\n      downLoadDialog:false,\n      descriptionDialog:false\n    }\n  },\n  watch: {\n    filterText(val) {\n      this.$refs.tree.filter(val);\n    },\n  },\n  created() {\n    getTablesWithPermissions().then(data =>{\n      this.treeData = data\n    })\n\n    this.propList = [\n      {\n        prop: 'column1',\n        label: 'column1',\n        align: 'center'  // 当前列对齐方式  居中  默认为居左\n      },\n      {\n        prop: 'column2',\n        label: 'column2',\n      },\n      {\n        prop: 'column3',\n        label: 'column3',\n      },\n      {\n        prop: 'column4',\n        label: 'column4',\n      },\n      {\n        prop: 'column5',\n        label: 'column5',\n      },\n      {\n        prop: 'column6',\n        label: 'column6',\n      }]\n    this.tableList = []\n\n  },\n  mounted() {},\n  methods: {\n    // 节点过滤\n    filterNode(value, data) {\n      if (!value) return true;\n      return data.name.indexOf(value.toString()) !== -1;\n    },\n    // 节点点击\n    handleNodeClick(data) {\n      console.log(data);\n    },\n    executeSql(){\n      if(this.textarea == null || this.textarea ==\"\"){\n        this.$message({\n          type: 'warning',\n          message: '请填写SQL!',\n        })\n      }else {\n        const param = {\n          \"sql\": this.textarea\n        }\n        this.getListBySQL(param);\n      }\n    },\n    dataDownLoad(){\n        this.downLoadDialog = true;\n    },\n    downLoad(flag) {\n      if (this.textarea == null || this.textarea == \"\") {\n        this.$message({\n          type: 'warning',\n          message: '请填写SQL!',\n        })\n      } else {\n        const param = {\n          \"flag\": flag,\n          \"sql\": this.textarea\n        }\n        if (flag == \"1\") {\n          this.descriptionDialog = true\n        } else {\n          downLoad(param).then(data => {\n            if (data.code == '200') {\n              this.$message({\n                type: 'success',\n                message: data.msg,\n              })\n              this.downLoadDialog = false;\n            } else {\n              this.$message({\n                type: 'error',\n                message: data.msg,\n              })\n            }\n          })\n        }\n      }\n    },\n    downLoadSourceData(){\n      const param = {\n        \"flag\":\"1\",\n        \"sql\":this.textarea,\n        \"description\":this.description\n      }\n      downLoad(param).then(data => {\n        console.log(JSON.stringify(data))\n        if(data.code =='200') {\n          this.$message({\n            type: 'success',\n            message: data.msg,\n          })\n          this.downLoadDialog = false\n          this.descriptionDialog = false\n        }else {\n          this.$message({\n            type: 'error',\n            message: data.msg,\n          })\n        }\n      })\n    },\n    closeDescriptionDialog(){\n      this.descriptionDialog = false\n      this.description =\"\"\n    },\n    getListBySQL(param){\n      getListBySQL(param).then(data =>{\n        if(data.code == \"200\"){\n          this.propList = data.head\n          this.tableList = data.data\n          this.total = this.tableList.length\n\n        }else {\n          this.$message({\n            type: 'error',\n            message: data.msg,\n          })\n        }\n      })\n    },\n\n    // 分页\n    handleSizeChange(val) {\n      this.pageSize = val;\n      this.currentPage = 1;\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n    }\n  },\n}\n",null]}