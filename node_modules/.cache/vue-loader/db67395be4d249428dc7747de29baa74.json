{"remainingRequest":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\eladmin-common\\src\\views\\system\\user\\center\\updatePass.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\eladmin-common\\src\\views\\system\\user\\center\\updatePass.vue","mtime":499162500000},{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace-suzhouzhibiao\\Indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport store from '../../../../store'\nimport { updatePass } from '../../../../api/system/user'\nimport Cookies from 'js-cookie'\nexport default {\n  data() {\n    /* const patter = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[^]{8,16}$/\n    const passwordValidator = (rule, value, callback) => {\n      if (!patter.test(value)) {\n        return callback(new Error('密码强度太弱,请输入8-16个字符,至少1个大写字母1个小写字母和1个数字'))\n      } else {\n        callback()\n      }\n    }*/\n    const confirmPass = (rule, value, callback) => {\n      if (value) {\n        if (this.form.newPass !== value) {\n          callback(new Error('两次输入的密码不一致'))\n        } else {\n          callback()\n        }\n      } else {\n        callback(new Error('请再次输入密码'))\n      }\n    }\n    return {\n      loading: false, dialog: false, title: '修改密码', form: { oldPass: '', newPass: '', confirmPass: '' },\n      rules: {\n        oldPass: [\n          { required: true, message: '请输入旧密码', trigger: 'blur' }\n        ],\n        newPass: [\n          { required: true, message: '请输入新密码', trigger: 'blur' },\n          { min: 6, max: 20, message: '长度在 6 到 16 个字符', trigger: 'blur' }\n          // { validator:passwordValidator}\n        ],\n        confirmPass: [\n          { required: true, validator: confirmPass, trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  methods: {\n    cancel() {\n      this.resetForm()\n      Cookies.remove('defaultPass')\n    },\n    doSubmit() {\n      this.$refs['form'].validate((valid) => {\n        if (valid) {\n          this.loading = true\n          updatePass(this.form).then(res => {\n            this.resetForm()\n            this.$notify({\n              title: '密码修改成功，请重新登录',\n              type: 'success',\n              duration: 1500\n            })\n            setTimeout(() => {\n              store.dispatch('LogOut').then(() => {\n                location.reload() // 为了重新实例化vue-router对象 避免bug\n              })\n            }, 1500)\n          }).catch(err => {\n            this.loading = false\n            console.log(err.response.data.message)\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    resetForm() {\n      this.dialog = false\n      this.$refs['form'].resetFields()\n      this.form = { oldPass: '', newPass: '', confirmPass: '' }\n    }\n  }\n}\n",null]}