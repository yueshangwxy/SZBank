{"remainingRequest":"C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\src\\views\\indicators\\indicator\\atom\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\src\\views\\indicators\\indicator\\atom\\index.vue","mtime":1646613448356},{"path":"C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Evicce\\Desktop\\work\\code2\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport crudIndAtomInfo, {\r\n  getColumnByTabel,\r\n  getDimensions,\r\n  getGenAndDerivedInd,\r\n  getAllInds,\r\n  getGenInd,\r\n  getTablesById,\r\n  bizNameIsContract,\r\n  abolish,\r\n  startProcess,\r\n  delAtom,\r\n  getHisList,\r\n  checkRef,\r\n  approveDetailByOriginalInstId,\r\n  checkDefRule\r\n} from '@/api/indicators/indAtomInfo'\r\nimport crudIndDimInfo, {getDimInfos} from '@/api/indicators/indDimInfo'\r\nimport crudIndDimVal, {getDimValues, getDimValuesChildren} from '@/api/indicators/indDimValue'\r\nimport {getAllSource, getDimInfo, process} from '@/api/indicators/indIndicatorInfo'\r\nimport CRUD, {crud, form, header, presenter} from '@crud/crud'\r\nimport rrOperation from '@crud/RR.operation'\r\nimport crudOperation from '@crud/CRUD.operation'\r\nimport udOperation from '@crud/UD.operation'\r\nimport pagination from '@crud/Pagination'\r\nimport category from '../../category/categoryNew'\r\nimport dimensionPage from '../atom/dimension/index'\r\nimport atomPage from './atomPage'\r\nimport selectAtom from './selectAtom'\r\nimport {\r\n  isSignedInteger,\r\n  isArabicFigures,\r\n  validateStrLenFiveHundred,\r\n  validateStrLenHundred,\r\n  validateStrLenHalfHundred\r\n} from '@/utils/validator'\r\nimport {getClassifications} from '@/api/indicators/indClassification'\r\nimport crudIndCategory from '@/api/indicators/indCategory'\r\nimport {getDepts, getCurrentDept} from '@/utils/system'\r\nimport Treeselect from '@riophae/vue-treeselect'\r\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\r\nimport DimValTreeSelect from '../../dimension/DimValTreeSelect'\r\nimport qs from 'qs'\r\nimport {v4 as uuidv4} from 'uuid'\r\nimport {checkDeptUser} from '@/api/workflow/graphConfig'\r\n// crud交由presenter持有\r\nconst defaultCrud = CRUD({\r\n  title: '指标信息',\r\n  url: crudIndAtomInfo.url,\r\n  sort: 'id,desc',\r\n  crudMethod: {...crudIndAtomInfo.crud}\r\n})\r\nconst defaultForm = {\r\n  id: null,\r\n  categoryId: null,\r\n  sourceDataSource: 'local',\r\n  targetDataSource: 'local',\r\n  bizCode: null,\r\n  bizName: null,\r\n  genBizName: null,// 根指标名称\r\n  indFirstType: null,// 指标一级分类\r\n  indSecondType: null,// 指标二级分类\r\n  businessDept: null,// 业务属主部门\r\n  indLevel: null, // 指标层级\r\n  isDeptQuery: true,// 是否部门内部都可查询指标结果\r\n  isAdditionalRecording: 'false',// 指标结果是否会补录\r\n  indDimAndValueRelations: [],\r\n  indDefinition: null,// 指标定义\r\n  indDefRule: null,// 指标口径规则\r\n  indValueRange1: null,// 指标取值范围1\r\n  indValueRange2: null,// 指标取值范围2\r\n  indInnerWarnValue: '',// 指标内部警戒值（表示预警）\r\n  indInnerWarnPassValue: '',// 指标内部警戒值（表示通过）\r\n  indInnerWarnFlg: '',\r\n  indMonWarnValue: '',// 指标监管警戒值（表示预警）\r\n  indMonWarnPassValue: '',// 指标监管警戒值（表示通过）\r\n  indMonWarnFlg: '',\r\n  currency: null,// 币种\r\n  indValueType: null,// 指标数值属性\r\n  indFrequency: [],// 指标生成频率\r\n  indCalType: null,// 度量单位\r\n  indSafeLevel: null,// 指标安全等级\r\n  indMonField: null,// 监管属性\r\n  indProcessSys: null,// 权威加工系统\r\n  indDataType: null,// 数据类型\r\n  indDataForm: null,// 数据格式\r\n  indReference: null,// 参考依据\r\n  isRealTimeProcess: false,// 是否需要实时加工\r\n  indCurrentValue: true,// 当期值\r\n  indContemporaneousValue: true,// 同期值\r\n  indYearOnYearIncrement: true,// 同比增量\r\n  indYearOnYearGrowth: true,// 同比增幅\r\n  indPreviousPeriodValue: true,// 上期值\r\n  indMonthOnMonthIncrement: true,// 环比增量\r\n  indMonthOnMonthGrowth: true,// 环比增幅\r\n  indInitialValueOfTheYear: true,// 年初值\r\n  indYearOnYearIncre: true,// 较年初增量\r\n  indIncreaseOverTheBeginningOfTheYear: true,// 较年初增幅\r\n  indVerifyStatus: null,// 指标审批状态\r\n  indDeployStatus: null,// 指标发布状态\r\n  indVerifyId: null,\r\n  indStandSource: null,// 标准来源\r\n  ieProp: null,\r\n  createTable: null,\r\n  keepHistory: '1',\r\n  bizTabCode: null,\r\n  bizFlag: null,\r\n  bizCalcSql: null,// 实时指标取数SQL\r\n  bizBatchCalcSql: null,// 批量指标取数SQL\r\n  dimNames: null,\r\n  bizDesc: null,\r\n  calcSeq: null,\r\n  calcFreq: null,\r\n  crtUserCode: null,\r\n  crtOrgCode: null,\r\n  crtDate: null,\r\n  updUserCode: null,\r\n  updOrgCode: null,\r\n  updDate: null,\r\n  tenant: null,\r\n  retention: null,\r\n  tableShare: '1',\r\n  status: '2',\r\n  categoryType: '0',\r\n  atomDimensions: [],\r\n  indDefRuleStr: '',\r\n  indDefRuleVal: '',\r\n  submitType: 1\r\n}\r\nexport default {\r\n  name: 'IndAtomInfo',\r\n  components: {\r\n    Treeselect,\r\n    pagination,\r\n    crudOperation,\r\n    rrOperation,\r\n    udOperation,\r\n    category,\r\n    dimensionPage,\r\n    atomPage,\r\n    selectAtom,\r\n    DimValTreeSelect\r\n  },\r\n  mixins: [presenter(defaultCrud), header(), form(defaultForm), crud()],\r\n  dicts: ['IE_PROP', 'CREATE_TABLE', 'YN', 'RETENTION', 'IE_STATUS', 'GEN_IND', 'IND_FIRST_TYPE', 'IND_SECOND_TYPE', 'BUSSINESS_DEPT',\r\n    'IND_LEVEL', 'IND_CURRENCY', 'IND_VALUE_TYPE', 'IE_FREQUENCY', 'IND_CAL_TYPE', 'IND_SAFE_LEVEL', 'IND_MON_FIELD', 'IND_PROCESS_SYS',\r\n    'IND_DATA_TYPE', 'IND_STAND_SOURCE', 'DIMENSION_CATEGORY', 'DIMENSION', 'LAST_LEVEL_DIMENSION_VALUE', 'IND_VERIFY_STATUS', 'IND_DEPLOY_STATUS'],\r\n  data() {\r\n    return {\r\n      categoryType: '0',\r\n      sign: {\r\n        isSign: '0',\r\n        signDeptId: null,\r\n        signDeptName: null,\r\n        oprType: 1,\r\n        title: '发起审批流程',\r\n        msg: '是否发起审批流程? ',\r\n        data: null\r\n      },\r\n      showSign: false,\r\n      showSignOrg: false,\r\n      errmsgIndDefRule: false,\r\n      indDefRuleErr: '指标口径规则不能为空',\r\n      signTitle: '发起审批流程',\r\n      filterText: '',\r\n      indexOrgTab: {\r\n        menuLoading: false,\r\n        data: [],\r\n        loading: false,\r\n        operators: [],\r\n        strictly: true\r\n      },\r\n      dimAndValueObject1: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject2: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject3: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject4: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject5: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject6: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject7: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject8: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject9: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      dimAndValueObject10: {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      },\r\n      errmsgInnerWarning: false,\r\n      errmsgMonWarning: false,\r\n      innerwarningErrMsg: '请选择运算符',\r\n      monwarningErrMsg: '请选择运算符',\r\n      table: {\r\n        columns: {\r\n          sourceDataSource: 'hidden',\r\n          targetDataSource: 'hidden',\r\n          keepHistory: 'hidden',\r\n          bizDesc: 'hidden',\r\n          crtOrgCode: 'hidden',\r\n          crtDate: 'hidden',\r\n          updUserCode: 'hidden',\r\n          updOrgCode: 'hidden',\r\n          updDate: 'hidden',\r\n          tenant: 'hidden'\r\n        }\r\n      },\r\n      permission: {\r\n        processA: ['indAtomInfo:processA'],\r\n        add: ['indAtomInfo:add'],\r\n        edit: ['indAtomInfo:edit'],\r\n        del: ['indAtomInfo:del'],\r\n        details: ['indAtomInfo:details'],\r\n        workflow: ['indAtomInfo:workflow'],\r\n        batchCheckResult: ['indAtomInfo:batchCheckResult'],\r\n        historyVersion: ['indAtomInfo:historyVersion'],\r\n        cancelInd: ['indAtomInfo:cancelInd'],\r\n        processVerify: ['indAtomInfo:processVerify'],\r\n        historyVersionDetail: ['indAtomInfo:historyVersionDetail']\r\n      },\r\n      rules: {\r\n        bizName: [\r\n          /* { required: true, message: '指标名称不能为空', trigger: 'blur' },*/\r\n          {validator: validateStrLenHundred, trigger: 'blur'}\r\n        ],\r\n        /*ieProp: [\r\n          { required: true, message: '指标类型不能为空', trigger: 'change' }\r\n        ],*/\r\n        /*genBizName: [\r\n          { required: true, message: '根指标不能为空', trigger: 'change' }\r\n        ],*/\r\n        /*indFirstType: [\r\n          { required: true, message: '指标一级分类不能为空', trigger: 'change' }\r\n        ],\r\n        indSecondType: [\r\n          { required: true, message: '指标二级分类不能为空', trigger: 'change' }\r\n        ],*/\r\n        businessDept: [\r\n          {required: true, message: '业务属主部门不能为空', trigger: 'change'}\r\n        ],\r\n        /*indLevel: [\r\n          { required: true, message: '指标层级不能为空', trigger: 'change' }\r\n        ],*/\r\n        /*indDefinition: [\r\n          { required: true, message: '指标定义不能为空', trigger: 'blur' },\r\n          { validator: validateStrLenFiveHundred, trigger: 'blur' }\r\n        ],*/\r\n        /*indDefRule: [\r\n         /!* { required: this.hasCalc, message: '指标口径规则不能为空', trigger: 'blur' },*!/\r\n          { required: true, message: '指标口径规则不能为空', trigger: 'blur' },\r\n          { validator: validateStrLenFiveHundred, trigger: 'blur' }\r\n        ],*/\r\n        indValueRange1: [\r\n          {validator: isArabicFigures, trigger: 'blur'}\r\n        ],\r\n        indValueRange2: [\r\n          {validator: isArabicFigures, trigger: 'blur'}\r\n        ],\r\n        /*currency: [\r\n          { required: true, message: '币种不能为空', trigger: 'change' }\r\n        ],\r\n        indFrequency: [\r\n          { required: true, message: '指标生成频率不能为空', trigger: 'change' }\r\n        ],\r\n        indCalType: [\r\n          { required: true, message: '度量单位不能为空', trigger: 'change' }\r\n        ],\r\n        indMonField: [\r\n          { required: true, message: '监管属性不能为空', trigger: 'change' }\r\n        ],\r\n        indDataType: [\r\n          { required: true, message: '数据类型不能为空', trigger: 'change' }\r\n        ],*/\r\n        indDataForm: [\r\n          {max: 10, message: '数据格式不能超过10字', trigger: ['blur', 'change']}\r\n        ],\r\n        indReference: [\r\n          {max: 50, message: '参考不能超过50字', trigger: ['blur', 'change']}\r\n        ],\r\n        isAdditionalRecording: [\r\n          {required: true, message: '指标结果是否会补录不能为空', trigger: 'change'}\r\n        ],\r\n        indProcessSys: [\r\n          {max: 100, message: '不能超过100字', trigger: ['blur', 'change']}\r\n        ]\r\n        /*,\r\n        dimension1: [\r\n          {required: true, message: '维度1不能为空', trigger: 'change'}\r\n        ],\r\n        dimensionValue1: [\r\n          {required: true, message: '维度值1不能为空', trigger: 'change'}\r\n        ]*/\r\n      },\r\n      dimensionRules: {\r\n        categoryName: [\r\n          {required: true, message: '指标维度名称不能为空', trigger: 'change'}\r\n        ],\r\n        classificationId: [\r\n          {required: true, message: '所属分类不能为空', trigger: 'change'}\r\n        ],\r\n      },\r\n      dimensionValueRules: {\r\n        dimInfoId: [\r\n          {required: true, message: '所属维度不能为空', trigger: 'change'}\r\n        ],\r\n        categoryName: [\r\n          {required: true, message: '指标维度值不能为空', trigger: 'change'}\r\n        ]\r\n      },\r\n      signRules: {\r\n        isSign: [\r\n          {required: true, message: '请选择是否会签', trigger: 'change'}\r\n        ],\r\n        signDeptId: [\r\n          {required: true, message: '请选择会签机构', trigger: 'change'}\r\n        ]\r\n      },\r\n      sourceData: [],\r\n      tableInfo: [],\r\n      atomDimensions: [],\r\n      bizTabCodeDis: false,\r\n      // 计算输日期的页面\r\n      processDialog: false,\r\n      // 传给后台的参数\r\n      processParam: {\r\n        codes: [],\r\n        periodDate: ''\r\n      },\r\n      dateValue: '',\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'label'\r\n      },\r\n      dimensionArr: [],\r\n      dimensionTitle: '维度',\r\n      dimensionNumber: 2,\r\n      dimensionTmp: null,\r\n      dimensionValueArr: [],\r\n      dimensionValueTitle: '维度值',\r\n      dimensionValueNumber: 2,\r\n      dimensionValueTmp: null,\r\n      showIndDefRule: false,\r\n      showIndHistory: false,\r\n      indInnerWarnValueArr: [1],\r\n      indInnerWarnValueNumber: 1,\r\n      indInnerWarnPassValueArr: [1],\r\n      indInnerWarnPassValueNumber: 1,\r\n      indMonWarnValueArr: [1],\r\n      indMonWarnValueNumber: 1,\r\n      indMonWarnPassValueArr: [1],\r\n      indMonWarnPassValueNumber: 1,\r\n      historyData: [],\r\n      showIndDimensionAdd: false,\r\n      flowData: [],\r\n      showFlow: false,\r\n      dimension: {\r\n        id: null,\r\n        classificationId: null,// 所属分类\r\n        categoryName: null,// 指标维度名称\r\n        remarks: null,// 备注\r\n        serialNo: null\r\n      },\r\n      showIndDimensionValueAdd: false,\r\n      dimensionValue: {\r\n        dimension: null,// 所属维度\r\n        lastLevelDimensionValue: null,// 上级维度值\r\n        dimValue: null,// 指标维度值\r\n        serialNo: null\r\n      },\r\n      renderFunc(h, option) {\r\n        return <span>{option.label}</span>;\r\n      },\r\n      transferData: [],\r\n      value: [],\r\n      indDefRuleStr: '',\r\n      indDefRuleId: '',\r\n      indDefRuleVal: '',\r\n      indDefRuleStrs: [],\r\n      indDefRuleIds: [],\r\n      indDefRuleVals: [],\r\n      genIndArr: [],\r\n      genAndDerivedIndArr: [],\r\n      dimInfoArr: [],\r\n      dimValueArr1: [],\r\n      dimValueArr2: [],\r\n      dimValueArr3: [],\r\n      dimValueArr4: [],\r\n      dimValueArr5: [],\r\n      dimValueArr6: [],\r\n      dimValueArr7: [],\r\n      dimValueArr8: [],\r\n      dimValueArr9: [],\r\n      dimValueArr10: [],\r\n      parentDimValueArr: [],\r\n      classificationArr: [],\r\n      dimValueTmp1: [],\r\n      dimValueTmp2: [],\r\n      dimValueTmp3: [],\r\n      dimValueTmp4: [],\r\n      dimValueTmp5: [],\r\n      dimValueTmp6: [],\r\n      dimValueTmp7: [],\r\n      dimValueTmp8: [],\r\n      dimValueTmp9: [],\r\n      dimValueTmp10: [],\r\n\r\n      dimValueTmpName1: [],\r\n      dimValueTmpName2: [],\r\n      dimValueTmpName3: [],\r\n      dimValueTmpName4: [],\r\n      dimValueTmpName5: [],\r\n      dimValueTmpName6: [],\r\n      dimValueTmpName7: [],\r\n      dimValueTmpName8: [],\r\n      dimValueTmpName9: [],\r\n      dimValueTmpName10: [],\r\n\r\n      formDialog: false,\r\n      qryIndFirstType: [],\r\n      qryIndSecondType: [],\r\n      formIndFirstType: [],\r\n      formIndSecondType: [],\r\n      depts: [],\r\n      hisIeId: null,\r\n      errmsgDim1: false,\r\n      errmsgDimV1: false,\r\n      errmsgDim2: false,\r\n      errmsgDimV2: false,\r\n      errmsgDim3: false,\r\n      errmsgDimV3: false,\r\n      errmsgDim4: false,\r\n      errmsgDimV4: false,\r\n      errmsgDim5: false,\r\n      errmsgDimV5: false,\r\n      errmsgDim6: false,\r\n      errmsgDimV6: false,\r\n      errmsgDim7: false,\r\n      errmsgDimV7: false,\r\n      errmsgDim8: false,\r\n      errmsgDimV8: false,\r\n      errmsgDim9: false,\r\n      errmsgDimV9: false,\r\n      errmsgDim10: false,\r\n      errmsgDimV10: false,\r\n      errmsgIeProp: false,\r\n      errmsgIndFirstType: false,\r\n      errmsgIndSecondType: false,\r\n      isBizNameContract: true,\r\n      errmsgIndLevel: false,\r\n      errmsgCurrency: false,\r\n      errmsgFrequency: false,\r\n      errmsgIndCalType: false,\r\n      errmsgIndMonField: false,\r\n      errmsgIndDataType: false,\r\n      errmsgIndDefinition: false,\r\n      errmsgIndDefinitionStr: '指标定义不能为空',\r\n      errmsgBizName: false,\r\n      //hasCalc: false\r\n      hasCalc: true,\r\n      isSelfRule: false,\r\n      categorySpan: 6,\r\n      tableSpan: 18,\r\n      zoomDirection: 'left'\r\n    }\r\n  },\r\n  created() {\r\n    this.crud.optShow.del = false\r\n    this.crud.optShow.edit = false\r\n    this.initDimInfos(2)\r\n    //this.initDimValuesChildren()\r\n    this.initDimValues(2)\r\n    this.initClassifications()\r\n    this.initGenAndDerivedInd()\r\n    this.initIndFirstType()\r\n    this.getDepts();\r\n    if (this.query.categoryType == null) {\r\n      this.query.categoryType = 0;\r\n    }\r\n    this.isSelfRule = false\r\n    this.getCurrentDept()\r\n    this.resetQuery()\r\n  },\r\n  mounted() {\r\n    this.query.bizName = this.$route.query.ieName\r\n    if (this.query.categoryType == null) {\r\n      this.query.categoryType = 0;\r\n    }\r\n    this.crud.refresh()\r\n    this.sign.isSign = '0'\r\n    this.sign.signDeptId = null\r\n    this.sign.signDeptName = null\r\n    this.showSignOrg = false\r\n  },\r\n  watch: {\r\n    filterText(val) {\r\n      this.$refs.signOrgTree.filter(val);\r\n    },\r\n    indDefRuleStr(val) {\r\n      if (this.endsWithStr(val)) {\r\n        this.errmsgIndDefRule = true\r\n        this.indDefRuleErr = '口径规则表达式错误'\r\n      } else {\r\n        this.errmsgIndDefRule = false\r\n        this.indDefRuleErr = '指标口径规则不能为空'\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    resetQuery() {\r\n      this.crud.resetQuery(false);\r\n      if (this.categoryType == null) {\r\n        this.query.categoryType = '0'\r\n      } else {\r\n        this.query.categoryType = this.categoryType\r\n      }\r\n\r\n      //this.crud.refresh()\r\n    },\r\n    checkIndDefRule(val) {\r\n      /*if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n        if(this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = true\r\n        } else if (this.form.indDefRule.length > 500){\r\n          this.indDefRuleErr = '长度不能超过500字符'\r\n          this.errmsgIndDefRule = true\r\n        } else {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = false\r\n        }\r\n      } else {\r\n        this.indDefRuleErr = '指标口径规则不能为空'\r\n        this.errmsgIndDefRule = false\r\n      }*/\r\n      if (this.isSelfRule) {\r\n        if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = true\r\n          return false;\r\n        } else if (this.form.indDefRule.length > 500) {\r\n          this.indDefRuleErr = '长度不能超过500字符'\r\n          this.errmsgIndDefRule = true\r\n          return false;\r\n        } else {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = false\r\n          return true;\r\n        }\r\n      } else {\r\n        if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = true\r\n          return false;\r\n        } else if (this.form.indDefRule.length > 500) {\r\n          this.indDefRuleErr = '长度不能超过500字符'\r\n          this.errmsgIndDefRule = true\r\n          return false;\r\n        } else {\r\n          //合规行校验\r\n          var formulaFlag = this.checkFormulaExp(this.form.indDefRule);\r\n\r\n          if (!formulaFlag) {\r\n            this.indDefRuleErr = '指标口径规则错误！'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n          let formulaExp = this.setFormulaExp(this.form.indDefRule);\r\n          if (formulaExp == null) {\r\n            this.indDefRuleErr = '指标口径规则错误！'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n          formulaExp = formulaExp.replaceAll(\"#\", \"[\");\r\n          //formulaExp.replaceAll(\"#\", \"[\");\r\n          let data = {\r\n            indDefRule: this.form.indDefRule,\r\n            indDefRuleExp: formulaExp,\r\n            indDefRuleStrs: this.indDefRuleStrs,\r\n            indDefRuleIds: this.indDefRuleIds\r\n          }\r\n          checkDefRule(data).then(res => {\r\n            if (res.code == 0) {\r\n              console.log(\"data===>\" + res.data)\r\n              this.indDefRuleErr = '指标口径规则不能为空'\r\n              this.errmsgIndDefRule = false\r\n              return true;\r\n            } else {\r\n              this.indDefRuleErr = res.msg\r\n              this.errmsgIndDefRule = true\r\n              return false;\r\n            }\r\n          });\r\n        }\r\n      }\r\n    },\r\n    closeSignDialog() {\r\n      this.sign.isSign = 0;\r\n      this.sign.signDeptId = ''\r\n      this.sign.signDeptName = null\r\n      this.showSign = false\r\n      this.showSignOrg = false\r\n    },\r\n    changeIsSign(val) {\r\n      this.showSignOrg = val == 1;\r\n    },\r\n    filterNode(value, data) {\r\n      if (!value) return true;\r\n      return data.label.indexOf(value) !== -1;\r\n    },\r\n    checkSignOrg(data, node) {\r\n      console.debug('======checkSignOrg======', data, node)\r\n      this.sign.signDeptId = node.checkedKeys.join(\",\")\r\n      this.sign.signDeptName = node.checkedNodes.map(e => e.label).join(\",\")\r\n\r\n    },\r\n    changeIeProp(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIeProp = true;\r\n      } else {\r\n        this.errmsgIeProp = false;\r\n      }\r\n      if (val == 3) {\r\n        this.dimAndValueObject1.isShow = true;\r\n        this.dimAndValueObject2.isShow = true;\r\n      } else {\r\n        this.dimAndValueObject1.isShow = false;\r\n        this.dimAndValueObject2.isShow = false;\r\n      }\r\n      if (val == 2) {\r\n        this.isSelfRule = false\r\n      } else {\r\n        this.isSelfRule = true\r\n      }\r\n      this.changeIsSelfRule(this.isSelfRule)\r\n      /*if(val == 2) {\r\n        if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n          //this.hasCalc = true;\r\n        }else {\r\n          //this.hasCalc = false;\r\n        }\r\n      } else {\r\n        //this.hasCalc = false;\r\n      }*/\r\n    },\r\n    changeContemporaneous(val) {\r\n      if (val) {\r\n        this.form.indContemporaneousValue = val;\r\n        this.form.indYearOnYearIncrement = val;\r\n      }\r\n    },\r\n    changePreviousPeriod(val) {\r\n      if (val) {\r\n        this.form.indPreviousPeriodValue = val;\r\n        this.form.indMonthOnMonthIncrement = val;\r\n      }\r\n    },\r\n    changeInitialValue(val) {\r\n      if (val) {\r\n        this.form.indInitialValueOfTheYear = val;\r\n        this.form.indYearOnYearIncre = val;\r\n      }\r\n    },\r\n    forceUpdate() {\r\n      this.$forceUpdate()\r\n    },\r\n    genBizNameChange() {\r\n      for (let i = 0; i < Object.keys(this.genIndArr).length; i++) {\r\n        if (this.genIndArr[i].id == this.form.genBizName) {\r\n          if (this.genIndArr[i].isAdditionalRecording == true) {\r\n            this.warnMsg = true\r\n            this.$message({\r\n              message: '该指标结果可能存在补录，请确认是否引用！',\r\n              type: 'warning'\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    validateBizNameContract() {\r\n      let that = this;\r\n      bizNameIsContract(that.form.id, that.form.bizName).then(res => {\r\n        if (res.code == 0) {\r\n          if (res.data) {\r\n            this.$message.error(\"指标名称重复,请重新输入\")\r\n            that.isBizNameContract = false\r\n            return;\r\n          }\r\n          that.isBizNameContract = true\r\n        } else {\r\n          this.$message.error(\"系统错误\")\r\n          that.isBizNameContract = false\r\n        }\r\n      })\r\n    },\r\n    initDimInfos(status) {\r\n      getDimInfos({size: 100, page: 0, tenant: this.form.tenant, status: status}).then(data => {\r\n        this.dimInfoArr = data.data.records\r\n      })\r\n    },\r\n    initSubDimVal(dimId, treeLevel, status) {\r\n      getDimValues({\r\n        size: 100,\r\n        page: 0,\r\n        tenant: this.form.tenant,\r\n        status: status,\r\n        treeLevel: treeLevel,\r\n        treeId: dimId\r\n      }).then(data => {\r\n        this.parentDimValueArr = data.data.records\r\n      })\r\n    },\r\n    initDimVal(dimId, item) {\r\n      let _this = this;\r\n      if (item == 1) {\r\n        _this.dimAndValueObject1.dimensionValue = '';\r\n        _this.dimAndValueObject1.dimensionName = '';\r\n        _this.dimValueTmpName1 = []\r\n      } else if (item == 2) {\r\n        _this.dimAndValueObject2.dimensionValue = '';\r\n        _this.dimAndValueObject2.dimensionName = '';\r\n        _this.dimValueTmpName2 = []\r\n      } else if (item == 3) {\r\n        _this.dimAndValueObject3.dimensionValue = '';\r\n        _this.dimAndValueObject3.dimensionName = '';\r\n        _this.dimValueTmpName3 = []\r\n      } else if (item == 4) {\r\n        _this.dimAndValueObject4.dimensionValue = '';\r\n        _this.dimAndValueObject4.dimensionName = '';\r\n        _this.dimValueTmpName4 = []\r\n      } else if (item == 5) {\r\n        _this.dimAndValueObject5.dimensionValue = '';\r\n        _this.dimAndValueObject5.dimensionName = '';\r\n        _this.dimValueTmpName5 = []\r\n      } else if (item == 6) {\r\n        _this.dimAndValueObject6.dimensionValue = '';\r\n        _this.dimAndValueObject6.dimensionName = '';\r\n        _this.dimValueTmpName6 = []\r\n      } else if (item == 7) {\r\n        _this.dimAndValueObject7.dimensionValue = '';\r\n        _this.dimAndValueObject7.dimensionName = '';\r\n        _this.dimValueTmpName7 = []\r\n      } else if (item == 8) {\r\n        _this.dimAndValueObject8.dimensionValue = '';\r\n        _this.dimAndValueObject8.dimensionName = '';\r\n        _this.dimValueTmpName8 = []\r\n      } else if (item == 9) {\r\n        _this.dimAndValueObject9.dimensionValue = '';\r\n        _this.dimAndValueObject9.dimensionName = '';\r\n        _this.dimValueTmpName9 = []\r\n      } else if (item == 10) {\r\n        _this.dimAndValueObject10.dimensionValue = '';\r\n        _this.dimAndValueObject10.dimensionName = '';\r\n        _this.dimValueTmpName10 = []\r\n      }\r\n\r\n      this.initDimValuesChildren(dimId, item);\r\n    },\r\n    initDimValuesChildren(dimId, item) {\r\n      let _this = this;\r\n      getDimValuesChildren({size: 100, page: 0, dimId}).then(data => {\r\n        if (item == 1) {\r\n          _this.dimValueArr1 = data.data\r\n          if (dimId == null || dimId == '') {\r\n            _this.errmsgDim1 = true;\r\n            _this.dimAndValueObject1.dimensionValue = '';\r\n            _this.dimAndValueObject1.dimensionName = '';\r\n            _this.errmsgDimV1 = true;\r\n          } else if (_this.dimAndValueObject1.dimensionValue == null || _this.dimAndValueObject1.dimensionValue == '') {\r\n            _this.errmsgDimV1 = true;\r\n            _this.errmsgDim1 = false;\r\n            _this.dimAndValueObject1.dimensionValue = '';\r\n            _this.dimAndValueObject1.dimensionName = '';\r\n          }\r\n        } else if (item == 2) {\r\n          _this.dimValueArr2 = data.data\r\n          if (_this.dimAndValueObject2.dimension == null || _this.dimAndValueObject2.dimension == '') {\r\n            _this.errmsgDimV2 = false;\r\n            _this.dimAndValueObject2.dimensionValue = '';\r\n            _this.dimAndValueObject2.dimensionName = '';\r\n          } else if (_this.dimAndValueObject2.dimensionValue == null || _this.dimAndValueObject2.dimensionValue == '') {\r\n            _this.errmsgDimV2 = true;\r\n            _this.dimAndValueObject2.dimensionValue = '';\r\n            _this.dimAndValueObject2.dimensionName = '';\r\n          }\r\n        } else if (item == 3) {\r\n          _this.dimValueArr3 = data.data\r\n          if (_this.dimAndValueObject3.dimension == null || _this.dimAndValueObject3.dimension == '') {\r\n            _this.errmsgDimV3 = false;\r\n            _this.dimAndValueObject3.dimensionValue = '';\r\n            _this.dimAndValueObject3.dimensionName = '';\r\n          } else if (_this.dimAndValueObject3.dimensionValue == null || _this.dimAndValueObject3.dimensionValue == '') {\r\n            _this.errmsgDimV3 = true;\r\n            _this.dimAndValueObject3.dimensionValue = '';\r\n            _this.dimAndValueObject3.dimensionName = '';\r\n          }\r\n        } else if (item == 4) {\r\n          _this.dimValueArr4 = data.data\r\n          if (_this.dimAndValueObject4.dimension == null || _this.dimAndValueObject4.dimension == '') {\r\n            _this.errmsgDimV4 = false;\r\n            _this.dimAndValueObject4.dimensionValue = '';\r\n            _this.dimAndValueObject4.dimensionName = '';\r\n          } else if (_this.dimAndValueObject4.dimensionValue == null || _this.dimAndValueObject4.dimensionValue == '') {\r\n            _this.errmsgDimV4 = true;\r\n            _this.dimAndValueObject4.dimensionValue = '';\r\n            _this.dimAndValueObject4.dimensionName = '';\r\n          }\r\n        } else if (item == 5) {\r\n          _this.dimValueArr5 = data.data\r\n          if (_this.dimAndValueObject5.dimension == null || _this.dimAndValueObject5.dimension == '') {\r\n            _this.errmsgDimV5 = false;\r\n            _this.dimAndValueObject5.dimensionValue = '';\r\n            _this.dimAndValueObject5.dimensionName = '';\r\n          } else if (_this.dimAndValueObject5.dimensionValue == null || _this.dimAndValueObject5.dimensionValue == '') {\r\n            _this.errmsgDimV5 = true;\r\n            _this.dimAndValueObject5.dimensionValue = '';\r\n            _this.dimAndValueObject5.dimensionName = '';\r\n          }\r\n        } else if (item == 6) {\r\n          _this.dimValueArr6 = data.data\r\n          if (_this.dimAndValueObject6.dimension == null || _this.dimAndValueObject6.dimension == '') {\r\n            _this.errmsgDimV6 = false;\r\n            _this.dimAndValueObject6.dimensionValue = '';\r\n            _this.dimAndValueObject6.dimensionName = '';\r\n          } else if (_this.dimAndValueObject6.dimensionValue == null || _this.dimAndValueObject6.dimensionValue == '') {\r\n            _this.errmsgDimV6 = true;\r\n            _this.dimAndValueObject6.dimensionValue = '';\r\n            _this.dimAndValueObject6.dimensionName = '';\r\n          }\r\n        } else if (item == 7) {\r\n          _this.dimValueArr7 = data.data\r\n          if (_this.dimAndValueObject7.dimension == null || _this.dimAndValueObject7.dimension == '') {\r\n            _this.errmsgDimV7 = false;\r\n            _this.dimAndValueObject7.dimensionValue = '';\r\n            _this.dimAndValueObject7.dimensionName = '';\r\n          } else if (_this.dimAndValueObject7.dimensionValue == null || _this.dimAndValueObject7.dimensionValue == '') {\r\n            _this.errmsgDimV7 = true;\r\n            _this.dimAndValueObject7.dimensionValue = '';\r\n            _this.dimAndValueObject7.dimensionName = '';\r\n          }\r\n        } else if (item == 8) {\r\n          _this.dimValueArr8 = data.data\r\n          if (_this.dimAndValueObject8.dimension == null || _this.dimAndValueObject8.dimension == '') {\r\n            _this.errmsgDimV8 = false;\r\n            _this.dimAndValueObject8.dimensionValue = '';\r\n            _this.dimAndValueObject8.dimensionName = '';\r\n          } else if (_this.dimAndValueObject8.dimensionValue == null || _this.dimAndValueObject8.dimensionValue == '') {\r\n            _this.errmsgDimV8 = true;\r\n            _this.dimAndValueObject8.dimensionValue = '';\r\n            _this.dimAndValueObject8.dimensionName = '';\r\n          }\r\n        } else if (item == 9) {\r\n          _this.dimValueArr9 = data.data\r\n          if (_this.dimAndValueObject9.dimension == null || _this.dimAndValueObject9.dimension == '') {\r\n            _this.errmsgDimV9 = false;\r\n            _this.dimAndValueObject9.dimensionValue = '';\r\n            _this.dimAndValueObject9.dimensionName = '';\r\n          } else if (_this.dimAndValueObject9.dimensionValue == null || _this.dimAndValueObject9.dimensionValue == '') {\r\n            _this.errmsgDimV9 = true;\r\n            _this.dimAndValueObject9.dimensionValue = '';\r\n            _this.dimAndValueObject9.dimensionName = '';\r\n          }\r\n        } else if (item == 10) {\r\n          _this.dimValueArr10 = data.data\r\n          if (_this.dimAndValueObject10.dimension == null || _this.dimAndValueObject10.dimension == '') {\r\n            _this.errmsgDimV10 = false;\r\n            _this.dimAndValueObject10.dimensionValue = '';\r\n            _this.dimAndValueObject10.dimensionName = '';\r\n          } else if (_this.dimAndValueObject10.dimensionValue == null || _this.dimAndValueObject10.dimensionValue == '') {\r\n            _this.errmsgDimV10 = true;\r\n            _this.dimAndValueObject10.dimensionValue = '';\r\n            _this.dimAndValueObject10.dimensionName = '';\r\n          }\r\n        }\r\n\r\n      })\r\n    },\r\n    initDimValues(status) {\r\n      getDimValues({size: 100, page: 0, tenant: this.form.tenant, status: status}).then(data => {\r\n        this.parentDimValueArr = data.data.records\r\n      })\r\n    },\r\n    initClassifications() {\r\n      getClassifications({size: 100, page: 0}).then(data => {\r\n        this.classificationArr = data.data.records\r\n      })\r\n    },\r\n    initGenAndDerivedInd() {\r\n      getAllInds().then(data => {\r\n        this.genAndDerivedIndArr = data.data\r\n        for (let i = 0; i < this.genAndDerivedIndArr.length; i++) {\r\n          this.transferData.push({\r\n            key: this.genAndDerivedIndArr[i].id + ',' + this.genAndDerivedIndArr[i].bizName + ',' + this.genAndDerivedIndArr[i].isAdditionalRecording + ',' + this.genAndDerivedIndArr[i].bizCode,\r\n            label: this.genAndDerivedIndArr[i].bizName\r\n          })\r\n        }\r\n      })\r\n    },\r\n    initIndFirstType() {\r\n      crudIndCategory.getCategoryList(0).then(res => {\r\n        this.qryIndFirstType = [];\r\n        this.formIndFirstType = [];\r\n        const data = res.data;\r\n        if (res.code == 0) {\r\n          for (let i = 0; i < data.length; i++) {\r\n            this.qryIndFirstType.push({id: data[i].id, label: data[i].categoryName, value: data[i].id})\r\n            this.formIndFirstType.push({id: data[i].id, label: data[i].categoryName, value: data[i].id})\r\n          }\r\n        }\r\n      })\r\n    },\r\n    initIndSecondType(indFirstType, type) {\r\n      if (type == \"query\") {\r\n        this.qryIndSecondType = [];\r\n      } else {\r\n        this.formIndSecondType = [];\r\n        if (indFirstType == null || indFirstType == '') {\r\n          this.errmsgIndFirstType = true;\r\n          return false;\r\n        } else {\r\n          this.errmsgIndFirstType = false;\r\n        }\r\n      }\r\n      //let indFirstType = this.query.indFirstType;\r\n      if (indFirstType == null) {\r\n        return;\r\n      }\r\n      crudIndCategory.getCategoryList(indFirstType).then(res => {\r\n        const data = res.data;\r\n        if (res.code == 0) {\r\n          for (let i = 0; i < data.length; i++) {\r\n            if (type == \"query\") {\r\n              this.qryIndSecondType.push({id: data[i].id, label: data[i].categoryName, value: data[i].id})\r\n            } else {\r\n              this.formIndSecondType.push({id: data[i].id, label: data[i].categoryName, value: data[i].id})\r\n            }\r\n\r\n          }\r\n        }\r\n      })\r\n    },\r\n    checkIndSecondType(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIndSecondType = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgIndSecondType = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkIndLevel(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIndLevel = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgIndLevel = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkCurrency(val) {\r\n\r\n      if (val == null || val == '') {\r\n        this.errmsgCurrency = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgCurrency = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkFrequency(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgFrequency = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgFrequency = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkIndCalType(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIndCalType = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgIndCalType = false;\r\n        return true;\r\n      }\r\n\r\n    },\r\n    checkIndMonField(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIndMonField = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgIndMonField = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkIndDataType(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIndDataType = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgIndDataType = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkBizName(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgBizName = true;\r\n        return false;\r\n      } else {\r\n        this.errmsgBizName = false;\r\n        return true;\r\n      }\r\n    },\r\n    checkIndDefinition(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgIndDefinition = true;\r\n        this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n        return false;\r\n      } else {\r\n        if (val.length > 500) {\r\n          this.errmsgIndDefinition = true;\r\n          this.errmsgIndDefinitionStr = '指标定义不能超过500字';\r\n          return false;\r\n        } else {\r\n          this.errmsgIndDefinition = false;\r\n          this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n          return true;\r\n        }\r\n\r\n      }\r\n    },\r\n    // 获取数据前设置好接口地址\r\n    [CRUD.HOOK.beforeRefresh]() {\r\n      //this.crud.optShow.edit = true\r\n      // this.query.ieType = '4'\r\n      if (this.query.categoryType == null) {\r\n        this.query.categoryType = '0'\r\n      }\r\n      return true\r\n    },\r\n    [CRUD.HOOK.afterRefresh]() {\r\n      // getAllSource().then(data => {\r\n      //   this.sourceData = [{ id: 'local', datasourceName: '默认数据源' }].concat(data.data)\r\n      // })\r\n      getGenInd().then(data => {\r\n        this.genIndArr = data.data\r\n      })\r\n    },\r\n    [CRUD.HOOK.beforeToEdit]() {\r\n      this.form.formType = 'edit';\r\n      this.form.serialNo = this.generatorUUID();\r\n      this.initDimInfos(2);\r\n      this.form.indVerifyStatus = this.crud.selections[0].indVerifyStatus\r\n      this.form.indDeployStatus = this.crud.selections[0].indDeployStatus\r\n      this.form.id = this.crud.selections[0].id\r\n      this.form.bizCode = this.crud.selections[0].bizCode\r\n      this.form.ieProp = this.crud.selections[0].ieProp\r\n      this.form.genBizName = this.crud.selections[0].genBizName\r\n      this.form.bizName = this.crud.selections[0].bizName\r\n      this.form.indFirstType = this.crud.selections[0].indFirstType\r\n      this.form.categoryType = this.crud.selections[0].categoryType\r\n      this.initIndSecondType(this.form.indFirstType, 'form')\r\n      this.form.indSecondType = this.crud.selections[0].indSecondType\r\n      if (this.form.ieProp == 3) {\r\n        this.dimAndValueObject1.isShow = true\r\n        this.dimAndValueObject1.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[0] == null ? null : this.crud.selections[0].indDimAndValueRelations[0].dimension\r\n        this.dimAndValueObject1.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[0] == null ? null : this.crud.selections[0].indDimAndValueRelations[0].dimensionValue\r\n        if (this.dimAndValueObject1.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject1.dimension, 1)\r\n        }\r\n        this.dimAndValueObject1.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[0] == null ? null : this.crud.selections[0].indDimAndValueRelations[0].dimensionName\r\n\r\n        this.dimAndValueObject2.isShow = true\r\n        this.dimAndValueObject2.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[1] == null ? null : this.crud.selections[0].indDimAndValueRelations[1].dimension\r\n        if (this.dimAndValueObject2.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject2.dimension, 2)\r\n        }\r\n        this.dimAndValueObject2.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[1] == null ? null : this.crud.selections[0].indDimAndValueRelations[1].dimensionValue\r\n        this.dimAndValueObject2.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[1] == null ? null : this.crud.selections[0].indDimAndValueRelations[1].dimensionName\r\n\r\n        this.dimAndValueObject3.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[2] == null ? false : true\r\n        this.dimAndValueObject3.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[2] == null ? null : this.crud.selections[0].indDimAndValueRelations[2].dimension\r\n        if (this.dimAndValueObject3.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject3.dimension, 3)\r\n        }\r\n        this.dimAndValueObject3.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[2] == null ? null : this.crud.selections[0].indDimAndValueRelations[2].dimensionValue\r\n        this.dimAndValueObject3.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[2] == null ? null : this.crud.selections[0].indDimAndValueRelations[2].dimensionName\r\n\r\n        this.dimAndValueObject4.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[3] == null ? false : true\r\n        this.dimAndValueObject4.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[3] == null ? null : this.crud.selections[0].indDimAndValueRelations[3].dimension\r\n        if (this.dimAndValueObject4.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject4.dimension, 4)\r\n        }\r\n        this.dimAndValueObject4.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[3] == null ? null : this.crud.selections[0].indDimAndValueRelations[3].dimensionValue\r\n        this.dimAndValueObject4.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[3] == null ? null : this.crud.selections[0].indDimAndValueRelations[3].dimensionName\r\n\r\n        this.dimAndValueObject5.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[4] == null ? false : true\r\n        this.dimAndValueObject5.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[4] == null ? null : this.crud.selections[0].indDimAndValueRelations[4].dimension\r\n        if (this.dimAndValueObject5.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject5.dimension, 5)\r\n        }\r\n        this.dimAndValueObject5.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[4] == null ? null : this.crud.selections[0].indDimAndValueRelations[4].dimensionValue\r\n        this.dimAndValueObject5.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[4] == null ? null : this.crud.selections[0].indDimAndValueRelations[4].dimensionName\r\n\r\n        this.dimAndValueObject6.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[5] == null ? false : true\r\n        this.dimAndValueObject6.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[5] == null ? null : this.crud.selections[0].indDimAndValueRelations[5].dimension\r\n        if (this.dimAndValueObject6.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject6.dimension, 6)\r\n        }\r\n        this.dimAndValueObject6.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[5] == null ? null : this.crud.selections[0].indDimAndValueRelations[5].dimensionValue\r\n        this.dimAndValueObject6.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[5] == null ? null : this.crud.selections[0].indDimAndValueRelations[5].dimensionName\r\n\r\n        this.dimAndValueObject7.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[6] == null ? false : true\r\n        this.dimAndValueObject7.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[6] == null ? null : this.crud.selections[0].indDimAndValueRelations[6].dimension\r\n        if (this.dimAndValueObject7.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject7.dimension, 7)\r\n        }\r\n        this.dimAndValueObject7.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[6] == null ? null : this.crud.selections[0].indDimAndValueRelations[6].dimensionValue\r\n        this.dimAndValueObject7.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[6] == null ? null : this.crud.selections[0].indDimAndValueRelations[6].dimensionName\r\n\r\n        this.dimAndValueObject8.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[7] == null ? false : true\r\n        this.dimAndValueObject8.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[7] == null ? null : this.crud.selections[0].indDimAndValueRelations[7].dimension\r\n        if (this.dimAndValueObject8.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject8.dimension, 8)\r\n        }\r\n        this.dimAndValueObject8.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[7] == null ? null : this.crud.selections[0].indDimAndValueRelations[7].dimensionValue\r\n        this.dimAndValueObject8.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[7] == null ? null : this.crud.selections[0].indDimAndValueRelations[7].dimensionName\r\n\r\n        this.dimAndValueObject9.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[8] == null ? false : true\r\n        this.dimAndValueObject9.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[8] == null ? null : this.crud.selections[0].indDimAndValueRelations[8].dimension\r\n        if (this.dimAndValueObject9.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject9.dimension, 9)\r\n        }\r\n        this.dimAndValueObject9.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[8] == null ? null : this.crud.selections[0].indDimAndValueRelations[8].dimensionValue\r\n        this.dimAndValueObject9.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[8] == null ? null : this.crud.selections[0].indDimAndValueRelations[8].dimensionName\r\n\r\n        this.dimAndValueObject10.isShow = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            false : this.crud.selections[0].indDimAndValueRelations[9] == null ? false : true\r\n        this.dimAndValueObject10.dimension = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[9] == null ? null : this.crud.selections[0].indDimAndValueRelations[9].dimension\r\n        if (this.dimAndValueObject10.isShow) {\r\n          this.initDimValuesChildren(this.dimAndValueObject10.dimension, 10)\r\n        }\r\n        this.dimAndValueObject10.dimensionValue = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[9] == null ? null : this.crud.selections[0].indDimAndValueRelations[9].dimensionValue\r\n        this.dimAndValueObject10.dimensionName = this.crud.selections[0].indDimAndValueRelations.length == 0 ?\r\n            null : this.crud.selections[0].indDimAndValueRelations[9] == null ? null : this.crud.selections[0].indDimAndValueRelations[9].dimensionName\r\n\r\n      }\r\n\r\n      this.form.businessDept = this.crud.selections[0].businessDept\r\n      this.form.indLevel = this.crud.selections[0].indLevel\r\n      this.form.isDeptQuery = this.crud.selections[0].isDeptQuery\r\n      this.form.isAdditionalRecording = this.crud.selections[0].isAdditionalRecording == null || this.crud.selections[0].isAdditionalRecording ? 'true' : 'false'\r\n      this.form.indDefinition = this.crud.selections[0].indDefinition\r\n      let defRule = this.crud.selections[0].indDefRule;\r\n      this.form.indDefRule = defRule;\r\n      /*if (defRule != null) {\r\n        let defRuleArr = defRule.split(\"||\");\r\n        if (Array.isArray(defRuleArr) && defRuleArr.length >= 2) {\r\n          this.form.indDefRule = defRuleArr[0]\r\n        } else {\r\n          this.form.indDefRule = defRule;\r\n        }\r\n      }*/\r\n      //this.form.indDefRuleStr = this.crud.selections[0].indDefRuleStr;\r\n      //this.indDefRuleStr = this.crud.selections[0].indDefRuleStr;\r\n      if (this.crud.selections[0].indDefRuleIds == null || this.crud.selections[0].indDefRuleIds == ''\r\n          || this.crud.selections[0].indDefRuleIds == [] || this.crud.selections[0].ieProp != 2) {\r\n        this.isSelfRule = true\r\n      } else {\r\n        this.indDefRuleIds = this.crud.selections[0].indDefRuleIds;\r\n        this.indDefRuleStrs = this.crud.selections[0].indDefRuleStrs;\r\n        this.isSelfRule = false\r\n      }\r\n      /*if(this.crud.selections[0].indDefRuleVal !=null && this.crud.selections[0].indDefRuleVal != \"\") {\r\n        this.form.indDefRuleVal = this.crud.selections[0].indDefRuleVal;\r\n        this.form.indDefRuleId = this.crud.selections[0].indDefRuleId;\r\n        this.indDefRuleVal = this.crud.selections[0].indDefRuleVal;\r\n        this.indDefRuleId = this.crud.selections[0].indDefRuleId;\r\n      } else {\r\n        if (defRule != null) {\r\n          let defRuleArr = defRule.split(\"||\");\r\n          if (Array.isArray(defRuleArr) && defRuleArr.length >= 2) {\r\n            this.form.indDefRuleVal = defRuleArr[1];\r\n            this.form.indDefRuleId = defRuleArr[2];\r\n            this.indDefRuleVal = defRuleArr[1];\r\n            this.indDefRuleId = defRuleArr[2];\r\n          }\r\n        }\r\n      }*/\r\n      this.form.indValueRange1 = this.crud.selections[0].indValueRange1\r\n      this.form.indValueRange2 = this.crud.selections[0].indValueRange2\r\n      this.form.indInnerWarnValue = this.crud.selections[0].indInnerWarnValue\r\n      this.form.indMonWarnValue = this.crud.selections[0].indMonWarnValue\r\n      this.form.indInnerWarnFlg = this.crud.selections[0].indInnerWarnFlg\r\n      this.form.indMonWarnFlg = this.crud.selections[0].indMonWarnFlg\r\n      if (this.form.indInnerWarnValue != null && this.form.indInnerWarnValue != ''\r\n          && (this.form.indInnerWarnFlg == null || this.form.indInnerWarnFlg == '')) {\r\n        this.errmsgInnerWarning = true\r\n      }\r\n      if (this.form.indMonWarnValue != null && this.form.indMonWarnValue != ''\r\n          && (this.form.indMonWarnFlg == null || this.form.indMonWarnFlg == '')) {\r\n        this.errmsgMonWarning = true\r\n      }\r\n\r\n      this.form.currency = this.crud.selections[0].currency == null ? null : Array.isArray(this.crud.selections[0].currency) ? this.crud.selections[0].currency : this.crud.selections[0].currency.split(',')\r\n      this.form.indValueType = this.crud.selections[0].indValueType\r\n      this.form.indFrequency = this.crud.selections[0].indFrequency == null ? null : Array.isArray(this.crud.selections[0].indFrequency) ? this.crud.selections[0].indFrequency : this.crud.selections[0].indFrequency.split(',')\r\n      this.form.indCalType = this.crud.selections[0].indCalType\r\n      this.form.indSafeLevel = this.crud.selections[0].indSafeLevel\r\n      this.form.indMonField = this.crud.selections[0].indMonField\r\n      this.form.indProcessSys = this.crud.selections[0].indProcessSys\r\n      this.form.indDataType = this.crud.selections[0].indDataType\r\n      this.form.indDataForm = this.crud.selections[0].indDataForm\r\n      this.form.indReference = this.crud.selections[0].indReference\r\n      this.form.isRealTimeProcess = this.crud.selections[0].isRealTimeProcess\r\n      this.form.indCurrentValue = this.crud.selections[0].indCurrentValue\r\n      this.form.indContemporaneousValue = this.crud.selections[0].indContemporaneousValue\r\n      this.form.indYearOnYearIncrement = this.crud.selections[0].indYearOnYearIncrement\r\n      this.form.indYearOnYearGrowth = this.crud.selections[0].indYearOnYearGrowth\r\n      this.form.indPreviousPeriodValue = this.crud.selections[0].indPreviousPeriodValue\r\n      this.form.indMonthOnMonthIncrement = this.crud.selections[0].indMonthOnMonthIncrement\r\n      this.form.indMonthOnMonthGrowth = this.crud.selections[0].indMonthOnMonthGrowth\r\n      this.form.indInitialValueOfTheYear = this.crud.selections[0].indInitialValueOfTheYear\r\n      this.form.indYearOnYearIncre = this.crud.selections[0].indYearOnYearIncre\r\n      this.form.indIncreaseOverTheBeginningOfTheYear = this.crud.selections[0].indIncreaseOverTheBeginningOfTheYear\r\n      this.form.indVerifyId = this.crud.selections[0].indVerifyId\r\n      if (this.form.tenant == null) {\r\n        this.form.tenant = this.crud.selections[0].tenant\r\n      }\r\n\r\n      this.errmsgIndFirstType = false\r\n      this.errmsgIndSecondType = false\r\n      this.isBizNameContract = true\r\n      this.errmsgIndLevel = false\r\n      this.errmsgCurrency = false\r\n      this.errmsgFrequency = false\r\n      this.errmsgIndCalType = false\r\n      this.errmsgIndMonField = false\r\n      this.errmsgIndDataType = false\r\n      this.errmsgIndDefinition = false\r\n      this.errmsgBizName = false\r\n      this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n      this.errmsgIndDefRule = false\r\n      this.indDefRuleErr = '指标口径规则不能为空';\r\n      this.errmsgIeProp = false;\r\n      // getAllSource().then(data => {\r\n      //   this.sourceData = [{ id: 'local', datasourceName: '默认数据源' }].concat(data.data)\r\n      // })\r\n      // getTablesById(this.form.targetDataSource).then(data => {\r\n      //   this.tableInfo = data.data\r\n      // })\r\n    },\r\n    [CRUD.HOOK.beforeToDetail](data) {\r\n      debugger\r\n      this.form.id = data.form.id\r\n      this.form.bizCode = data.form.bizCode\r\n      this.form.ieProp = data.form.ieProp\r\n      this.form.genBizName = data.form.genBizName\r\n      this.form.bizName = data.form.bizName\r\n      this.form.indFirstType = data.form.indFirstType\r\n      this.initIndSecondType(this.form.indFirstType, 'form')\r\n      this.form.indSecondType = data.form.indSecondType\r\n      this.form.categoryType = data.form.categoryType\r\n      if (data.form.ieProp == '3') {\r\n        this.dimAndValueObject1.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[0] == null ? false : true\r\n        this.dimAndValueObject1.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[0] == null ? null : data.form.indDimAndValueRelations[0].dimension\r\n        this.dimAndValueObject1.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[0] == null ? null : data.form.indDimAndValueRelations[0].dimensionValue\r\n        this.dimAndValueObject1.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[0] == null ? null : data.form.indDimAndValueRelations[0].dimensionName\r\n\r\n        this.dimAndValueObject2.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[1] == null ? false : true\r\n        this.dimAndValueObject2.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[1] == null ? null : data.form.indDimAndValueRelations[1].dimension\r\n        this.dimAndValueObject2.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[1] == null ? null : data.form.indDimAndValueRelations[1].dimensionValue\r\n        this.dimAndValueObject2.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[1] == null ? null : data.form.indDimAndValueRelations[1].dimensionName\r\n\r\n        this.dimAndValueObject3.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[2] == null ? false : true\r\n        this.dimAndValueObject3.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[2] == null ? null : data.form.indDimAndValueRelations[2].dimension\r\n        this.dimAndValueObject3.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[2] == null ? null : data.form.indDimAndValueRelations[2].dimensionValue\r\n        this.dimAndValueObject3.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[2] == null ? null : data.form.indDimAndValueRelations[2].dimensionName\r\n        this.dimAndValueObject3.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[2] == null ? null : data.form.indDimAndValueRelations[2].dimensionName\r\n\r\n        this.dimAndValueObject4.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[3] == null ? false : true\r\n        this.dimAndValueObject4.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[3] == null ? null : data.form.indDimAndValueRelations[3].dimension\r\n        this.dimAndValueObject4.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[3] == null ? null : data.form.indDimAndValueRelations[3].dimensionValue\r\n        this.dimAndValueObject4.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[3] == null ? null : data.form.indDimAndValueRelations[3].dimensionName\r\n\r\n        this.dimAndValueObject5.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[4] == null ? false : true\r\n        this.dimAndValueObject5.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[4] == null ? null : data.form.indDimAndValueRelations[4].dimension\r\n        this.dimAndValueObject5.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[4] == null ? null : data.form.indDimAndValueRelations[4].dimensionValue\r\n        this.dimAndValueObject5.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[4] == null ? null : data.form.indDimAndValueRelations[4].dimensionName\r\n\r\n        this.dimAndValueObject6.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[5] == null ? false : true\r\n        this.dimAndValueObject6.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[5] == null ? null : data.form.indDimAndValueRelations[5].dimension\r\n        this.dimAndValueObject6.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[5] == null ? null : data.form.indDimAndValueRelations[5].dimensionValue\r\n        this.dimAndValueObject6.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[5] == null ? null : data.form.indDimAndValueRelations[5].dimensionName\r\n\r\n        this.dimAndValueObject7.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[6] == null ? false : true\r\n        this.dimAndValueObject7.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[6] == null ? null : data.form.indDimAndValueRelations[6].dimension\r\n        this.dimAndValueObject7.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[6] == null ? null : data.form.indDimAndValueRelations[6].dimensionValue\r\n        this.dimAndValueObject7.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[6] == null ? null : data.form.indDimAndValueRelations[6].dimensionName\r\n\r\n        this.dimAndValueObject8.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[7] == null ? false : true\r\n        this.dimAndValueObject8.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[7] == null ? null : data.form.indDimAndValueRelations[7].dimension\r\n        this.dimAndValueObject8.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[7] == null ? null : data.form.indDimAndValueRelations[7].dimensionValue\r\n        this.dimAndValueObject8.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[7] == null ? null : data.form.indDimAndValueRelations[7].dimensionName\r\n\r\n        this.dimAndValueObject9.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[8] == null ? false : true\r\n        this.dimAndValueObject9.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[8] == null ? null : data.form.indDimAndValueRelations[8].dimension\r\n        this.dimAndValueObject9.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[8] == null ? null : data.form.indDimAndValueRelations[8].dimensionValue\r\n        this.dimAndValueObject9.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[8] == null ? null : data.form.indDimAndValueRelations[8].dimensionName\r\n\r\n        this.dimAndValueObject10.isShow = data.form.indDimAndValueRelations.length == 0 ?\r\n            false : data.form.indDimAndValueRelations[9] == null ? false : true\r\n        this.dimAndValueObject10.dimension = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[9] == null ? null : data.form.indDimAndValueRelations[9].dimension\r\n        this.dimAndValueObject10.dimensionValue = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[9] == null ? null : data.form.indDimAndValueRelations[9].dimensionValue\r\n        this.dimAndValueObject10.dimensionName = data.form.indDimAndValueRelations.length == 0 ?\r\n            null : data.form.indDimAndValueRelations[9] == null ? null : data.form.indDimAndValueRelations[9].dimensionName\r\n      }\r\n      this.form.businessDept = data.form.businessDept\r\n      this.form.indLevel = data.form.indLevel\r\n      this.form.isDeptQuery = data.form.isDeptQuery\r\n      this.form.isAdditionalRecording = data.form.isAdditionalRecording == null || data.form.isAdditionalRecording ? 'true' : 'false'\r\n      this.form.indDefinition = data.form.indDefinition\r\n      //this.form.indDefRule = data.form.indDefRule\r\n      this.form.indValueRange1 = data.form.indValueRange1\r\n      this.form.indValueRange2 = data.form.indValueRange2\r\n      this.form.indInnerWarnValue = data.form.indInnerWarnValue\r\n      this.form.indMonWarnValue = data.form.indMonWarnValue\r\n      this.form.currency = data.form.currency == null ? null : Array.isArray(data.form.currency) ? data.form.currency : data.form.currency.split(\",\")\r\n      this.form.indValueType = data.form.indValueType\r\n      this.form.indFrequency = data.form.indFrequency == null ? null : Array.isArray(data.form.indFrequency) ? data.form.indFrequency : data.form.indFrequency.split(\",\")\r\n      this.form.indCalType = data.form.indCalType\r\n      this.form.indSafeLevel = data.form.indSafeLevel\r\n      this.form.indMonField = data.form.indMonField\r\n      this.form.indProcessSys = data.form.indProcessSys\r\n      this.form.indDataType = data.form.indDataType\r\n      this.form.indDataForm = data.form.indDataForm\r\n      this.form.indReference = data.form.indReference\r\n      this.form.isRealTimeProcess = data.form.isRealTimeProcess\r\n      this.form.indCurrentValue = data.form.indCurrentValue\r\n      this.form.indContemporaneousValue = data.form.indContemporaneousValue\r\n      this.form.indYearOnYearIncrement = data.form.indYearOnYearIncrement\r\n      this.form.indYearOnYearGrowth = data.form.indYearOnYearGrowth\r\n      this.form.indPreviousPeriodValue = data.form.indPreviousPeriodValue\r\n      this.form.indMonthOnMonthIncrement = data.form.indMonthOnMonthIncrement\r\n      this.form.indMonthOnMonthGrowth = data.form.indMonthOnMonthGrowth\r\n      this.form.indInitialValueOfTheYear = data.form.indInitialValueOfTheYear\r\n      this.form.indYearOnYearIncre = data.form.indYearOnYearIncre\r\n      this.form.indIncreaseOverTheBeginningOfTheYear = data.form.indIncreaseOverTheBeginningOfTheYear\r\n      this.form.indVerifyStatus = data.form.indVerifyStatus\r\n      this.form.indDeployStatus = data.form.indDeployStatus\r\n      this.form.indVerifyId = data.form.indVerifyId\r\n      this.form.tenant = data.form.tenant\r\n\r\n      if (data.form.indDefRuleIds == null || data.form.indDefRuleIds == '' || data.form.indDefRuleIds == [] || data.form.ieProp != 2) {\r\n        this.isSelfRule = true\r\n      } else {\r\n        this.indDefRuleIds = data.form.indDefRuleIds;\r\n        this.indDefRuleStrs = data.form.indDefRuleStrs;\r\n        this.isSelfRule = false\r\n      }\r\n      /*let defRule = data.form.indDefRule;\r\n      if (defRule != null) {\r\n        let defRuleArr = defRule.split(\"||\");\r\n        if (Array.isArray(defRuleArr) && defRuleArr.length >= 2) {\r\n          this.form.indDefRule = defRuleArr[0]\r\n        } else {\r\n          this.form.indDefRule = defRule;\r\n        }\r\n      }\r\n      this.form.indDefRuleStr = data.form.indDefRuleStr;\r\n      this.indDefRuleStr = data.form.indDefRuleStr;\r\n      if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n        this.isSelfRule = true\r\n      } else {\r\n        this.isSelfRule = false\r\n      }\r\n      if(data.form.indDefRuleVal !=null && data.form.indDefRuleVal != \"\") {\r\n        this.form.indDefRuleVal = data.form.indDefRuleVal;\r\n        this.form.indDefRuleId = data.form.indDefRuleId;\r\n        this.indDefRuleVal = data.form.indDefRuleVal;\r\n        this.indDefRuleId = data.form.indDefRuleId;\r\n      } else {\r\n        if (defRule != null) {\r\n          let defRuleArr = defRule.split(\"||\");\r\n          if (Array.isArray(defRuleArr) && defRuleArr.length >= 2) {\r\n            this.form.indDefRuleVal = defRuleArr[1];\r\n            this.form.indDefRuleId = defRuleArr[2];\r\n            this.indDefRuleVal = defRuleArr[1];\r\n            this.indDefRuleId = defRuleArr[2];\r\n          }\r\n        }\r\n      }*/\r\n      this.errmsgIndFirstType = false\r\n      this.errmsgIndSecondType = false\r\n      this.isBizNameContract = true\r\n      this.errmsgIndLevel = false\r\n      this.errmsgCurrency = false\r\n      this.errmsgFrequency = false\r\n      this.errmsgIndCalType = false\r\n      this.errmsgIndMonField = false\r\n      this.errmsgIndDataType = false\r\n      this.errmsgIndDefinition = false\r\n      this.errmsgBizName = false\r\n      this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n      this.errmsgIndDefRule = false\r\n      this.indDefRuleErr = '指标口径规则不能为空';\r\n      this.errmsgIeProp = false;\r\n    },\r\n    [CRUD.HOOK.beforeSubmit]() {\r\n      // if (this.form.atomDimensions == null) {\r\n      //   this.crud.notify('请进行维度管理', CRUD.NOTIFICATION_TYPE.ERROR)\r\n      //   return false\r\n      // }\r\n      if (!this.isBizNameContract) {\r\n        this.$message.error(\"指标名称重复,请重新输入\");\r\n        return false;\r\n      }\r\n      //对新增状态进行参数设置\r\n      this.form.indDimAndValueRelations = [];\r\n      if (this.crud.status.add == CRUD.STATUS.PREPARED) {\r\n        //验证指标类型\r\n        if (this.form.ieProp == null || this.form.ieProp == '') {\r\n          this.errmsgIeProp = true;\r\n        } else {\r\n          this.errmsgIeProp = false;\r\n        }\r\n        //验证第一分类\r\n        if (this.form.indFirstType == null || this.form.indFirstType == '') {\r\n          this.errmsgIndFirstType = true;\r\n        } else {\r\n          this.errmsgIndFirstType = false;\r\n        }\r\n        //验证第一分类\r\n        if (this.form.indSecondType == null || this.form.indSecondType == '') {\r\n          this.errmsgIndSecondType = true;\r\n        } else {\r\n          this.errmsgIndSecondType = false;\r\n        }\r\n        //验证指标层级\r\n        if (this.form.indLevel == null || this.form.indLevel == '') {\r\n          this.errmsgIndLevel = true;\r\n        } else {\r\n          this.errmsgIndLevel = false;\r\n        }\r\n        //验证币种\r\n        if (this.form.currency == null || this.form.currency == '' || this.form.currency == []) {\r\n          this.errmsgCurrency = true;\r\n        } else {\r\n          this.errmsgCurrency = false;\r\n        }\r\n        //验证频率\r\n        if (this.form.indFrequency == null || this.form.indFrequency == '' || this.form.indFrequency == []) {\r\n          this.errmsgFrequency = true;\r\n        } else {\r\n          this.errmsgFrequency = false;\r\n        }\r\n        //验证度量单位\r\n        if (this.form.indCalType == null || this.form.indCalType == '') {\r\n          this.errmsgIndCalType = true;\r\n        } else {\r\n          this.errmsgIndCalType = false;\r\n        }\r\n        //验证监管属性\r\n        if (this.form.indMonField == null || this.form.indMonField == '') {\r\n          this.errmsgIndMonField = true;\r\n        } else {\r\n          this.errmsgIndMonField = false;\r\n        }\r\n        //验证数据类型\r\n        if (this.form.indDataType == null || this.form.indDataType == '') {\r\n          this.errmsgIndDataType = true;\r\n        } else {\r\n          this.errmsgIndDataType = false;\r\n        }\r\n        //this.errmsgBizName\r\n        //验证指标名称\r\n        if (this.form.bizName == null || this.form.bizName == '') {\r\n          this.errmsgBizName = true;\r\n        } else {\r\n          this.errmsgBizName = false;\r\n        }\r\n        //验证指标定义\r\n        if (this.form.indDefinition == null || this.form.indDefinition == '') {\r\n          this.errmsgIndDefinition = true;\r\n          this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n        } else {\r\n          if (this.form.indDefinition.length > 500) {\r\n            this.errmsgIndDefinition = true;\r\n            this.errmsgIndDefinitionStr = '指标定义不能超过500字';\r\n          } else {\r\n            this.errmsgIndDefinition = false;\r\n            this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n          }\r\n\r\n        }\r\n        if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = true\r\n        } else {\r\n          this.errmsgIndDefRule = false\r\n        }\r\n        if (this.errmsgIndDataType || this.errmsgIndMonField || this.errmsgIndCalType || this.errmsgFrequency\r\n            || this.errmsgCurrency || this.errmsgIndLevel || this.errmsgIndSecondType || this.errmsgIndFirstType || this.errmsgIeProp || this.errmsgBizName || this.errmsgIndDefinition || this.errmsgIndDefRule) {\r\n          return false;\r\n        }\r\n        this.form.indFrequency = this.form.indFrequency == null ? null : Array.isArray(this.form.indFrequency) ? this.form.indFrequency.join(\",\") : this.form.indFrequency\r\n        this.form.currency = this.form.currency == null ? null : Array.isArray(this.form.currency) ? this.form.currency.join(\",\") : this.form.currency\r\n        if (this.form.ieProp == 3) {\r\n          if (this.dimAndValueObject1.isShow) {\r\n            this.errmsgDim1 = this.dimAndValueObject1.dimension == null || this.dimAndValueObject1.dimension == '';\r\n            this.errmsgDimV1 = this.dimAndValueObject1.dimensionValue == null || this.dimAndValueObject1.dimensionValue == '';\r\n            if (this.errmsgDim1 || this.errmsgDimV1) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject1)\r\n          }\r\n          if (this.dimAndValueObject2.isShow) {\r\n            this.errmsgDimV2 = this.dimAndValueObject2.dimension != null && this.dimAndValueObject2.dimension != ''\r\n                && (this.dimAndValueObject2.dimensionValue == null || this.dimAndValueObject2.dimensionValue == '');\r\n            if (this.errmsgDim2 || this.errmsgDimV2) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject2)\r\n          }\r\n          if (this.dimAndValueObject3.isShow) {\r\n            this.errmsgDimV3 = this.dimAndValueObject3.dimension != null && this.dimAndValueObject3.dimension != ''\r\n                && (this.dimAndValueObject3.dimensionValue == null || this.dimAndValueObject3.dimensionValue == '');\r\n            if (this.errmsgDim3 || this.errmsgDimV3) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject3)\r\n          }\r\n          if (this.dimAndValueObject4.isShow) {\r\n            this.errmsgDimV4 = this.dimAndValueObject4.dimension != null && this.dimAndValueObject4.dimension != ''\r\n                && (this.dimAndValueObject4.dimensionValue == null || this.dimAndValueObject4.dimensionValue == '');\r\n            if (this.errmsgDim4 || this.errmsgDimV4) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject4)\r\n          }\r\n          if (this.dimAndValueObject5.isShow) {\r\n            this.errmsgDimV5 = this.dimAndValueObject5.dimension != null && this.dimAndValueObject5.dimension != ''\r\n                && (this.dimAndValueObject5.dimensionValue == null || this.dimAndValueObject5.dimensionValue == '');\r\n            if (this.errmsgDim5 || this.errmsgDimV5) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject5)\r\n          }\r\n          if (this.dimAndValueObject6.isShow) {\r\n            this.errmsgDimV6 = this.dimAndValueObject6.dimension != null && this.dimAndValueObject6.dimension != ''\r\n                && (this.dimAndValueObject6.dimensionValue == null || this.dimAndValueObject6.dimensionValue == '');\r\n            if (this.errmsgDim6 || this.errmsgDimV6) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject6)\r\n          }\r\n          if (this.dimAndValueObject7.isShow) {\r\n            this.errmsgDimV7 = this.dimAndValueObject7.dimension != null && this.dimAndValueObject7.dimension != ''\r\n                && (this.dimAndValueObject7.dimensionValue == null || this.dimAndValueObject7.dimensionValue == '');\r\n            if (this.errmsgDim7 || this.errmsgDimV7) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject7)\r\n          }\r\n          if (this.dimAndValueObject8.isShow) {\r\n            this.errmsgDimV8 = this.dimAndValueObject8.dimension != null && this.dimAndValueObject8.dimension != ''\r\n                && (this.dimAndValueObject8.dimensionValue == null || this.dimAndValueObject8.dimensionValue == '');\r\n            if (this.errmsgDim8 || this.errmsgDimV8) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject8)\r\n          }\r\n          if (this.dimAndValueObject9.isShow) {\r\n            this.errmsgDimV9 = this.dimAndValueObject9.dimension != null && this.dimAndValueObject9.dimension != ''\r\n                && (this.dimAndValueObject9.dimensionValue == null || this.dimAndValueObject9.dimensionValue == '');\r\n            if (this.errmsgDim9 || this.errmsgDimV9) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject9)\r\n          }\r\n          if (this.dimAndValueObject10.isShow) {\r\n            this.errmsgDimV10 = this.dimAndValueObject10.dimension != null && this.dimAndValueObject10.dimension != ''\r\n                && (this.dimAndValueObject10.dimensionValue == null || this.dimAndValueObject10.dimensionValue == '');\r\n            if (this.errmsgDim10 || this.errmsgDimV10) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject10)\r\n          }\r\n        } else {\r\n          this.form.genBizName = null;\r\n        }\r\n        if (this.form.indInnerWarnValue != null && this.form.indInnerWarnValue != ''\r\n            && (this.form.indInnerWarnFlg == null || this.form.indInnerWarnFlg == '')) {\r\n          this.errmsgInnerWarning = true\r\n        }\r\n        if (this.form.indMonWarnValue != null && this.form.indMonWarnValue != ''\r\n            && (this.form.indMonWarnFlg == null || this.form.indMonWarnFlg == '')) {\r\n          this.errmsgMonWarning = true\r\n        }\r\n        if (this.errmsgInnerWarning || this.errmsgMonWarning) {\r\n          return false;\r\n        }\r\n        /*if(this.form.ieProp == 2) {\r\n          if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n            if(this.form.indDefRule == null || this.form.indDefRule == '') {\r\n              this.indDefRuleErr ='指标口径规则不能为空'\r\n              this.errmsgIndDefRule = true\r\n              return false\r\n            } else if(this.form.indDefRule.length > 500) {\r\n              this.indDefRuleErr ='长度不能超过500字符'\r\n              this.errmsgIndDefRule = true\r\n              return false;\r\n            } else {\r\n              this.indDefRuleErr ='指标口径规则不能为空'\r\n              this.errmsgIndDefRule = false\r\n            }\r\n          } else {\r\n            if(this.endsWithStr(this.indDefRuleStr)) {\r\n              this.indDefRuleErr ='口径规则表达式错误'\r\n              this.errmsgIndDefRule = true\r\n              return false\r\n            } else {\r\n              this.indDefRuleErr ='指标口径规则不能为空'\r\n              this.errmsgIndDefRule = false\r\n            }\r\n          }\r\n          //this.form.indDefRule = (this.form.indDefRule + \"||\" + this.indDefRuleVal + \"||\" + this.indDefRuleId)\r\n          this.form.indDefRuleVal = this.indDefRuleVal;\r\n          this.form.indDefRuleStr = this.indDefRuleStr;\r\n          this.form.indDefRuleId = this.indDefRuleId;\r\n\r\n        } else {\r\n          this.indDefRuleErr ='指标口径规则不能为空'\r\n          this.errmsgIndDefRule = false\r\n        }*/\r\n        if (this.isSelfRule) {\r\n          this.form.indDefRuleIds = []\r\n          this.form.indDefRuleStrs = []\r\n          this.indDefRuleIds = []\r\n          this.indDefRuleStrs = []\r\n          this.form.indDefRuleId = ''\r\n          this.form.indDefRuleVal = ''\r\n          this.form.indDefRuleStr = ''\r\n          this.indDefRuleStr = ''\r\n          this.indDefRuleVal = ''\r\n          this.indDefRuleId = ''\r\n          if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          } else if (this.form.indDefRule.length > 500) {\r\n            this.indDefRuleErr = '长度不能超过500字符'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          } else {\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = false\r\n            return true;\r\n          }\r\n        } else {\r\n          if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          } else if (this.form.indDefRule.length > 500) {\r\n            this.indDefRuleErr = '长度不能超过500字符'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n          this.form.indDefRuleStrs = this.indDefRuleStrs;\r\n          this.form.indDefRuleIds = this.indDefRuleIds;\r\n        }\r\n        console.log('这里是新增参数编辑')\r\n      } else if (this.crud.status.edit == CRUD.STATUS.PREPARED) {\r\n\r\n        //维度和维度值\r\n        //this.form.indDimAndValueRelations = [];\r\n        //验证指标类型\r\n        if (this.form.ieProp == null || this.form.ieProp == '') {\r\n          this.errmsgIeProp = true;\r\n        } else {\r\n          this.errmsgIeProp = false;\r\n        }\r\n        //验证第一分类\r\n        if (this.form.indFirstType == null || this.form.indFirstType == '') {\r\n          this.errmsgIndFirstType = true;\r\n        } else {\r\n          this.errmsgIndFirstType = false;\r\n        }\r\n        //验证第一分类\r\n        if (this.form.indSecondType == null || this.form.indSecondType == '') {\r\n          this.errmsgIndSecondType = true;\r\n        } else {\r\n          this.errmsgIndSecondType = false;\r\n        }\r\n        //验证指标层级\r\n        if (this.form.indLevel == null || this.form.indLevel == '') {\r\n          this.errmsgIndLevel = true;\r\n        } else {\r\n          this.errmsgIndLevel = false;\r\n        }\r\n        //验证币种\r\n        if (this.form.currency == null || this.form.currency == '' || this.form.currency == []) {\r\n          this.errmsgCurrency = true;\r\n        } else {\r\n          this.errmsgCurrency = false;\r\n        }\r\n        //验证频率\r\n        if (this.form.indFrequency == null || this.form.indFrequency == '' || this.form.indFrequency == []) {\r\n          this.errmsgFrequency = true;\r\n        } else {\r\n          this.errmsgFrequency = false;\r\n        }\r\n        //验证度量单位\r\n        if (this.form.indCalType == null || this.form.indCalType == '') {\r\n          this.errmsgIndCalType = true;\r\n        } else {\r\n          this.errmsgIndCalType = false;\r\n        }\r\n        //验证监管属性\r\n        if (this.form.indMonField == null || this.form.indMonField == '') {\r\n          this.errmsgIndMonField = true;\r\n        } else {\r\n          this.errmsgIndMonField = false;\r\n        }\r\n        //验证数据类型\r\n        if (this.form.indDataType == null || this.form.indDataType == '') {\r\n          this.errmsgIndDataType = true;\r\n        } else {\r\n          this.errmsgIndDataType = false;\r\n        }\r\n        //this.errmsgBizName\r\n        //验证指标名称\r\n        if (this.form.bizName == null || this.form.bizName == '') {\r\n          this.errmsgBizName = true;\r\n        } else {\r\n          this.errmsgBizName = false;\r\n        }\r\n        //验证指标定义\r\n        if (this.form.indDefinition == null || this.form.indDefinition == '') {\r\n          this.errmsgIndDefinition = true;\r\n          this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n        } else {\r\n          if (this.form.indDefinition.length > 500) {\r\n            this.errmsgIndDefinition = true;\r\n            this.errmsgIndDefinitionStr = '指标定义不能超过500字';\r\n          } else {\r\n            this.errmsgIndDefinition = false;\r\n            this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n          }\r\n\r\n        }\r\n        if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.indDefRuleErr = '指标口径规则不能为空'\r\n          this.errmsgIndDefRule = true\r\n        } else {\r\n          this.errmsgIndDefRule = false\r\n        }\r\n        if (this.errmsgIndDataType || this.errmsgIndMonField || this.errmsgIndCalType || this.errmsgFrequency\r\n            || this.errmsgCurrency || this.errmsgIndLevel || this.errmsgIndSecondType || this.errmsgIndFirstType || this.errmsgIeProp || this.errmsgBizName || this.errmsgIndDefinition || this.errmsgIndDefRule) {\r\n          return false;\r\n        }\r\n\r\n        this.form.indFrequency = this.form.indFrequency == null ? null : Array.isArray(this.form.indFrequency) ? this.form.indFrequency.join(\",\") : this.form.indFrequency\r\n        this.form.currency = this.form.currency == null ? null : Array.isArray(this.form.currency) ? this.form.currency.join(\",\") : this.form.currency\r\n\r\n        if (this.form.ieProp == 3) {\r\n          if (this.dimAndValueObject1.isShow) {\r\n            this.errmsgDim1 = this.dimAndValueObject1.dimension == null || this.dimAndValueObject1.dimension == '';\r\n            this.errmsgDimV1 = this.dimAndValueObject1.dimensionValue == null || this.dimAndValueObject1.dimensionValue == '';\r\n            if (this.errmsgDim1 || this.errmsgDimV1) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject1)\r\n          }\r\n          if (this.dimAndValueObject2.isShow) {\r\n            this.errmsgDimV2 = this.dimAndValueObject2.dimension != null && this.dimAndValueObject2.dimension != ''\r\n                && (this.dimAndValueObject2.dimensionValue == null || this.dimAndValueObject2.dimensionValue == '');\r\n            if (this.errmsgDim2 || this.errmsgDimV2) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject2)\r\n          }\r\n          if (this.dimAndValueObject3.isShow) {\r\n            this.errmsgDimV3 = this.dimAndValueObject3.dimension != null && this.dimAndValueObject3.dimension != ''\r\n                && (this.dimAndValueObject3.dimensionValue == null || this.dimAndValueObject3.dimensionValue == '');\r\n            if (this.errmsgDim3 || this.errmsgDimV3) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject3)\r\n          }\r\n          if (this.dimAndValueObject4.isShow) {\r\n            this.errmsgDimV4 = this.dimAndValueObject4.dimension != null && this.dimAndValueObject4.dimension != ''\r\n                && (this.dimAndValueObject4.dimensionValue == null || this.dimAndValueObject4.dimensionValue == '');\r\n            if (this.errmsgDim4 || this.errmsgDimV4) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject4)\r\n          }\r\n          if (this.dimAndValueObject5.isShow) {\r\n            this.errmsgDimV5 = this.dimAndValueObject5.dimension != null && this.dimAndValueObject5.dimension != ''\r\n                && (this.dimAndValueObject5.dimensionValue == null || this.dimAndValueObject5.dimensionValue == '');\r\n            if (this.errmsgDim5 || this.errmsgDimV5) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject5)\r\n          }\r\n          if (this.dimAndValueObject6.isShow) {\r\n            this.errmsgDimV6 = this.dimAndValueObject6.dimension != null && this.dimAndValueObject6.dimension != ''\r\n                && (this.dimAndValueObject6.dimensionValue == null || this.dimAndValueObject6.dimensionValue == '');\r\n            if (this.errmsgDim6 || this.errmsgDimV6) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject6)\r\n          }\r\n          if (this.dimAndValueObject7.isShow) {\r\n            this.errmsgDimV7 = this.dimAndValueObject7.dimension != null && this.dimAndValueObject7.dimension != ''\r\n                && (this.dimAndValueObject7.dimensionValue == null || this.dimAndValueObject7.dimensionValue == '');\r\n            if (this.errmsgDim7 || this.errmsgDimV7) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject7)\r\n          }\r\n          if (this.dimAndValueObject8.isShow) {\r\n            this.errmsgDimV8 = this.dimAndValueObject8.dimension != null && this.dimAndValueObject8.dimension != ''\r\n                && (this.dimAndValueObject8.dimensionValue == null || this.dimAndValueObject8.dimensionValue == '');\r\n            if (this.errmsgDim8 || this.errmsgDimV8) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject8)\r\n          }\r\n          if (this.dimAndValueObject9.isShow) {\r\n            this.errmsgDimV9 = this.dimAndValueObject9.dimension != null && this.dimAndValueObject9.dimension != ''\r\n                && (this.dimAndValueObject9.dimensionValue == null || this.dimAndValueObject9.dimensionValue == '');\r\n            if (this.errmsgDim9 || this.errmsgDimV9) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject9)\r\n          }\r\n          if (this.dimAndValueObject10.isShow) {\r\n            this.errmsgDimV10 = this.dimAndValueObject10.dimension != null && this.dimAndValueObject10.dimension != ''\r\n                && (this.dimAndValueObject10.dimensionValue == null || this.dimAndValueObject10.dimensionValue == '');\r\n            if (this.errmsgDim10 || this.errmsgDimV10) {\r\n              return false;\r\n            }\r\n            this.form.indDimAndValueRelations.push(this.dimAndValueObject10)\r\n          }\r\n        } else {\r\n          this.form.genBizName = null;\r\n        }\r\n        if (this.form.indInnerWarnValue != null && this.form.indInnerWarnValue != ''\r\n            && (this.form.indInnerWarnFlg == null || this.form.indInnerWarnFlg == '')) {\r\n          this.errmsgInnerWarning = true\r\n        }\r\n        if (this.form.indMonWarnValue != null && this.form.indMonWarnValue != ''\r\n            && (this.form.indMonWarnFlg == null || this.form.indMonWarnFlg == '')) {\r\n          this.errmsgMonWarning = true\r\n        }\r\n        if (this.errmsgInnerWarning || this.errmsgMonWarning) {\r\n          return false;\r\n        }\r\n        /*if(this.form.ieProp == 2) {\r\n          if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n            if(this.form.indDefRule == null || this.form.indDefRule == '') {\r\n              this.indDefRuleErr ='指标口径规则不能为空'\r\n              this.errmsgIndDefRule = true\r\n              return false\r\n            } else {\r\n              this.indDefRuleErr ='指标口径规则不能为空'\r\n              this.errmsgIndDefRule = false\r\n            }\r\n          } else {\r\n            if(this.endsWithStr(this.indDefRuleStr)) {\r\n              this.indDefRuleErr ='口径规则表达式错误'\r\n              this.errmsgIndDefRule = true\r\n              return false\r\n            } else {\r\n              this.indDefRuleErr ='指标口径规则不能为空'\r\n              this.errmsgIndDefRule = false\r\n            }\r\n          }\r\n          this.form.indDefRule = (this.form.indDefRule + \"||\" + this.indDefRuleVal + \"||\" + this.indDefRuleId)\r\n          this.form.indDefRuleVal = this.indDefRuleVal;\r\n          this.form.indDefRuleStr = this.indDefRuleStr;\r\n          this.form.indDefRuleId = this.indDefRuleId;\r\n        } else {\r\n          if(this.form.indDefRule == null || this.form.indDefRule == '') {\r\n            this.indDefRuleErr ='指标口径规则不能为空'\r\n            this.errmsgIndDefRule = true\r\n            return false\r\n          } else {\r\n            this.indDefRuleErr ='指标口径规则不能为空'\r\n            this.errmsgIndDefRule = false\r\n          }\r\n        }*/\r\n\r\n        if (this.isSelfRule) {\r\n          if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          } else if (this.form.indDefRule.length > 500) {\r\n            this.indDefRuleErr = '长度不能超过500字符'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          } else {\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = false\r\n            return true;\r\n          }\r\n        } else {\r\n          if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          } else if (this.form.indDefRule.length > 500) {\r\n            this.indDefRuleErr = '长度不能超过500字符'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n        }\r\n        this.form.indDefRuleStrs = this.indDefRuleStrs;\r\n        this.form.indDefRuleIds = this.indDefRuleIds;\r\n      }\r\n    },\r\n    [CRUD.HOOK.beforeToAdd]() {\r\n      if (!this.form.categoryId) {\r\n        this.crud.notify('请选择分类', CRUD.NOTIFICATION_TYPE.ERROR)\r\n        return false\r\n      }\r\n      if (this.form.categoryId == '0') {\r\n        this.crud.notify('根节点不能添加', CRUD.NOTIFICATION_TYPE.ERROR)\r\n        return false\r\n      }\r\n      this.form.formType = 'add';\r\n      this.form.serialNo = this.generatorUUID();\r\n      this.form.categoryType = this.type\r\n      this.form.indDimAndValueRelations = []\r\n      this.indDefRuleStr = ''\r\n      this.indDefRuleVal = ''\r\n      this.indDefRuleId = ''\r\n      this.indDefRuleStrs = [];\r\n      this.indDefRuleIds = [];\r\n      this.form.indDefRuleStr = '';\r\n      this.form.indDefRuleVal = '';\r\n      this.form.indDefRuleId = '';\r\n      this.form.indDefRule = '';\r\n      this.form.isAdditionalRecording = 'true';\r\n      this.getCurrentDept()\r\n\r\n      this.cleanDimAndVal();\r\n      this.errmsgIndFirstType = false\r\n      this.errmsgIndSecondType = false\r\n      this.isBizNameContract = true\r\n      this.errmsgIndLevel = false\r\n      this.errmsgCurrency = false\r\n      this.errmsgFrequency = false\r\n      this.errmsgIndCalType = false\r\n      this.errmsgIndMonField = false\r\n      this.errmsgIndDataType = false\r\n      this.errmsgIndDefinition = false\r\n      this.errmsgBizName = false\r\n      this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n      this.errmsgIndDefRule = false\r\n      this.indDefRuleErr = '指标口径规则不能为空';\r\n      this.errmsgIeProp = false;\r\n    },\r\n    cleanDimAndVal() {\r\n      this.dimAndValueObject1 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject2 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject3 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject4 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject5 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject6 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject7 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject8 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject9 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n      this.dimAndValueObject10 = {\r\n        isShow: false,\r\n        dimension: null,\r\n        dimensionValue: null,\r\n        dimensionName: null\r\n      }\r\n    },\r\n    // 历史版本\r\n    toSelectHistory(data) {\r\n      this.showIndHistory = true\r\n      //this.hisIeId = data.id;\r\n      //this.historyData.push(data)\r\n      getHisList(data.id).then(res => {\r\n        if (res.code == 0) {\r\n          this.historyData = res.data.records\r\n          console.log(this.historyData)\r\n\r\n        }\r\n      })\r\n    },\r\n    toSelectFlow(data) {\r\n      this.showFlow = true\r\n      /*approveDetailByBusinessKey(qs.stringify({businessKey:data.id})).then(res => {\r\n        //审批流程\r\n        this.flowData = res.data\r\n      })*/\r\n      approveDetailByOriginalInstId(qs.stringify({originalInstId: data.indVerifyId})).then(res => {\r\n        //审批流程\r\n        this.flowData = res.data\r\n      })\r\n    },\r\n    toResult(data) {\r\n      this.$router.push({path: 'result/index', query: {ieName: data.bizName}});\r\n    },\r\n    // 历史详情\r\n    toSelectHistoryDetail(data) {\r\n      const _thisAtom = this.$refs.atomPage\r\n      _thisAtom.form = data\r\n      _thisAtom.title = data.bizName + '[' + data.bizCode + ']历史详情'\r\n      const param = {\r\n        bizCode: data.bizCode,\r\n        keepHistory: data.keepHistory\r\n      }\r\n      getDimensions(param).then(data => {\r\n        _thisAtom.atomDimensions = data.data\r\n      })\r\n      getDimInfo().then(data => {\r\n        _thisAtom.dimensions = data.data\r\n      })\r\n      // 获取数据源\r\n      getAllSource().then(data => {\r\n        _thisAtom.sourceData = [{id: 'local', datasourceName: '默认数据源'}].concat(data.data)\r\n      })\r\n      _thisAtom.form.currency = data.currency == null ? null : Array.isArray(data.currency) ? data.currency : data.currency.split(\",\")\r\n      _thisAtom.form.indValueType = data.indValueType\r\n      _thisAtom.form.indFrequency = data.indFrequency == null ? null : Array.isArray(data.indFrequency) ? data.indFrequency : data.indFrequency.split(\",\")\r\n      if (data.ieProp == '3') {\r\n        _thisAtom.dimAndValueObject1.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[0] == null ? false : true\r\n        _thisAtom.dimAndValueObject1.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[0] == null ? null : data.indDimAndValueRelations[0].dimension\r\n        _thisAtom.dimAndValueObject1.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[0] == null ? null : data.indDimAndValueRelations[0].dimensionValue\r\n        _thisAtom.dimAndValueObject1.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[0] == null ? null : data.indDimAndValueRelations[0].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject2.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[1] == null ? false : true\r\n        _thisAtom.dimAndValueObject2.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[1] == null ? null : data.indDimAndValueRelations[1].dimension\r\n        _thisAtom.dimAndValueObject2.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[1] == null ? null : data.indDimAndValueRelations[1].dimensionValue\r\n        _thisAtom.dimAndValueObject2.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[1] == null ? null : data.indDimAndValueRelations[1].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject3.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[2] == null ? false : true\r\n        _thisAtom.dimAndValueObject3.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[2] == null ? null : data.indDimAndValueRelations[2].dimension\r\n        _thisAtom.dimAndValueObject3.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[2] == null ? null : data.indDimAndValueRelations[2].dimensionValue\r\n        _thisAtom.dimAndValueObject3.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[2] == null ? null : data.indDimAndValueRelations[2].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject4.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[3] == null ? false : true\r\n        _thisAtom.dimAndValueObject4.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[3] == null ? null : data.indDimAndValueRelations[3].dimension\r\n        _thisAtom.dimAndValueObject4.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[3] == null ? null : data.indDimAndValueRelations[3].dimensionValue\r\n        _thisAtom.dimAndValueObject4.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[3] == null ? null : data.indDimAndValueRelations[3].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject5.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[4] == null ? false : true\r\n        _thisAtom.dimAndValueObject5.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[4] == null ? null : data.indDimAndValueRelations[4].dimension\r\n        _thisAtom.dimAndValueObject5.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[4] == null ? null : data.indDimAndValueRelations[4].dimensionValue\r\n        _thisAtom.dimAndValueObject5.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[4] == null ? null : data.indDimAndValueRelations[4].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject6.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[5] == null ? false : true\r\n        _thisAtom.dimAndValueObject6.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[5] == null ? null : data.indDimAndValueRelations[5].dimension\r\n        _thisAtom.dimAndValueObject6.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[5] == null ? null : data.indDimAndValueRelations[5].dimensionValue\r\n        _thisAtom.dimAndValueObject6.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[5] == null ? null : data.indDimAndValueRelations[5].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject7.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[6] == null ? false : true\r\n        _thisAtom.dimAndValueObject7.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[6] == null ? null : data.indDimAndValueRelations[6].dimension\r\n        _thisAtom.dimAndValueObject7.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[6] == null ? null : data.indDimAndValueRelations[6].dimensionValue\r\n        _thisAtom.dimAndValueObject7.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[6] == null ? null : data.indDimAndValueRelations[6].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject8.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[7] == null ? false : true\r\n        _thisAtom.dimAndValueObject8.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[7] == null ? null : data.indDimAndValueRelations[7].dimension\r\n        _thisAtom.dimAndValueObject8.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[7] == null ? null : data.indDimAndValueRelations[7].dimensionValue\r\n        _thisAtom.dimAndValueObject8.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[7] == null ? null : data.indDimAndValueRelations[7].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject9.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[8] == null ? false : true\r\n        _thisAtom.dimAndValueObject9.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[8] == null ? null : data.indDimAndValueRelations[8].dimension\r\n        _thisAtom.dimAndValueObject9.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[8] == null ? null : data.indDimAndValueRelations[8].dimensionValue\r\n        _thisAtom.dimAndValueObject9.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[8] == null ? null : data.indDimAndValueRelations[8].dimensionName\r\n\r\n        _thisAtom.dimAndValueObject10.isShow = data.indDimAndValueRelations.length == 0 ?\r\n            false : data.indDimAndValueRelations[9] == null ? false : true\r\n        _thisAtom.dimAndValueObject10.dimension = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[9] == null ? null : data.indDimAndValueRelations[9].dimension\r\n        _thisAtom.dimAndValueObject10.dimensionValue = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[9] == null ? null : data.indDimAndValueRelations[9].dimensionValue\r\n        _thisAtom.dimAndValueObject10.dimensionName = data.indDimAndValueRelations.length == 0 ?\r\n            null : data.indDimAndValueRelations[9] == null ? null : data.indDimAndValueRelations[9].dimensionName\r\n      }\r\n      let defRule = data.indDefRule;\r\n      if (defRule != null) {\r\n        let defRuleArr = defRule.split(\"||\");\r\n        if (Array.isArray(defRuleArr) && defRuleArr.length >= 2) {\r\n          _thisAtom.form.indDefRule = defRuleArr[0]\r\n        } else {\r\n          _thisAtom.form.indDefRule = defRule;\r\n        }\r\n      }\r\n      _thisAtom.form.indDefRuleStr = data.indDefRuleStr;\r\n      _thisAtom.indDefRuleStr = data.indDefRuleStr;\r\n      if (_thisAtom.indDefRuleStr == null || _thisAtom.indDefRuleStr == '') {\r\n        this.isSelfRule = true\r\n      } else {\r\n        this.isSelfRule = false\r\n      }\r\n      if (data.indDefRuleVal != null && data.indDefRuleVal != \"\") {\r\n        _thisAtom.form.indDefRuleVal = data.indDefRuleVal;\r\n        _thisAtom.form.indDefRuleId = data.indDefRuleId;\r\n        _thisAtom.indDefRuleVal = data.indDefRuleVal;\r\n        _thisAtom.indDefRuleId = data.indDefRuleId;\r\n      } else {\r\n        if (defRule != null) {\r\n          let defRuleArr = defRule.split(\"||\");\r\n          if (Array.isArray(defRuleArr) && defRuleArr.length >= 2) {\r\n            _thisAtom.form.indDefRuleVal = defRuleArr[1];\r\n            _thisAtom.form.indDefRuleId = defRuleArr[2];\r\n            _thisAtom.indDefRuleVal = defRuleArr[1];\r\n            _thisAtom.indDefRuleId = defRuleArr[2];\r\n          }\r\n        }\r\n      }\r\n      /* _this.bizCode = data.bizCode*/\r\n      _thisAtom.atomPageDialog = true\r\n    },\r\n    bizTabCodeChange() {\r\n      this.bizTabCodeDis = this.form.bizTabCode == null;\r\n    },\r\n    atomDimensionHandle() {\r\n\r\n      if (this.form.bizCalcSql != null) {\r\n\r\n        const _this = this.$refs.dimensionPage\r\n        _this.keepHistory = this.form.keepHistory\r\n        if (this.form.bizTabCode == null) {\r\n          this.bizTabCodeDis = true\r\n        }\r\n        /* const paramSql = {\r\n          bizCalcSql: this.form.bizCalcSql\r\n        }\r\n        bizCalcSqlVali(paramSql).then(data => {\r\n          if (data.code == 0) {\r\n\r\n          } else {\r\n            this.$message(data.msg)\r\n          }\r\n        })*/\r\n        const param = {\r\n          bizCalcSql: this.form.bizCalcSql,\r\n          bizCode: this.form.bizCode,\r\n          keepHistory: this.form.keepHistory,\r\n          bizTabCode: this.form.bizTabCode,\r\n          targetDataSource: this.form.targetDataSource\r\n        }\r\n        getDimensions(param).then(data => {\r\n          if (data.code == 0) {\r\n            _this.atomDimensions = data.data\r\n            _this.dimensionDialog = true\r\n          } else {\r\n            this.$message(data.msg)\r\n          }\r\n        })\r\n        getDimInfo().then(data => {\r\n          _this.dimensions = data.data\r\n        })\r\n        /* const colParam = {\r\n          'id': this.form.targetDataSource,\r\n          'tablename': this.form.bizTabCode\r\n          /!* 'data_type': this.form.filterColumn*!/\r\n        }*/\r\n        if (this.form.bizTabCode != null) {\r\n          getColumnByTabel(this.form.targetDataSource, this.form.bizTabCode).then(data => {\r\n            _this.colCodes = data.data\r\n          })\r\n          /* getColumns(colParam).then(data => {\r\n            if (data.code == 0) {\r\n              _this.colCodes = data.data\r\n              console.log(data.data)\r\n            } else {\r\n              _this.colCodes = []\r\n              alert('数据源连接错误')\r\n            }\r\n          })*/\r\n        } else {\r\n          this.bizTabCodeDis = true\r\n        }\r\n      }\r\n    },\r\n    // 接收维度信息\r\n    getAtomDimensions(data) {\r\n      this.form.atomDimensions = data\r\n    },\r\n    handleCategoryClick(data) {\r\n      console.log(data)\r\n      this.crud.form.categoryId = data.id\r\n      this.crud.query.categoryIds = data.childrenIds\r\n      this.crud.query.categoryType = data.categoryType\r\n      this.query.categoryType = data.categoryType\r\n      this.categoryType = data.categoryType\r\n      this.crud.query.categoryId = data.id\r\n      this.form.categoryId = data.id\r\n      this.form.tenant = data.tenant\r\n      this.query.tenant = data.tenant\r\n      this.crud.query.tenant = data.tenant\r\n      const parentId = data.parentId;\r\n      if (parentId == null || parentId == \"r1\") {\r\n        this.crud.optShow.add = false;\r\n        this.crud.form.categoryId = null\r\n        this.crud.query.categoryIds = null\r\n        this.crud.query.categoryId = null\r\n        //this.crud.form.indFirstType = data.id;\r\n        //this.initIndSecondType(data.id,'form');\r\n      } else if (parentId == '0') {\r\n        if (data.categoryType == 0) {\r\n          this.crud.optShow.add = true;\r\n        }\r\n        this.crud.form.indFirstType = data.id;\r\n        this.initIndSecondType(data.id, 'form');\r\n      } else {\r\n        if (data.categoryType == 0) {\r\n          this.crud.optShow.add = true;\r\n        }\r\n        this.crud.form.indFirstType = data.parentId;\r\n        this.initIndSecondType(data.parentId, 'form');\r\n        this.crud.form.indSecondType = data.id;\r\n      }\r\n      this.initDimInfos(2)\r\n      this.crud.refresh()\r\n    },\r\n    // 数据源发生变化时查询对应的数据源下的表\r\n    dataSourceChangeHandle(val) {\r\n      this.form.bizTabCode = null\r\n      /* const param = {\r\n        id: val\r\n      }\r\n      getTables(param).then(data => {\r\n        this.tableInfo = data.data\r\n      })*/\r\n      // 通过数据源id查询表\r\n      getTablesById(val).then(data => {\r\n        this.tableInfo = data.data\r\n      })\r\n    },\r\n    toSourceDataName(row) {\r\n      let name = ''\r\n      this.sourceData.forEach(row1 => {\r\n        if (row1.id == row.sourceDataSource) {\r\n          name = row1.datasourceName\r\n        }\r\n      })\r\n      return name\r\n    },\r\n    toTargetDataName(row) {\r\n      let name = ''\r\n      this.sourceData.forEach(row1 => {\r\n        if (row1.id == row.targetDataSource) {\r\n          name = row1.datasourceName\r\n        }\r\n      })\r\n      return name\r\n    },\r\n    /** 点击计算按钮触发 */\r\n    processA(data) {\r\n      const bizCodes = []\r\n      for (let i = 0; i < data.length; i++) {\r\n        bizCodes.push(data[i].bizCode)\r\n      }\r\n      this.processParam.codes = bizCodes\r\n      this.processDialog = true\r\n    },\r\n    processB() {\r\n      if (this.dateValue == '') {\r\n        this.crud.notify('日期不能为空', CRUD.NOTIFICATION_TYPE.ERROR)\r\n      } else {\r\n        this.processParam.periodDate = this.dateFormat(this.dateValue, 'YYYYMMDD')\r\n        process(this.processParam, 'atom').then(data => {\r\n          if (data.code == 0) {\r\n            this.crud.notify(data.msg, CRUD.NOTIFICATION_TYPE.SUCCESS)\r\n          } else {\r\n            this.crud.notify(data.msg, CRUD.NOTIFICATION_TYPE.ERROR)\r\n          }\r\n          this.processDialog = false\r\n        })\r\n      }\r\n    },\r\n    // 新增维度\r\n    addDimension() {\r\n      this.dimension.classificationId = null\r\n      this.dimension.categoryName = null\r\n      this.dimension.remarks = null\r\n      this.dimension.serialNo = this.form.serialNo\r\n      this.showIndDimensionAdd = true\r\n    },\r\n    // 新增维度值\r\n    addDimensionValue() {\r\n      this.initDimInfos(2)\r\n      /* this.dimensionValue.dimInfoId = null\r\n       this.dimensionValue.lastLevelDimValueId = null\r\n       this.dimensionValue.categoryName = null*/\r\n      this.dimensionValue.serialNo = this.form.serialNo\r\n      this.showIndDimensionValueAdd = true\r\n    },\r\n    // 新增维度和维度值\r\n    addDimensionAndValue() {\r\n      if (this.dimensionNumber >= 10) {\r\n        return;\r\n      }\r\n      this.dimensionArr.push(++this.dimensionNumber)\r\n      this.dimensionArr = this.uniqueArr(this.dimensionArr)\r\n      if (this.dimensionNumber == 3) {\r\n        this.dimAndValueObject3.isShow = true\r\n      } else if (this.dimensionNumber == 4) {\r\n        this.dimAndValueObject4.isShow = true\r\n      } else if (this.dimensionNumber == 5) {\r\n        this.dimAndValueObject5.isShow = true\r\n      } else if (this.dimensionNumber == 6) {\r\n        this.dimAndValueObject6.isShow = true\r\n      } else if (this.dimensionNumber == 7) {\r\n        this.dimAndValueObject7.isShow = true\r\n      } else if (this.dimensionNumber == 8) {\r\n        this.dimAndValueObject8.isShow = true\r\n      } else if (this.dimensionNumber == 9) {\r\n        this.dimAndValueObject9.isShow = true\r\n      } else if (this.dimensionNumber == 10) {\r\n        this.dimAndValueObject10.isShow = true\r\n      }\r\n      // this.dimensionArr.push({ id: ++this.dimensionNumber, value: { dimension: null, dimensionValue: null } })\r\n    },\r\n    // 删除维度和维度值\r\n    deleteDimensionAndValue(item) {\r\n      this.dimensionArr.splice(this.dimensionArr.indexOf(item), 1);\r\n      if (item == 1) {\r\n        this.dimAndValueObject1 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n\r\n      } else if (item == 2) {\r\n        this.dimAndValueObject2 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 3) {\r\n        this.dimAndValueObject3 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 4) {\r\n        this.dimAndValueObject4 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 5) {\r\n        this.dimAndValueObject5 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 6) {\r\n        this.dimAndValueObject6 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 7) {\r\n        this.dimAndValueObject7 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 8) {\r\n        this.dimAndValueObject8 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 9) {\r\n        this.dimAndValueObject9 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      } else if (item == 10) {\r\n        this.dimAndValueObject10 = {\r\n          isShow: false,\r\n          dimension: null,\r\n          dimensionValue: null,\r\n          dimensionName: null\r\n        }\r\n      }\r\n      this.dimensionNumber = 2;\r\n    },\r\n    // 数组去重\r\n    uniqueArr(arr) {\r\n      var x = new Set(arr);\r\n      return [...x];\r\n    },\r\n    // 衍生指标编辑指标口径规则\r\n    showIndDefRuleDialog() {\r\n      // this.indDefRuleStr = ''\r\n      this.value = []\r\n      this.showIndDefRule = true\r\n    },\r\n    // 关闭衍生指标编辑指标口径规则\r\n    closeIndDefRuleDialog() {\r\n      this.showIndDefRule = false\r\n    },\r\n    handleChange(value, direction, movedKeys) {\r\n      //value = value.toString();\r\n      //direction = direction.toString();\r\n      //value = value.substring(value.lastIndexOf(\",\")+1,value.length).trim();\r\n      /*if(value == \"true\" && direction == \"right\"){\r\n          this.$message({\r\n            message: '该指标结果可能存在补录，请确认是否引用！',\r\n            type: 'warning'\r\n          });\r\n      }*/\r\n    },\r\n    // 新增指标内部警戒值（表示预警）\r\n    addIndInnerWarnValue() {\r\n      this.indInnerWarnValueArr.push(++this.indInnerWarnValueNumber)\r\n      this.indInnerWarnValueArr = this.uniqueArr(this.indInnerWarnValueArr)\r\n    },\r\n    // 删除指标内部警戒值（表示预警）\r\n    delIndInnerWarnValue(item) {\r\n      this.indInnerWarnValueArr.splice(this.indInnerWarnValueArr.indexOf(item), 1);\r\n      this.indInnerWarnValueNumber = 1\r\n    },\r\n    // 新增指标内部警戒值（表示通过）\r\n    addIndInnerWarnPassValue() {\r\n      this.indInnerWarnPassValueArr.push(++this.indInnerWarnPassValueNumber)\r\n      this.indInnerWarnPassValueArr = this.uniqueArr(this.indInnerWarnPassValueArr)\r\n    },\r\n    // 删除指标内部警戒值（表示通过）\r\n    delIndInnerWarnPassValue(item) {\r\n      this.indInnerWarnPassValueArr.splice(this.indInnerWarnPassValueArr.indexOf(item), 1);\r\n      this.indInnerWarnPassValueNumber = 1\r\n    },\r\n    // 新增指标监管警戒值（表示预警）\r\n    addIndMonWarnValue() {\r\n      this.indMonWarnValueArr.push(++this.indMonWarnValueNumber)\r\n      this.indMonWarnValueArr = this.uniqueArr(this.indMonWarnValueArr)\r\n    },\r\n    // 删除指标监管警戒值（表示预警）\r\n    delIndMonWarnValue(item) {\r\n      this.indMonWarnValueArr.splice(this.indMonWarnValueArr.indexOf(item), 1);\r\n      this.indMonWarnValueNumber = 1\r\n    },\r\n    // 新增指标监管警戒值（表示通过）\r\n    addIndMonWarnPassValue() {\r\n      this.indMonWarnPassValueArr.push(++this.indMonWarnPassValueNumber)\r\n      this.indMonWarnPassValueArr = this.uniqueArr(this.indMonWarnPassValueArr)\r\n    },\r\n    // 删除指标监管警戒值（表示通过）\r\n    delIndMonWarnPassValue(item) {\r\n      this.indMonWarnPassValueArr.splice(this.indMonWarnPassValueArr.indexOf(item), 1);\r\n      this.indMonWarnPassValueNumber = 1\r\n    },\r\n    commitAtomWithSign() {\r\n      this.$refs['signform'].validate(valid => {\r\n        console.log(\"this.sign.signDeptId  \" + this.sign.signDeptId)\r\n        console.log(\"valid is\" + valid)\r\n        if (!valid) {\r\n          return;\r\n        }\r\n        if (this.sign.signDeptId != null && this.sign.signDeptId != '' && this.sign.signDeptId != 'null' && this.sign.signDeptId != 'undefined') {\r\n          checkDeptUser(this.sign.signDeptId).then(res => {\r\n            if (res.code == \"0000\") {\r\n              if (this.sign.oprType == 1) {//新增\r\n                this.crud.form.signDeptIds = this.sign.signDeptId;\r\n                this.crud.submitCU();\r\n              } else if (this.sign.oprType == 2) {//修改\r\n                this.crud.form.signDeptIds = this.sign.signDeptId;\r\n                this.crud.submitCU();\r\n              } else if (this.sign.oprType == 3) {//发起审批流程\r\n                this.startProcessVerify(this.sign.data);\r\n              } else if (this.sign.oprType == 4) {//删除\r\n                this.sign.data.signDeptIds = this.sign.signDeptId;\r\n                this.abolishSingleAtom(this.sign.data);\r\n              } else if (this.sign.oprType == 5) {//废止\r\n                this.submitCacelInd(this.sign.data, this.sign.signDeptId);\r\n              }\r\n              this.closeSignDialog();\r\n            } else {\r\n              this.$notify({\r\n                title: res.msg,\r\n                type: 'error',\r\n                duration: 2500\r\n              })\r\n            }\r\n          })\r\n        } else {\r\n          if (this.sign.oprType == 1) {//新增\r\n            this.crud.form.signDeptIds = this.sign.signDeptId;\r\n            this.crud.submitCU();\r\n          } else if (this.sign.oprType == 2) {//修改\r\n            this.crud.form.signDeptIds = this.sign.signDeptId;\r\n            this.crud.submitCU();\r\n          } else if (this.sign.oprType == 3) {//发起审批流程\r\n            this.startProcessVerify(this.sign.data);\r\n          } else if (this.sign.oprType == 4) {//删除\r\n            this.sign.data.signDeptIds = this.sign.signDeptId;\r\n            this.abolishSingleAtom(this.sign.data);\r\n          } else if (this.sign.oprType == 5) {//废止\r\n            this.submitCacelInd(this.sign.data, this.sign.signDeptId);\r\n          }\r\n          this.closeSignDialog();\r\n        }\r\n      });\r\n\r\n    },\r\n    // 废止指标\r\n    cancelInd(data) {\r\n      let newIeArr = 0;\r\n      let unNewIeArr = 0;\r\n      if (data == null && !Array.isArray(data)) return;\r\n      let ids = \"\";\r\n      for (let i = 0; i < data.length; i++) {\r\n        const indVerifyStatus = data[i].indVerifyStatus;\r\n        const indDeployStatus = data[i].indDeployStatus;\r\n        const bizCode = data[i].bizCode;\r\n        if (indVerifyStatus == '2') {\r\n          this.$notify({\r\n            title: '审批中的指标不能废止',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (indDeployStatus == '3') {\r\n          this.$notify({\r\n            title: '已废止的指标不能再次废止',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (indDeployStatus == '1') {\r\n          newIeArr += 1;\r\n        } else {\r\n          unNewIeArr += 1;\r\n        }\r\n        ids += data[i].id + \",\";\r\n      }\r\n      if (ids != null && ids.includes(\",\")) {\r\n        ids = ids.substr(0, ids.length - 1);\r\n      }\r\n      if (newIeArr > 0 && unNewIeArr > 0) {\r\n        this.$notify({\r\n          title: '请选择审批状态一致的指标操作',\r\n          type: 'error',\r\n          duration: 2500\r\n        })\r\n        return;\r\n      } else if (newIeArr == 0 && unNewIeArr == 0) {\r\n        this.$notify({\r\n          title: '请选择指标记录再操作',\r\n          type: 'error',\r\n          duration: 2500\r\n        })\r\n        return;\r\n      }\r\n      checkRef(ids).then(res => {\r\n        if (res.code == 0) {\r\n          if (res.data == false) {\r\n            if (newIeArr > 0 && unNewIeArr == 0) { //批量删除\r\n              //批量删除\r\n              this.$confirm('确认删除指标?', '删除指标', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n              }).then(() => {\r\n                defaultCrud.delAllLoading = true\r\n                delAtom(ids).then(res => {\r\n                  if (res.code == 0) {\r\n                    this.$notify({\r\n                      title: '指标删除成功',\r\n                      type: 'success',\r\n                      duration: 2500\r\n                    })\r\n                  } else {\r\n                    this.$notify({\r\n                      title: '指标删除失败',\r\n                      type: 'error',\r\n                      duration: 2500\r\n                    })\r\n                  }\r\n                  this.crud.refresh();\r\n                })\r\n              }).catch(() => {\r\n              })\r\n            } else if (newIeArr == 0 && unNewIeArr > 0) {//批量废止\r\n              this.openSignDialog(ids, 5, '发起废止流程', '请确认是否发起指标废止流程? ');\r\n            }\r\n\r\n          } else {\r\n            this.$notify({title: '该指标已被引用，不能删除或废止！', type: 'error', duration: 2500})\r\n\r\n          }\r\n\r\n        } else {\r\n          this.$notify({title: '删除或废止失败！', type: 'error', duration: 2500})\r\n\r\n        }\r\n      })\r\n    },\r\n    submitCacelInd(ids, signDeptId) {\r\n      //批量废止\r\n      abolish(ids, signDeptId).then(res => {\r\n        if (res.code == 0) {\r\n          this.$notify({\r\n            title: '发起指标废止流程成功',\r\n            type: 'success',\r\n            duration: 2500\r\n          })\r\n        } else {\r\n          this.$notify({\r\n            title: '发起指标废止流程失败',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n        }\r\n        this.crud.refresh();\r\n      })\r\n\r\n    },\r\n    // 指标发起审批\r\n    processVerify(data) {\r\n      if (data == null && !Array.isArray(data)) return;\r\n      let newIeArr = 0;\r\n      let unNewIeArr = 0;\r\n      let ids = \"\";\r\n      for (let i = 0; i < data.length; i++) {\r\n        const indVerifyStatus = data[i].indVerifyStatus;\r\n        const indDeployStatus = data[i].indDeployStatus\r\n        if (indDeployStatus == '1') {\r\n          newIeArr += 1;\r\n        } else {\r\n          unNewIeArr += 1;\r\n        }\r\n        if (newIeArr > 0 && unNewIeArr > 0) {\r\n          this.$notify({\r\n            title: '请选择发布状态一致的指标操作',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (indVerifyStatus == '2') {\r\n          this.$notify({\r\n            title: '审批中的指标不能重复发起审批',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (indVerifyStatus == '3') {\r\n          this.$notify({\r\n            title: '已拒绝的指标不能发起审批',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (indVerifyStatus == '4') {\r\n          this.$notify({\r\n            title: '已审批通过的指标不能发起审批',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (indDeployStatus == '3') {\r\n          this.$notify({\r\n            title: '已废止的指标不能发起审批',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        ids += data[i].id + \",\";\r\n      }\r\n      if (ids != null && ids.includes(\",\")) {\r\n        ids = ids.substr(0, ids.length - 1);\r\n      }\r\n      this.openSignDialog(ids, 3, '发起审批流程', '是否发起审批? ');\r\n    },\r\n    openSignDialog(data, oprType, title, msg) {\r\n      this.showSign = true\r\n      this.showSignOrg = false\r\n      this.sign.signDeptId = null\r\n      this.sign.signDeptName = null\r\n      this.sign.isSign = '0'\r\n      this.sign.data = data;\r\n      this.sign.oprType = oprType\r\n      this.sign.title = title\r\n      this.sign.msg = msg\r\n    },\r\n    startProcessVerify(ids) {\r\n      startProcess(ids, this.sign.signDeptId).then(res => {\r\n        if (res.code == 0) {\r\n          this.$notify({\r\n            title: '发起审批请求成功',\r\n            type: 'success',\r\n            duration: 2500\r\n          })\r\n        } else {\r\n          this.$notify({\r\n            title: '发起审批请求失败',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n        }\r\n        this.crud.refresh();\r\n      })\r\n    },\r\n    // 关闭指标历史版本弹框\r\n    closeIndHistoryDialog() {\r\n      this.historyData = [];\r\n      this.showIndHistory = false\r\n    },\r\n    //关闭流程查看弹框\r\n    closeFlowDialog() {\r\n      this.flowData = [];\r\n      this.showFlow = false\r\n    },\r\n    // 关闭维度新增弹框\r\n    closeIndDimensionAddDialog() {\r\n      this.showIndDimensionAdd = false\r\n    },\r\n    // 确认提交新增维度\r\n    commitDim() {\r\n      this.$refs['dimform'].validate(valid => {\r\n        if (!valid) {\r\n          return;\r\n        }\r\n        this.dimension.status = '1';\r\n        this.dimension.tenant = this.form.tenant;\r\n        this.dimension.serialNo = this.form.serialNo\r\n        crudIndDimInfo.crud.add(this.dimension).then(data => {\r\n          if (data.code && data.code != 0) {\r\n            this.$notify({\r\n              title: data.msg,\r\n              type: 'error',\r\n              duration: 2500\r\n            })\r\n            this.showIndDimensionAdd = false\r\n          } else {\r\n            this.$notify({\r\n              title: '新增成功',\r\n              type: 'success',\r\n              duration: 2500\r\n            })\r\n            this.initDimInfos(2)\r\n            this.showIndDimensionAdd = false\r\n          }\r\n        })\r\n      });\r\n    },\r\n    // 关闭维度值新增弹框\r\n    closeIndDimensionValueAddDialog() {\r\n      this.showIndDimensionValueAdd = false\r\n    },\r\n    // 确认提交新增维度值\r\n    commitDimValue() {\r\n      this.$refs['dimValform'].validate(valid => {\r\n        console.log(\"valid is\" + valid)\r\n        if (!valid) {\r\n          return;\r\n        }\r\n        if (this.dimensionValue.dimInfoId == null || this.dimensionValue.dimInfoId.length == 0) {\r\n          this.$notify({\r\n            title: '所属维度不能为空',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n        if (this.dimensionValue.categoryName == null || this.dimensionValue.categoryName.length == 0) {\r\n          this.$notify({\r\n            title: '指标维度值不能为空',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n          return;\r\n        }\r\n\r\n        this.dimensionValue.status = 1;\r\n        this.dimensionValue.tenant = this.form.tenant;\r\n        this.dimension.serialNo = this.form.serialNo\r\n        crudIndDimVal.crud.add(this.dimensionValue).then(data => {\r\n          if (data.code && data.code != 0) {\r\n            this.$notify({\r\n              title: data.msg,\r\n              type: 'error',\r\n              duration: 2500\r\n            })\r\n            this.showIndDimensionValueAdd = false\r\n          } else {\r\n            this.$notify({\r\n              title: '新增成功',\r\n              type: 'success',\r\n              duration: 2500\r\n            })\r\n            this.initDimValues(2)\r\n            this.showIndDimensionValueAdd = false\r\n          }\r\n        })\r\n      });\r\n    },\r\n    // 选择指标进行规则拼接\r\n    selectInd() {\r\n      if (this.value.length == 0) {\r\n        this.$message({\r\n          message: '请选择一个指标！',\r\n          type: 'error'\r\n        });\r\n        return;\r\n      }\r\n      /* if(this.value.length > 1) {\r\n         this.$message({\r\n           message: '只能选择一个指标！',\r\n           type: 'error'\r\n         });\r\n         return;\r\n       }*/\r\n      let atoms = this.value;\r\n      let refAtoms = \"\";\r\n      let _indDefRuleStr = \"\";\r\n      for (let atom of atoms) {\r\n        let keyLabel = atom;\r\n        let keyArr = keyLabel.split(\",\");\r\n        let atomId = keyArr[0];\r\n        let atomName = keyArr[1];\r\n\r\n        let hasRef = keyArr[2];\r\n        let atomCode = keyArr[3];\r\n        if (hasRef == \"true\") {\r\n          refAtoms += atomName + \",\";\r\n        }\r\n        _indDefRuleStr += ' [' + atomName + '] ';\r\n        //this.indDefRuleId += atomId;\r\n        //this.indDefRuleVal += atomCode;\r\n        this.indDefRuleStrs.push('[' + atomName + ']');\r\n        this.indDefRuleIds.push(atomId);\r\n        this.indDefRuleVals.push(atomCode);\r\n      }\r\n      if (refAtoms != \"\") {\r\n        this.$message({\r\n          message: refAtoms + ' 指标结果可能存在补录，请确认是否引用！',\r\n          type: 'warning'\r\n        });\r\n      }\r\n\r\n      /*if(this.indDefRuleStr != null\r\n          && (this.endsWithStr(this.indDefRuleStr))) {\r\n        this.indDefRuleStr += '[' + keyArr[1] + ']';\r\n        this.indDefRuleId += keyArr[0];\r\n        this.indDefRuleVal += keyArr[3];\r\n      } else {\r\n        this.indDefRuleStr = '[' + keyArr[1] + ']';\r\n        this.indDefRuleId += keyArr[0];\r\n        this.indDefRuleVal = keyArr[3];\r\n      }*/\r\n      this.showIndDefRule = false\r\n      //this.hasCalc = false;\r\n      /*this.rules.indDefRule.required = false\r\n      if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n        if(this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.errmsgIndDefRule = true\r\n        } else {\r\n          this.errmsgIndDefRule = false\r\n        }\r\n\r\n      } else {\r\n        this.errmsgIndDefRule = false\r\n      }*/\r\n      this.form.indDefRule = this.form.indDefRule == null ? '' : this.form.indDefRule;\r\n      this.form.indDefRule += _indDefRuleStr\r\n      this.checkIndDefRule();\r\n    },\r\n    // 指标规则+号按钮\r\n    indDefRulePlus() {\r\n      if (this.indDefRuleStr != null && this.indDefRuleStr.length > 0\r\n          && !this.beginWithStr(this.indDefRuleStr)) {\r\n\r\n\r\n        if (this.endsWithStr(this.indDefRuleStr)) {\r\n          this.indDefRuleStr = this.indDefRuleStr.substring(0, this.indDefRuleStr.length - 3) + ' + '\r\n          this.indDefRuleVal = this.indDefRuleVal.substring(0, this.indDefRuleVal.length - 3) + ' + '\r\n          this.indDefRuleId = this.indDefRuleId.substring(0, this.indDefRuleId.length - 3) + ' + '\r\n        } else {\r\n          this.indDefRuleStr += ' + '\r\n          this.indDefRuleVal += ' + '\r\n          this.indDefRuleId += ' + '\r\n        }\r\n\r\n        this.form.indDefRule = this.indDefRuleStr\r\n      }\r\n    },\r\n    // 指标规则-号按钮\r\n    indDefRuleSubtraction() {\r\n      if (this.indDefRuleStr != null && this.indDefRuleStr.length > 0\r\n          && !this.beginWithStr(this.indDefRuleStr)) {\r\n        if (this.endsWithStr(this.indDefRuleStr)) {\r\n          this.indDefRuleStr = this.indDefRuleStr.substring(0, this.indDefRuleStr.length - 3) + ' - '\r\n          this.indDefRuleVal = this.indDefRuleVal.substring(0, this.indDefRuleVal.length - 3) + ' - '\r\n          this.indDefRuleId = this.indDefRuleId.substring(0, this.indDefRuleId.length - 3) + ' - '\r\n        } else {\r\n          this.indDefRuleStr += ' - '\r\n          this.indDefRuleVal += ' - '\r\n          this.indDefRuleId += ' - '\r\n        }\r\n\r\n        this.form.indDefRule = this.indDefRuleStr\r\n      }\r\n    },\r\n    // 指标规则×号按钮\r\n    indDefRuleMultiplication() {\r\n      if (this.indDefRuleStr != null && this.indDefRuleStr.length > 0\r\n          && !this.beginWithStr(this.indDefRuleStr)) {\r\n\r\n        if (this.endsWithStr(this.indDefRuleStr)) {\r\n          this.indDefRuleStr = this.indDefRuleStr.substring(0, this.indDefRuleStr.length - 3) + ' × '\r\n          this.indDefRuleVal = this.indDefRuleVal.substring(0, this.indDefRuleVal.length - 3) + ' × '\r\n          this.indDefRuleId = this.indDefRuleId.substring(0, this.indDefRuleId.length - 3) + ' × '\r\n        } else {\r\n          this.indDefRuleStr += ' × '\r\n          this.indDefRuleVal += ' × '\r\n          this.indDefRuleId += ' × '\r\n        }\r\n        this.form.indDefRule = this.indDefRuleStr\r\n      }\r\n    },\r\n    // 指标规则/号按钮\r\n    indDefRuleDivision() {\r\n      if (this.indDefRuleStr != null && this.indDefRuleStr.length > 0\r\n          && !this.beginWithStr(this.indDefRuleStr)) {\r\n        if (this.endsWithStr(this.indDefRuleStr)) {\r\n          this.indDefRuleStr = this.indDefRuleStr.substring(0, this.indDefRuleStr.length - 3) + ' / '\r\n          this.indDefRuleVal = this.indDefRuleVal.substring(0, this.indDefRuleVal.length - 3) + ' / '\r\n          this.indDefRuleId = this.indDefRuleId.substring(0, this.indDefRuleId.length - 3) + ' / '\r\n        } else {\r\n          this.indDefRuleStr += ' / '\r\n          this.indDefRuleVal += ' / '\r\n          this.indDefRuleId += ' / '\r\n        }\r\n\r\n        this.form.indDefRule = this.indDefRuleStr\r\n      }\r\n    },\r\n    changeDimVal1(val) {\r\n      if (val == null || val == '') {\r\n        this.errmsgDimV1 = true;\r\n      } else {\r\n        this.errmsgDimV1 = false;\r\n        this.dimAndValueObject1.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal2(val) {\r\n      if (this.dimAndValueObject2.dimension != null && this.dimAndValueObject2.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV2 = true;\r\n      } else {\r\n        this.errmsgDimV2 = false;\r\n        this.dimAndValueObject2.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal3(val) {\r\n      if (this.dimAndValueObject3.dimension != null && this.dimAndValueObject3.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV3 = true;\r\n      } else {\r\n        this.errmsgDimV3 = false;\r\n        this.dimAndValueObject3.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal4(val) {\r\n      if (this.dimAndValueObject4.dimension != null && this.dimAndValueObject4.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV4 = true;\r\n      } else {\r\n        this.errmsgDimV4 = false;\r\n        this.dimAndValueObject4.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal5(val) {\r\n      if (this.dimAndValueObject5.dimension != null && this.dimAndValueObject5.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV5 = true;\r\n      } else {\r\n        this.errmsgDimV5 = false;\r\n        this.dimAndValueObject5.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal6(val) {\r\n      if (this.dimAndValueObject6.dimension != null && this.dimAndValueObject6.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV6 = true;\r\n      } else {\r\n        this.errmsgDimV6 = false;\r\n        this.dimAndValueObject6.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal7(val) {\r\n      if (this.dimAndValueObject7.dimension != null && this.dimAndValueObject7.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV7 = true;\r\n      } else {\r\n        this.errmsgDimV7 = false;\r\n        this.dimAndValueObject7.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal8(val) {\r\n      if (this.dimAndValueObject8.dimension != null && this.dimAndValueObject8.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV8 = true;\r\n      } else {\r\n        this.errmsgDimV8 = false;\r\n        this.dimAndValueObject8.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal9(val) {\r\n      if (this.dimAndValueObject9.dimension != null && this.dimAndValueObject9.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV9 = true;\r\n      } else {\r\n        this.errmsgDimV9 = false;\r\n        this.dimAndValueObject9.dimensionValue = ''\r\n      }\r\n    },\r\n    changeDimVal10(val) {\r\n      if (this.dimAndValueObject10.dimension != null && this.dimAndValueObject10.dimension != '' && (val == null || val == '')) {\r\n        this.errmsgDimV10 = true;\r\n      } else {\r\n        this.errmsgDimV10 = false;\r\n        this.dimAndValueObject10.dimensionValue = ''\r\n      }\r\n    },\r\n    handleDimValueClick1(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName1.push(data.categoryName)\r\n        this.dimensionTmpName1 = this.uniqueArr(this.dimValueTmpName1)\r\n        this.dimValueTmp1.push(data.id)\r\n        this.dimensionTmp1 = this.uniqueArr(this.dimValueTmp1)\r\n      } else {\r\n        this.dimValueTmpName1.splice(this.dimValueTmpName1.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName1 = this.uniqueArr(this.dimValueTmpName1)\r\n        this.dimValueTmp1.splice(this.dimValueTmp1.indexOf(data.id), 1)\r\n        this.dimensionTmp1 = this.uniqueArr(this.dimValueTmp1)\r\n      }\r\n      this.dimAndValueObject1.dimensionName = this.dimensionTmpName1.join(',')\r\n      this.dimAndValueObject1.dimensionValue = this.dimensionTmp1.join(',')\r\n      this.errmsgDimV1 = this.dimAndValueObject1.dimensionValue == null || this.dimAndValueObject1.dimensionValue == '';\r\n    },\r\n    handleDimValueClick2(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName2.push(data.categoryName)\r\n        this.dimensionTmpName2 = this.uniqueArr(this.dimValueTmpName2)\r\n        this.dimValueTmp2.push(data.id)\r\n        this.dimensionTmp2 = this.uniqueArr(this.dimValueTmp2)\r\n      } else {\r\n        this.dimValueTmpName2.splice(this.dimValueTmpName2.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName2 = this.uniqueArr(this.dimValueTmpName2)\r\n        this.dimValueTmp2.splice(this.dimValueTmp2.indexOf(data.id), 1)\r\n        this.dimensionTmp2 = this.uniqueArr(this.dimValueTmp2)\r\n      }\r\n      this.dimAndValueObject2.dimensionName = this.dimensionTmpName2.join(',')\r\n      this.dimAndValueObject2.dimensionValue = this.dimensionTmp2.join(',')\r\n      this.errmsgDimV2 = this.dimAndValueObject2.dimension != null && this.dimAndValueObject2.dimension != null\r\n          && (this.dimAndValueObject2.dimensionValue == null || this.dimAndValueObject2.dimensionValue == '');\r\n    },\r\n    handleDimValueClick3(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName3.push(data.categoryName)\r\n        this.dimensionTmpName3 = this.uniqueArr(this.dimValueTmpName3)\r\n        this.dimValueTmp3.push(data.id)\r\n        this.dimensionTmp3 = this.uniqueArr(this.dimValueTmp3)\r\n      } else {\r\n        this.dimValueTmpName3.splice(this.dimValueTmpName3.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName3 = this.uniqueArr(this.dimValueTmpName3)\r\n        this.dimValueTmp3.splice(this.dimValueTmp3.indexOf(data.id), 1)\r\n        this.dimensionTmp3 = this.uniqueArr(this.dimValueTmp3)\r\n      }\r\n      this.dimAndValueObject3.dimensionName = this.dimensionTmpName3.join(',')\r\n      this.dimAndValueObject3.dimensionValue = this.dimensionTmp3.join(',')\r\n      this.errmsgDimV3 = this.dimAndValueObject3.dimension != null && this.dimAndValueObject3.dimension != null\r\n          && (this.dimAndValueObject3.dimensionValue == null || this.dimAndValueObject3.dimensionValue == '');\r\n    },\r\n    handleDimValueClick4(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName4.push(data.categoryName)\r\n        this.dimensionTmpName4 = this.uniqueArr(this.dimValueTmpName4)\r\n        this.dimValueTmp4.push(data.id)\r\n        this.dimensionTmp4 = this.uniqueArr(this.dimValueTmp4)\r\n      } else {\r\n        this.dimValueTmpName4.splice(this.dimValueTmpName4.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName4 = this.uniqueArr(this.dimValueTmpName4)\r\n        this.dimValueTmp4.splice(this.dimValueTmp4.indexOf(data.id), 1)\r\n        this.dimensionTmp4 = this.uniqueArr(this.dimValueTmp4)\r\n      }\r\n      this.dimAndValueObject4.dimensionName = this.dimensionTmpName4.join(',')\r\n      this.dimAndValueObject4.dimensionValue = this.dimensionTmp4.join(',')\r\n      this.errmsgDimV4 = this.dimAndValueObject4.dimension != null && this.dimAndValueObject4.dimension != null\r\n          && (this.dimAndValueObject4.dimensionValue == null || this.dimAndValueObject4.dimensionValue == '');\r\n    },\r\n    handleDimValueClick5(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName5.push(data.categoryName)\r\n        this.dimensionTmpName5 = this.uniqueArr(this.dimValueTmpName5)\r\n        this.dimValueTmp5.push(data.id)\r\n        this.dimensionTmp5 = this.uniqueArr(this.dimValueTmp5)\r\n      } else {\r\n        this.dimValueTmpName5.splice(this.dimValueTmpName3.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName5 = this.uniqueArr(this.dimValueTmpName5)\r\n        this.dimValueTmp5.splice(this.dimValueTmp5.indexOf(data.id), 1)\r\n        this.dimensionTmp5 = this.uniqueArr(this.dimValueTmp5)\r\n      }\r\n      this.dimAndValueObject5.dimensionName = this.dimensionTmpName5.join(',')\r\n      this.dimAndValueObject5.dimensionValue = this.dimensionTmp5.join(',')\r\n      this.errmsgDimV5 = this.dimAndValueObject5.dimension != null && this.dimAndValueObject5.dimension != null\r\n          && (this.dimAndValueObject5.dimensionValue == null || this.dimAndValueObject5.dimensionValue == '');\r\n    },\r\n    handleDimValueClick6(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName6.push(data.categoryName)\r\n        this.dimensionTmpName6 = this.uniqueArr(this.dimValueTmpName6)\r\n        this.dimValueTmp6.push(data.id)\r\n        this.dimensionTmp6 = this.uniqueArr(this.dimValueTmp6)\r\n      } else {\r\n        this.dimValueTmpName6.splice(this.dimValueTmpName6.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName6 = this.uniqueArr(this.dimValueTmpName6)\r\n        this.dimValueTmp6.splice(this.dimValueTmp6.indexOf(data.id), 1)\r\n        this.dimensionTmp6 = this.uniqueArr(this.dimValueTmp6)\r\n      }\r\n      this.dimAndValueObject6.dimensionName = this.dimensionTmpName6.join(',')\r\n      this.dimAndValueObject6.dimensionValue = this.dimensionTmp6.join(',')\r\n      this.errmsgDimV6 = this.dimAndValueObject6.dimension != null && this.dimAndValueObject6.dimension != null\r\n          && (this.dimAndValueObject6.dimensionValue == null || this.dimAndValueObject6.dimensionValue == '');\r\n    },\r\n    handleDimValueClick7(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName7.push(data.categoryName)\r\n        this.dimensionTmpName7 = this.uniqueArr(this.dimValueTmpName7)\r\n        this.dimValueTmp7.push(data.id)\r\n        this.dimensionTmp7 = this.uniqueArr(this.dimValueTmp7)\r\n      } else {\r\n        this.dimValueTmpName7.splice(this.dimValueTmpName7.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName7 = this.uniqueArr(this.dimValueTmpName7)\r\n        this.dimValueTmp7.splice(this.dimValueTmp7.indexOf(data.id), 1)\r\n        this.dimensionTmp7 = this.uniqueArr(this.dimValueTmp7)\r\n      }\r\n      this.dimAndValueObject7.dimensionName = this.dimensionTmpName7.join(',')\r\n      this.dimAndValueObject7.dimensionValue = this.dimensionTmp7.join(',')\r\n      this.errmsgDimV7 = this.dimAndValueObject7.dimension != null && this.dimAndValueObject7.dimension != null\r\n          && (this.dimAndValueObject7.dimensionValue == null || this.dimAndValueObject7.dimensionValue == '');\r\n    },\r\n    handleDimValueClick8(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName8.push(data.categoryName)\r\n        this.dimensionTmpName8 = this.uniqueArr(this.dimValueTmpName8)\r\n        this.dimValueTmp8.push(data.id)\r\n        this.dimensionTmp8 = this.uniqueArr(this.dimValueTmp8)\r\n      } else {\r\n        this.dimValueTmpName8.splice(this.dimValueTmpName8.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName8 = this.uniqueArr(this.dimValueTmpName8)\r\n        this.dimValueTmp8.splice(this.dimValueTmp8.indexOf(data.id), 1)\r\n        this.dimensionTmp8 = this.uniqueArr(this.dimValueTmp8)\r\n      }\r\n      this.dimAndValueObject8.dimensionName = this.dimensionTmpName8.join(',')\r\n      this.dimAndValueObject8.dimensionValue = this.dimensionTmp8.join(',')\r\n      this.errmsgDimV8 = this.dimAndValueObject8.dimension != null && this.dimAndValueObject8.dimension != null\r\n          && (this.dimAndValueObject8.dimensionValue == null || this.dimAndValueObject8.dimensionValue == '');\r\n    },\r\n    handleDimValueClick9(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName9.push(data.categoryName)\r\n        this.dimensionTmpName9 = this.uniqueArr(this.dimValueTmpName9)\r\n        this.dimValueTmp9.push(data.id)\r\n        this.dimensionTmp9 = this.uniqueArr(this.dimValueTmp9)\r\n      } else {\r\n        this.dimValueTmpName9.splice(this.dimValueTmpName9.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName9 = this.uniqueArr(this.dimValueTmpName9)\r\n        this.dimValueTmp9.splice(this.dimValueTmp9.indexOf(data.id), 1)\r\n        this.dimensionTmp9 = this.uniqueArr(this.dimValueTmp9)\r\n      }\r\n      this.dimAndValueObject9.dimensionName = this.dimensionTmpName9.join(',')\r\n      this.dimAndValueObject9.dimensionValue = this.dimensionTmp9.join(',')\r\n      this.errmsgDimV9 = this.dimAndValueObject9.dimension != null && this.dimAndValueObject9.dimension != null\r\n          && (this.dimAndValueObject9.dimensionValue == null || this.dimAndValueObject9.dimensionValue == '');\r\n    },\r\n    handleDimValueClick10(data, selected) {\r\n      if (selected == true) {\r\n        this.dimValueTmpName10.push(data.categoryName)\r\n        this.dimensionTmpName10 = this.uniqueArr(this.dimValueTmpName10)\r\n        this.dimValueTmp10.push(data.id)\r\n        this.dimensionTmp10 = this.uniqueArr(this.dimValueTmp10)\r\n      } else {\r\n        this.dimValueTmpName10.splice(this.dimValueTmpName10.indexOf(data.categoryName), 1)\r\n        this.dimensionTmpName10 = this.uniqueArr(this.dimValueTmpName10)\r\n        this.dimValueTmp10.splice(this.dimValueTmp10.indexOf(data.id), 1)\r\n        this.dimensionTmp10 = this.uniqueArr(this.dimValueTmp10)\r\n      }\r\n      this.dimAndValueObject10.dimensionName = this.dimensionTmpName10.join(',')\r\n      this.dimAndValueObject10.dimensionValue = this.dimensionTmp10.join(',')\r\n      this.errmsgDimV10 = this.dimAndValueObject10.dimension != null && this.dimAndValueObject10.dimension != null\r\n          && (this.dimAndValueObject10.dimensionValue == null || this.dimAndValueObject10.dimensionValue == '');\r\n    },\r\n    indInnerWarnValueBiggerClick() {\r\n      this.form.indInnerWarnFlg = '>'\r\n      this.errmsgInnerWarning = false;\r\n    },\r\n    indInnerWarnValueBiggerEqualsClick() {\r\n      this.form.indInnerWarnFlg = '>='\r\n      this.errmsgInnerWarning = false;\r\n    },\r\n    indInnerWarnValueEqualsClick() {\r\n      this.form.indInnerWarnFlg = '='\r\n      this.errmsgInnerWarning = false;\r\n    },\r\n    indInnerWarnValueSmallerClick() {\r\n      this.form.indInnerWarnFlg = '<'\r\n      this.errmsgInnerWarning = false;\r\n    },\r\n    indInnerWarnValueSmallerEqualsClick() {\r\n      this.form.indInnerWarnFlg = '<='\r\n      this.errmsgInnerWarning = false;\r\n    },\r\n    indInnerWarnValueNotEqualsClick() {\r\n      this.form.indInnerWarnFlg = '≠'\r\n      this.errmsgInnerWarning = false;\r\n    },\r\n    indMonWarnValueBiggerClick() {\r\n      this.form.indMonWarnFlg = '>'\r\n      this.errmsgMonWarning = false;\r\n    },\r\n    indMonWarnValueBiggerEqualsClick() {\r\n      this.form.indMonWarnFlg = '>='\r\n      this.errmsgMonWarning = false;\r\n    },\r\n    indMonWarnValueEqualsClick() {\r\n      this.form.indMonWarnFlg = '='\r\n      this.errmsgMonWarning = false;\r\n    },\r\n    indMonWarnValueSmallerClick() {\r\n      this.form.indMonWarnFlg = '<'\r\n      this.errmsgMonWarning = false;\r\n    },\r\n    indMonWarnValueSmallerEqualsClick() {\r\n      this.form.indMonWarnFlg = '<='\r\n      this.errmsgMonWarning = false;\r\n    },\r\n    indMonWarnValueNotEqualsClick() {\r\n      this.form.indMonWarnFlg = '≠'\r\n      this.errmsgMonWarning = false;\r\n    },\r\n    //修改按钮弹框\r\n    modifyInd(data) {\r\n\r\n    },\r\n    async getCategoryName(row) {\r\n      if (row.indFirstType == null) {\r\n        return '未知分类'\r\n      }\r\n      let res = await crudIndCategory.getCategoryName(row.indFirstType);\r\n      if (res.code == 0) {\r\n        return res.data;\r\n      }\r\n      return '未知分类';\r\n      /*.then(res => {\r\n        if(res.code == 0) {\r\n          return res.data+\"ccc\";\r\n        }\r\n        return '未知分类';\r\n      })*/\r\n      //return '未知分类'\r\n    },\r\n    getDepts() {\r\n      getDepts({enabled: true}).then(res => {\r\n        this.depts = res.content\r\n      })\r\n    },\r\n    openEdit(row) {\r\n      let id = row.id;\r\n      checkRef(id).then(res => {\r\n        if (res.code == 0) {\r\n          if (res.data) {\r\n            this.$notify({\r\n              title: '该指标已被引用，不能修改！',\r\n              type: 'error',\r\n              duration: 2500\r\n            });\r\n            return;\r\n          }\r\n          this.crud.toEdit(row)\r\n        }\r\n      });\r\n    },\r\n    delAtom(row) {\r\n      checkRef(row.id).then(res => {\r\n        if (res.code == 0) {\r\n          if (res.data == false) {\r\n            if (row.indVerifyStatus == \"2\") {\r\n              this.$notify({\r\n                title: '审批中的指标不能删除',\r\n                type: 'error',\r\n                duration: 2500\r\n              })\r\n              return\r\n            }\r\n            if (row.indDeployStatus == \"3\") {//已废止\r\n              this.$alert('已废止指标，不能删除', '删除指标');\r\n              return;\r\n            }\r\n            if (row.indDeployStatus == \"1\") {//未发布\r\n              this.delSingleAtom(row);\r\n            } else if (row.indDeployStatus == \"2\") {//已发布\r\n              let msg = '该指标已发布，确认废止? ';\r\n              let title = '发起废止流程';\r\n              this.openSignDialog(row, 4, title, msg);\r\n            }\r\n\r\n          } else {\r\n            this.$notify({title: '该指标已被引用，不能删除或废止！', type: 'error', duration: 2500})\r\n            return;\r\n          }\r\n        } else {\r\n          this.$notify({title: '未知错误！', type: 'error', duration: 2500})\r\n        }\r\n      })\r\n    },\r\n    delSingleAtom(row) {\r\n      this.$confirm('请确认是否删除?', '删除指标', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        defaultCrud.delAllLoading = true\r\n        delAtom(row.id).then(res => {\r\n          if (res.code == 0) {\r\n            this.$notify({\r\n              title: '指标删除成功',\r\n              type: 'success',\r\n              duration: 2500\r\n            })\r\n          } else {\r\n            this.$notify({\r\n              title: '指标删除失败',\r\n              type: 'error',\r\n              duration: 2500\r\n            })\r\n          }\r\n          this.crud.refresh();\r\n        })\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    abolishSingleAtom(row) {\r\n      abolish(row.id, row.signDeptIds).then(res => {\r\n        if (res.code == 0) {\r\n          this.$notify({\r\n            title: '发起指标废止流程成功',\r\n            type: 'success',\r\n            duration: 2500\r\n          })\r\n        } else {\r\n          this.$notify({\r\n            title: '发起指标废止流程失败',\r\n            type: 'error',\r\n            duration: 2500\r\n          })\r\n        }\r\n        this.crud.refresh();\r\n      })\r\n    },\r\n    submitForm() {\r\n      this.crud.form.submitType = 1\r\n      if (!this.isSelfRule) {\r\n        var formulaFlag = this.checkFormulaExp(this.form.indDefRule);\r\n\r\n        if (!formulaFlag) {\r\n          this.indDefRuleErr = '指标口径规则错误！'\r\n          this.errmsgIndDefRule = true\r\n          return false;\r\n        }\r\n        let formulaExp = this.setFormulaExp(this.form.indDefRule);\r\n        if (formulaExp == null) {\r\n          this.indDefRuleErr = '指标口径规则错误！'\r\n          this.errmsgIndDefRule = true\r\n          return false;\r\n        }\r\n        formulaExp = formulaExp.replaceAll(\"#\", \"[\");\r\n        let data = {\r\n          indDefRule: this.form.indDefRule,\r\n          indDefRuleExp: formulaExp,\r\n          indDefRuleStrs: this.indDefRuleStrs,\r\n          indDefRuleIds: this.indDefRuleIds\r\n        }\r\n        checkDefRule(data).then(res => {\r\n          if (res.code == 0) {\r\n            console.log(\"data===>\" + res.data)\r\n            this.indDefRuleErr = '指标口径规则不能为空'\r\n            this.errmsgIndDefRule = false\r\n            this.crud.submitCU()\r\n            return true;\r\n          } else {\r\n            this.indDefRuleErr = res.msg\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n        });\r\n      } else {\r\n        this.crud.submitCU()\r\n      }\r\n    },\r\n    submitAndStartProcess() {\r\n      //验证指标类型\r\n      if (this.form.ieProp == null || this.form.ieProp == '') {\r\n        this.errmsgIeProp = true;\r\n      } else {\r\n        this.errmsgIeProp = false;\r\n      }\r\n      //验证第一分类\r\n      if (this.form.indFirstType == null || this.form.indFirstType == '') {\r\n        this.errmsgIndFirstType = true;\r\n      } else {\r\n        this.errmsgIndFirstType = false;\r\n      }\r\n      //验证第一分类\r\n      if (this.form.indSecondType == null || this.form.indSecondType == '') {\r\n        this.errmsgIndSecondType = true;\r\n      } else {\r\n        this.errmsgIndSecondType = false;\r\n      }\r\n      //验证指标层级\r\n      if (this.form.indLevel == null || this.form.indLevel == '') {\r\n        this.errmsgIndLevel = true;\r\n      } else {\r\n        this.errmsgIndLevel = false;\r\n      }\r\n      //验证币种\r\n      if (this.form.currency == null || this.form.currency == '' || this.form.currency == []) {\r\n        this.errmsgCurrency = true;\r\n      } else {\r\n        this.errmsgCurrency = false;\r\n      }\r\n      //验证频率\r\n      if (this.form.indFrequency == null || this.form.indFrequency == '' || this.form.indFrequency == []) {\r\n        this.errmsgFrequency = true;\r\n      } else {\r\n        this.errmsgFrequency = false;\r\n      }\r\n      //验证度量单位\r\n      if (this.form.indCalType == null || this.form.indCalType == '') {\r\n        this.errmsgIndCalType = true;\r\n      } else {\r\n        this.errmsgIndCalType = false;\r\n      }\r\n      //验证监管属性\r\n      if (this.form.indMonField == null || this.form.indMonField == '') {\r\n        this.errmsgIndMonField = true;\r\n      } else {\r\n        this.errmsgIndMonField = false;\r\n      }\r\n      //验证数据类型\r\n      if (this.form.indDataType == null || this.form.indDataType == '') {\r\n        this.errmsgIndDataType = true;\r\n      } else {\r\n        this.errmsgIndDataType = false;\r\n      }\r\n      //this.errmsgBizName\r\n      //验证指标名称\r\n      if (this.form.bizName == null || this.form.bizName == '') {\r\n        this.errmsgBizName = true;\r\n      } else {\r\n        this.errmsgBizName = false;\r\n      }\r\n      //验证指标定义\r\n      if (this.form.indDefinition == null || this.form.indDefinition == '') {\r\n        this.errmsgIndDefinition = true;\r\n        this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n      } else {\r\n        if (this.form.indDefinition.length > 500) {\r\n          this.errmsgIndDefinition = true;\r\n          this.errmsgIndDefinitionStr = '指标定义不能超过500字';\r\n        } else {\r\n          this.errmsgIndDefinition = false;\r\n          this.errmsgIndDefinitionStr = '指标定义不能为空';\r\n        }\r\n\r\n      }\r\n      if (this.form.indDefRule == null || this.form.indDefRule == '') {\r\n        this.indDefRuleErr = '指标口径规则不能为空'\r\n        this.errmsgIndDefRule = true\r\n      } else {\r\n        this.errmsgIndDefRule = false\r\n      }\r\n      if (this.errmsgIndDataType || this.errmsgIndMonField || this.errmsgIndCalType || this.errmsgFrequency\r\n          || this.errmsgCurrency || this.errmsgIndLevel || this.errmsgIndSecondType || this.errmsgIndFirstType || this.errmsgIeProp || this.errmsgBizName || this.errmsgIndDefinition || this.errmsgIndDefRule) {\r\n        return false;\r\n      }\r\n      this.$refs['form'].validate(valid => {\r\n        if (!valid) {\r\n          return;\r\n        }\r\n        this.crud.form.submitType = 2\r\n        if (!this.isSelfRule) {\r\n          var formulaFlag = this.checkFormulaExp(this.form.indDefRule);\r\n\r\n          if (!formulaFlag) {\r\n            this.indDefRuleErr = '指标口径规则错误！'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n          let formulaExp = this.setFormulaExp(this.form.indDefRule);\r\n          if (formulaExp == null) {\r\n            this.indDefRuleErr = '指标口径规则错误！'\r\n            this.errmsgIndDefRule = true\r\n            return false;\r\n          }\r\n          formulaExp = formulaExp.replaceAll(\"#\", \"[\");\r\n          let data = {\r\n            indDefRule: this.form.indDefRule,\r\n            indDefRuleExp: formulaExp,\r\n            indDefRuleStrs: this.indDefRuleStrs,\r\n            indDefRuleIds: this.indDefRuleIds\r\n          }\r\n          checkDefRule(data).then(res => {\r\n            if (res.code == 0) {\r\n              console.log(\"data===>\" + res.data)\r\n              this.indDefRuleErr = '指标口径规则不能为空'\r\n              this.errmsgIndDefRule = false\r\n\r\n              let title = '';\r\n              let message = '';\r\n              let oprType = 1;\r\n              if (this.crud.form.formType == 'add') {\r\n                title = '发起新增审批流程';\r\n                message = '请确认是否发起新增审批流程? ';\r\n                oprType = 1;\r\n              } else {\r\n                title = '发起修改审批流程';\r\n                message = '请确认是否发起修改审批流程? ';\r\n                oprType = 2;\r\n              }\r\n              this.openSignDialog(this.crud.form, oprType, title, message);\r\n\r\n              return true;\r\n            } else {\r\n              this.indDefRuleErr = res.msg\r\n              this.errmsgIndDefRule = true\r\n              return false;\r\n            }\r\n          });\r\n        } else {\r\n          let title = '';\r\n          let message = '';\r\n          let oprType = 1;\r\n          if (this.crud.form.formType == 'add') {\r\n            title = '发起新增审批流程';\r\n            message = '请确认是否发起新增审批流程? ';\r\n            oprType = 1;\r\n          } else {\r\n            title = '发起修改审批流程';\r\n            message = '请确认是否发起修改审批流程? ';\r\n            oprType = 2;\r\n          }\r\n          this.openSignDialog(this.crud.form, oprType, title, message);\r\n        }\r\n      });\r\n    },\r\n    endsWithStr(indDefRuleStr) {\r\n      return indDefRuleStr.trim().endsWith(\"+\") || indDefRuleStr.trim().endsWith(\"-\")\r\n          || indDefRuleStr.trim().endsWith(\"×\") || indDefRuleStr.trim().endsWith(\"/\");\r\n    },\r\n    beginWithStr(indDefRuleStr) {\r\n      return indDefRuleStr.trim().indexOf(\"+\") == 1 || indDefRuleStr.trim().indexOf(\"-\") == 1\r\n          || indDefRuleStr.trim().indexOf(\"×\") == 1 || indDefRuleStr.trim().indexOf(\"/\") == 1;\r\n    },\r\n    clearRuleVal() {\r\n      this.indDefRuleStr = '';\r\n      this.indDefRuleVal = '';\r\n      this.indDefRuleId = '';\r\n      this.indDefRuleStrs = [];\r\n      this.indDefRuleIds = [];\r\n      this.form.indDefRuleStr = '';\r\n      this.form.indDefRuleVal = '';\r\n      this.form.indDefRuleId = '';\r\n      this.form.indDefRule = '';\r\n      //this.hasCalc = true;\r\n      this.rules.indDefRule.required = true\r\n      /*if(this.indDefRuleStr == null || this.indDefRuleStr == '') {\r\n        if(this.form.indDefRule == null || this.form.indDefRule == '') {\r\n          this.errmsgIndDefRule = true\r\n        } else {\r\n          this.errmsgIndDefRule = false\r\n        }\r\n\r\n      } else {\r\n        this.errmsgIndDefRule = false\r\n      }*/\r\n      this.checkIndDefRule(this.form.indDefRule)\r\n    },\r\n    changeIsSelfRule(val) {\r\n      console.log(\"vvvvv=>\" + val)\r\n      //if(val) {\r\n      this.form.indDefRule = ''\r\n      this.indDefRuleStr = '';\r\n      this.indDefRuleVal = '';\r\n      this.indDefRuleId = '';\r\n      this.form.indDefRuleStr = '';\r\n      this.form.indDefRuleVal = '';\r\n      this.form.indDefRuleId = '';\r\n      //}\r\n    },\r\n    checkWarning(val, type) {\r\n      if (type == 'inner') {\r\n        if (val != null && (this.form.indInnerWarnFlg == null || this.form.indInnerWarnFlg == '')) {\r\n          this.innerwarningErrMsg = '请选择运算符';\r\n          this.errmsgInnerWarning = true;\r\n        } else if (val != null && (val.startsWith(\".\") || val == '.')) {\r\n          this.innerwarningErrMsg = '预警值不合法';\r\n          this.errmsgInnerWarning = true;\r\n        } else if ((val == null || val == '') && (this.form.indInnerWarnFlg != null && this.form.indInnerWarnFlg != '')) {\r\n          this.innerwarningErrMsg = '请输入预警值';\r\n          this.errmsgInnerWarning = true;\r\n        } else {\r\n          this.innerwarningErrMsg = '请选择运算符';\r\n          this.errmsgInnerWarning = false;\r\n        }\r\n\r\n      } else {\r\n        if (val != null && (this.form.indMonWarnFlg == null || this.form.indMonWarnFlg == '')) {\r\n          this.monwarningErrMsg = '请选择运算符';\r\n          this.errmsgMonWarning = true;\r\n        } else if (val != null && val.startsWith(\".\")) {\r\n          this.monwarningErrMsg = '预警值不合法';\r\n          this.errmsgMonWarning = true;\r\n        } else if ((val == null || val == '') && (this.form.indMonWarnFlg != null && this.form.indMonWarnFlg != '')) {\r\n          this.monwarningErrMsg = '请输入预警值';\r\n          this.errmsgMonWarning = true;\r\n        } else {\r\n          this.monwarningErrMsg = '请选择运算符';\r\n          this.errmsgMonWarning = false;\r\n        }\r\n      }\r\n    },\r\n    toAddAtomToMyClass() {\r\n      console.log('myCategoryId ===> ', this.form.categoryId)\r\n      if (this.form.categoryId == null || this.form.categoryId == 0) {\r\n        this.crud.notify('请选择分类', CRUD.NOTIFICATION_TYPE.ERROR)\r\n        return;\r\n      }\r\n      const _thisAtom = this.$refs.selectAtom\r\n      _thisAtom.selectAtomDialog = true\r\n      _thisAtom.myCategoryId = this.form.categoryId\r\n\r\n    },\r\n    refreshList() {\r\n      this.crud.refresh();\r\n    },\r\n    generatorUUID() {\r\n      return uuidv4();\r\n    },\r\n    getCurrentDept() {\r\n      getCurrentDept().then(res => {\r\n        console.log(\"dessss => \" + res)\r\n        this.form.businessDept = res.id\r\n      })\r\n    },\r\n    handleZoom() {\r\n      if (this.zoomDirection == 'left') {\r\n        this.categorySpan = 0;\r\n        this.tableSpan = 24;\r\n        this.zoomDirection = 'right';\r\n      } else {\r\n        this.categorySpan = 6;\r\n        this.tableSpan = 18;\r\n        this.zoomDirection = 'left';\r\n      }\r\n    },\r\n    checkFormulaExp(formulaStr) {\r\n      //公式前端校验\r\n      var formulaTmp = formulaStr.replaceAll(\" \", \"\");\r\n      do {\r\n        if (formulaTmp.lastIndexOf(\"[\") == -1 && formulaTmp.lastIndexOf(\"]\") == -1) {\r\n          continue\r\n        }\r\n        if (formulaTmp.lastIndexOf(\"]\") < (formulaTmp.length - 1)) {\r\n          var suf = formulaTmp.charAt(formulaTmp.lastIndexOf(\"]\") + 1);\r\n          if (suf != '+' && suf != '-' && suf != '*' && suf != '/' && suf != ')') {\r\n            return false;\r\n          }\r\n        }\r\n\r\n        if (formulaTmp.lastIndexOf(\"[\") > 0) {\r\n          var pre = formulaTmp.charAt(formulaTmp.lastIndexOf(\"[\") - 1);\r\n          if (pre != '+' && pre != '-' && pre != '*' && pre != '/' && pre != '(') {\r\n            return false;\r\n          }\r\n        }\r\n\r\n        formulaTmp = formulaTmp.replace(formulaTmp.substring(formulaTmp.lastIndexOf(\"[\"), formulaTmp.lastIndexOf(\"]\") + 1), \"1\")\r\n\r\n      } while (formulaTmp.lastIndexOf(\"]\") > 0);\r\n\r\n      return true;\r\n\r\n    },\r\n    setFormulaExp(formulaStr) {\r\n      var formulaExp = formulaStr;\r\n      do {\r\n        var pre = formulaExp.lastIndexOf(\"[\");\r\n        var suf = formulaExp.lastIndexOf(\"]\");\r\n\r\n        //指标名称\r\n        var indName = formulaExp.substring(pre, suf + 1);\r\n        var indKey = '';\r\n        //指标编码\r\n        var targetObj = this.transferData.filter(function (itemObj) {\r\n          return indName.indexOf(itemObj.label) >= 0;\r\n        })\r\n        if (targetObj[0] == null) {\r\n          if (pre != -1 && suf != -1) {\r\n            return null;\r\n          }\r\n          return '[]';\r\n        }\r\n        indKey = targetObj[0].key;\r\n        let indKeys = indKey.split(\",\");\r\n        let indId = indKeys[0];\r\n        let indCode = indKeys[3];\r\n        formulaExp = formulaExp.replace(indName, '#' + indCode + ';')\r\n\r\n      } while (formulaExp.lastIndexOf(\"]\") > 0);\r\n      return formulaExp;\r\n    }\r\n  }\r\n}\r\n",null]}