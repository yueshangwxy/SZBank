{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\myCollection\\myCollection.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\myCollection\\myCollection.vue","mtime":1652778847671},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      activeName: 'all',\r\n      tableData: [],\r\n      currentPage: 1,\r\n      pageSize: 9,\r\n      total: 50,\r\n      // 数据预览\r\n      dataPreVis: false,\r\n      preDataList: [],\r\n      preDataProp: [],\r\n      // 申请权限\r\n      authorityVis: false,\r\n      // 加入购物车参数\r\n      request: {\r\n        assetId: '',\r\n        beginTime: '',\r\n        endTime: '',\r\n      },\r\n      // 直接申请\r\n      directApplyVis: false,\r\n      daterange: '',\r\n      pickerOptions: {\r\n        disabledDate: (time) => {\r\n            let oneDay = 60*60*24*1000\r\n            return time.getTime() < Date.now() - oneDay;\r\n          }\r\n      },\r\n      radio: '2',\r\n      // 提示弹窗\r\n      tipDialog: false,\r\n    }\r\n  },\r\n  created() {\r\n    this.$api.queryMyCollection({\r\n      page: this.currentPage,\r\n      size: this.pageSize\r\n    }).then(res => {\r\n      this.tableData = res.data.records;\r\n      this.total = res.data.total;\r\n    })\r\n  },\r\n  methods: {\r\n    // tab切换\r\n    handleClick(tab, event) {\r\n      console.log(tab.name);\r\n      console.log(this.activeName);\r\n      this.currentPage = 1;\r\n      this.getFavoriteList();\r\n    },\r\n\r\n    //列表查询\r\n    getFavoriteList(){\r\n      if (this.activeName === 'all') {\r\n        this.$api.queryMyCollection({\r\n          page: this.currentPage,\r\n          size: this.pageSize,\r\n        }).then(res => {\r\n          this.tableData = res.data.records;\r\n          this.total = res.data.total;\r\n        })\r\n      } else if (this.activeName === 'table') {\r\n        this.$api.queryMyCollection({\r\n          page: this.currentPage,\r\n          size: this.pageSize,\r\n          assetType: 'table'\r\n        }).then(res => {\r\n          this.tableData = res.data.records;\r\n          this.total = res.data.total;\r\n        })\r\n      } else if (this.activeName === 'API') {\r\n        this.$api.queryMyCollection({\r\n          page: this.currentPage,\r\n          size: this.pageSize,\r\n          assetType: 'api'\r\n        }).then(res => {\r\n          this.tableData = res.data.records;\r\n          this.total = res.data.total;\r\n        })\r\n      } else if (this.activeName === 'target') {\r\n        this.$api.queryMyCollection({\r\n          page: this.currentPage,\r\n          size: this.pageSize,\r\n          assetType: 'target'\r\n        }).then(res => {\r\n          this.tableData = res.data.records;\r\n          this.total = res.data.total;\r\n        })\r\n      } else if (this.activeName === 'label') {\r\n        this.$api.queryMyCollection({\r\n          page: this.currentPage,\r\n          size: this.pageSize,\r\n          assetType: 'label'\r\n        }).then(res => {\r\n          this.tableData = res.data.records;\r\n          this.total = res.data.total;\r\n        })\r\n      }\r\n    },\r\n    // 分页\r\n    handleCurrentChange(val) {\r\n      this.currentPage = val;\r\n      this.getFavoriteList();\r\n      console.log(`当前页: ${val}`);\r\n    },\r\n    // 详情查看\r\n    viewDetails(type, item) {\r\n      this.$router.push({\r\n        path: \"/detailsView/\" + item.assetType,\r\n        query: {\r\n          id: item.id,\r\n        },\r\n      });\r\n    },\r\n    // 删除收藏\r\n    delFavorite(item) {\r\n      this.$api.delFavorite({\r\n        assetId: item.id,\r\n      }).then(res => {\r\n        this.$message.success('取消收藏成功!')\r\n        this.getFavoriteList()\r\n      })\r\n    },\r\n    // 数据预览\r\n    previewData(item) {\r\n      this.preDataProp = []\r\n      this.preDataList = []\r\n      this.dataPreVis = true;\r\n      this.$api.previewTableData({name: item.tableName}).then(res => {\r\n        console.log(res,333);\r\n        this.preDataProp = res.data.columns\r\n        this.preDataList = res.data.dataList\r\n\r\n      })\r\n    },\r\n    // 申请访问\r\n    applyForAccess(item) {\r\n      this.$api.applyForAccess({\r\n        apiId: item.id\r\n      }).then(res => {\r\n        if(res.code==0 || res.code==200) {\r\n          this.$message.success(res.msg)\r\n          this.getFavoriteList();\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      })\r\n    },\r\n    // 申请权限\r\n    applyForAuthority(item) {\r\n      this.directApplyVis = true\r\n      this.daterange = ''\r\n      this.request.tableId = item.id\r\n    },\r\n    // 加入购物车\r\n    addShopCar() {\r\n      console.log(this.request);\r\n      this.$api.addShopCar(this.request).then((res) => {\r\n        console.log(res);\r\n        this.authorityVis = false\r\n        if(res.code==999) {\r\n          this.$message.warning(res.msg)\r\n        } else if(res.code==200 || res.code==0){\r\n          this.$message.success(res.msg)\r\n        }\r\n      })\r\n    },\r\n    // 直接申请\r\n    directApply() {\r\n      this.authorityVis = false;\r\n      // 直接申请权限接口\r\n      let list = [this.request]\r\n      console.log(list);\r\n      this.$api.applyForAuthority({\r\n        list: list\r\n      }).then((res) => {\r\n        console.log(res);\r\n        this.tipDialog = true;\r\n      })\r\n          .then(() => {\r\n            this.getFavoriteList()\r\n            // 提示框展示三秒自动关闭\r\n            setTimeout(() => {\r\n              this.tipDialog = false;\r\n            }, 3000);\r\n          });\r\n    },\r\n    // 确定申请\r\n    confirmApply() {\r\n      // 关闭当前弹窗\r\n      if(this.radio==='2') {\r\n        this.request.beginTime = ''\r\n        this.request.endTime = ''\r\n        this.directApplyVis = false;\r\n        // 打开申请权限方式弹窗\r\n        this.authorityVis = true\r\n      } else {\r\n        if(this.daterange.length<1) {\r\n          this.$message.error('请选择时间')\r\n        }else {\r\n          this.directApplyVis = false\r\n          // 打开申请权限方式弹窗\r\n          this.authorityVis = true\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",null]}