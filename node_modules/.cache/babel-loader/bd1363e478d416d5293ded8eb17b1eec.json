{"remainingRequest":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform\\Pncui-Ind\\src\\views\\indicators\\dimension\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\src\\views\\indicators\\dimension\\index.vue","mtime":1647932070352},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647917124586},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1647917124178},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647917124586},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1647917137429}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/code/DataAssetPlatform/Pncui-Ind/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"D:/code/DataAssetPlatform/Pncui-Ind/node_modules/@babel/runtime/helpers/typeof\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.weak-map\");\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es7.array.includes\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"D:/code/DataAssetPlatform/Pncui-Ind/node_modules/@babel/runtime/helpers/defineProperty\"));\n\nvar _indClassification = _interopRequireWildcard(require(\"@/api/indicators/indClassification\"));\n\nvar _indDimInfo = _interopRequireWildcard(require(\"@/api/indicators/indDimInfo\"));\n\nvar _indDimValue = _interopRequireWildcard(require(\"@/api/indicators/indDimValue\"));\n\nvar _crud = _interopRequireWildcard(require(\"@crud/crud\"));\n\nvar _RR = _interopRequireDefault(require(\"@crud/RR.operation\"));\n\nvar _CRUD = _interopRequireDefault(require(\"@crud/CRUD.operation\"));\n\nvar _UD = _interopRequireDefault(require(\"@crud/UD.operation\"));\n\nvar _Pagination = _interopRequireDefault(require(\"@crud/Pagination\"));\n\nvar _indDimension = require(\"@/api/indicators/indDimension\");\n\nvar _indDataTable = require(\"@datasource/api/datasources/indDataTable\");\n\nvar _indDataColumn = require(\"@datasource/api/datasources/indDataColumn\");\n\nvar _dimData = _interopRequireDefault(require(\"../dimension/dimData\"));\n\nvar _dimCategoryNew = _interopRequireDefault(require(\"../category/dimCategoryNew\"));\n\nvar _indTenant = require(\"@/api/indUserApply/indTenant\");\n\nvar _validator = require(\"@/utils/validator\");\n\nvar _methods;\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n// crud交由presenter持有\nvar defaultCrud = (0, _crud.default)({\n  title: '维度值管理',\n  url: _indDimValue.default.url,\n  sort: 'id,desc',\n  crudMethod: _objectSpread({}, _indDimValue.default.method)\n});\nvar defaultForm = {\n  id: null,\n  dimInfoId: null,\n  lastLevelDimValueId: null,\n  dimValueName: null,\n  dimValueLevel: null,\n  crtUserCode: null,\n  crtOrgCode: null,\n  crtDate: null,\n  updUserCode: null,\n  updOrgCode: null,\n  updDate: null\n};\nvar _default = {\n  name: 'IndClassification',\n  components: {\n    pagination: _Pagination.default,\n    crudOperation: _CRUD.default,\n    rrOperation: _RR.default,\n    udOperation: _UD.default,\n    dimData: _dimData.default,\n    dimCategory: _dimCategoryNew.default\n  },\n  mixins: [(0, _crud.presenter)(defaultCrud), (0, _crud.header)(), (0, _crud.form)(defaultForm), (0, _crud.crud)()],\n  dicts: ['DIMENSION_CATEGORY', 'DIMENSION', 'LAST_LEVEL_DIMENSION_VALUE'],\n  data: function data() {\n    return {\n      table: {\n        columns: {\n          id: 'hidden',\n          datasourceId: 'hidden',\n          nameColumn: 'hidden',\n          nameColumnDesc: 'hidden',\n          codeColumn: 'hidden',\n          codeColumnDesc: 'hidden',\n          alias: 'hidden',\n          pkFlag: 'hidden',\n          filterColumn: 'hidden',\n          filterValue: 'hidden'\n        }\n      },\n      tableData: [],\n      tableInfo: [],\n      tableDB: [],\n      DictDB: [],\n      selectData: [],\n      screenData: [],\n      showDimInfo: false,\n      permission: {\n        add: ['admin', 'indDimension:add'],\n        edit: ['admin', 'indDimension:edit'],\n        del: ['admin', 'indDimension:del'],\n        showAllDimCode: ['admin', 'indDimension:showAllDimCode'],\n        details: ['admin', 'indDimension:details']\n      },\n      rules: {\n        dimCode: [{\n          required: true,\n          message: '维度编号不能为空',\n          trigger: 'blur'\n        }],\n        dimName: [{\n          required: true,\n          message: '维度名称不能为空',\n          trigger: 'blur'\n        }],\n        tableName: [{\n          required: true,\n          message: '维表表名称不能为空',\n          trigger: 'blur'\n        }],\n        codeColumn: [{\n          required: true,\n          message: '代码字段不能为空',\n          trigger: 'blur'\n        }],\n        codeColumnDesc: [{\n          required: true,\n          message: '代码字段描述不能为空',\n          trigger: 'blur'\n        }],\n        nameColumn: [{\n          required: true,\n          message: '显示字段不能为空',\n          trigger: 'blur'\n        }],\n        nameColumnDesc: [{\n          required: true,\n          message: '显示字段描述不能为空',\n          trigger: 'blur'\n        }]\n      },\n      showIndDimensionAdd: false,\n      category: {\n        id: null,\n        categoryName: null,\n        //分类名称\n        tenant: null\n      },\n      dimension: {\n        id: null,\n        classificationId: null,\n        // 所属分类\n        categoryName: null,\n        // 指标维度名称\n        remarks: null,\n        // 备注\n        tenant: null //租户 法人\n\n      },\n      dimensionRules: {\n        categoryName: [{\n          max: 50,\n          message: '指标维度名称长度不能超过50字',\n          trigger: ['blur', 'change']\n        }, {\n          required: true,\n          message: '指标维度名称不能为空',\n          trigger: 'blur'\n        }, {\n          validator: _validator.validateStrLenHundred,\n          trigger: 'blur'\n        }],\n        classificationId: [{\n          required: true,\n          message: '请选择所属分类',\n          trigger: 'change'\n        }],\n        remarks: [{\n          max: 200,\n          message: '备注长度不能超过200字',\n          trigger: ['blur', 'change']\n        }],\n        tenant: [{\n          required: true,\n          message: '所属租户不能为空',\n          trigger: 'blur'\n        }]\n      },\n      showIndDimensionValueAdd: false,\n      dimensionValue: {\n        id: null,\n        dimInfoId: null,\n        // 所属维度\n        lastLevelDimValueId: null,\n        // 上级维度值\n        categoryName: null,\n        // 指标维度值\n        dimLevel: null // 维度树层级\n\n      },\n      dimensionValueRules: {\n        categoryName: [{\n          required: true,\n          message: '指标维度值不能为空',\n          trigger: 'blur'\n        }, {\n          validator: _validator.validateStrLenHalfHundred,\n          trigger: 'blur'\n        }]\n      },\n      categoryRules: {\n        categoryName: [{\n          max: 10,\n          message: '指标维度分类名称长度不能超过10字',\n          trigger: ['blur', 'change']\n        }, {\n          required: true,\n          message: '指标维度分类名称不能为空',\n          trigger: 'blur'\n        }],\n        tenant: [{\n          required: true,\n          message: '所属租户不能为空',\n          trigger: 'blur'\n        }]\n      },\n      indDimensionDialog: '指标维度名称-新增',\n      indDimensionValueDialog: '指标维度值-新增',\n      indDimensionCateDialog: '指标维度分类-新增',\n      showIndDimensionCateAdd: false,\n      classificationArr: [],\n      dimInfoArr: [],\n      dimValueArr: [],\n      lastLevelDimValueFlag: false,\n      dimLevel: null,\n      dimTreeInfoChildren: null,\n      dimTreeValueName: null,\n      //层级树 维度值名称\n      dimTreeValueInfoId: null,\n      //层级树 维度值的维度id\n      dimTreeValueLastLevelId: null,\n      ////层级树 维度值 上级维度值id\n      dimTreeValueId: null,\n      ////层级树 维度值id\n      dimTreeValueChildren: null,\n      buttonTreeData: null,\n      //点击\n      superAdminFlag: false,\n      tenantArr: [],\n      categorySpan: 7,\n      tableSpan: 17,\n      zoomDirection: 'left'\n    };\n  },\n  created: function created() {\n    this.superAdminFlag = (0, _indTenant.isSuperAdmin)(); // this.$nextTick(() => {\n    //   getAllSource().then(data => {\n    //   // console.log(\"=====getAllSource====>>>>\",data)\n    //     if (data.code === 0) {\n    //       this.tableDB = data.data\n    //     } else {\n    //       this.$message.error({\n    //         message: '获取数据失败'\n    //       })\n    //     }\n    //   })\n    //   getTableListById('all').then(data => {\n    //     if (data.code === 0) {\n    //       this.DictDB = data.data\n    //     } else {\n    //       this.$message.error({\n    //         message: '获取数据失败'\n    //       })\n    //     }\n    //   })\n    // })\n\n    this.initTreeData();\n    this.crud.optShow.del = false;\n    this.crud.optShow.add = false;\n    this.resetQuery();\n  },\n  methods: (_methods = {\n    resetQuery: function resetQuery() {\n      this.crud.resetQuery(false);\n      this.crud.refresh();\n    },\n    initTreeData: function initTreeData() {\n      var _this2 = this;\n\n      //获取所有维度分类树\n      (0, _indClassification.getClassificationsTree)({\n        size: 500,\n        page: 0\n      }).then(function (data) {\n        _this2.$refs.dimCategory.treeData = data.dataTree;\n        _this2.classificationArr = data.classArr;\n      });\n      (0, _indDimInfo.getDimInfos)({\n        size: 500,\n        page: 0\n      }).then(function (data) {\n        _this2.dimInfoArr = data.data.records;\n      });\n      (0, _indDimValue.getDimValues)({\n        size: 800,\n        page: 0\n      }).then(function (data) {\n        _this2.dimValueArr = data.data.records;\n      });\n      (0, _indTenant.getTenants)().then(function (data) {\n        if (data != null && data.code == '0000') {\n          _this2.tenantArr = data.data;\n        }\n      });\n    }\n  }, (0, _defineProperty2.default)(_methods, _crud.default.HOOK.beforeRefresh, function () {\n    return true;\n  }), (0, _defineProperty2.default)(_methods, _crud.default.HOOK.beforeToAdd, function () {\n    var _this3 = this;\n\n    this.tableData = [];\n    this.tableInfo = [];\n    this.form.datasourceId = 'local';\n    (0, _indDataTable.getTableListById)(this.form.datasourceId).then(function (data) {\n      if (data.code === 0) {\n        _this3.tableData = data.data;\n      } else {\n        _this3.clearFrom();\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, _crud.default.HOOK.beforeToEdit, function () {\n    var _this4 = this;\n\n    (0, _indDataTable.getTableListById)(this.form.datasourceId).then(function (data) {\n      // console.log(\"====getTables====>>>>>\",data)\n      if (data.code === 0) {\n        _this4.tableData = data.data;\n      } else {\n        _this4.tableData = [];\n      }\n    });\n    (0, _indDataColumn.getColumnListByDataSourceIdAndTableName)(this.form.datasourceId, this.form.tableName).then(function (data) {\n      // console.log(\"========getColumns====>>>>\",data)\n      if (data.code === 0) {\n        if (data.data.length === 0) {\n          _this4.$message.error({\n            message: '表' + _this4.form.tableName + '不存在'\n          });\n        }\n\n        _this4.tableInfo = data.data;\n      } else {\n        _this4.tableInfo = [];\n      }\n    });\n\n    if (this.form.filterColumn !== null && this.form.filterColumn !== '') {\n      var temp = this.form.filterValue;\n      var tempArray = [];\n\n      if (temp !== null && temp !== '' && temp.indexOf(',') !== -1) {\n        tempArray = temp.split(',');\n      } else if (temp !== null && temp !== '') {\n        tempArray.push(temp);\n      }\n\n      this.form.filterValue = tempArray;\n      (0, _indDimension.getValueListByTableAndColumn)(this.form.tableName, this.form.filterColumn, this.form.datasourceId).then(function (data) {\n        if (data.code === 0) {\n          _this4.screenData = data.data;\n        } else {\n          _this4.$message.error({\n            message: '表' + _this4.form.tableName + '或列' + _this4.form.filterColumn + '不存在'\n          });\n        }\n      });\n    }\n  }), (0, _defineProperty2.default)(_methods, _crud.default.HOOK.beforeSubmit, function () {\n    if (this.form.filterValue !== null && this.form.filterValue !== '') {\n      this.form.filterValue = String(this.form.filterValue);\n    }\n  }), (0, _defineProperty2.default)(_methods, \"getTableInfo\", function getTableInfo() {\n    var _this5 = this;\n\n    this.form.nameColumn = '';\n    this.form.nameColumnDesc = '';\n    this.form.codeColumn = '';\n    this.form.codeColumnDesc = '';\n    this.form.filterColumn = '';\n    this.form.filterValue = '';\n    (0, _indDataColumn.getColumnListByDataSourceIdAndTableName)(this.form.datasourceId, this.form.tableName).then(function (data) {\n      // console.log(\"========getColumns====>>>>\",data)\n      if (data.code === 0) {\n        if (data.data.length === 0) {\n          _this5.$message.error({\n            message: '表' + _this5.form.tableName + '不存在'\n          });\n        }\n\n        _this5.tableInfo = data.data;\n      } else {\n        _this5.tableInfo = [];\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"getListData\", function getListData() {\n    var _this6 = this;\n\n    this.form.filterValue = '';\n\n    if (this.form.filterColumn !== null && this.form.filterColumn !== '') {\n      (0, _indDimension.getValueListByTableAndColumn)(this.form.tableName, this.form.filterColumn, this.form.datasourceId).then(function (data) {\n        if (data.code === 0) {\n          _this6.screenData = data.data;\n        } else {\n          _this6.$message.error({\n            message: '表' + _this6.form.tableName + '或列' + _this6.form.filterColumn + '不存在'\n          });\n        }\n      });\n    }\n  }), (0, _defineProperty2.default)(_methods, \"setColumnDesc\", function setColumnDesc() {\n    var _this7 = this;\n\n    this.tableInfo.forEach(function (row) {\n      if (_this7.form.nameColumn === row.columnName) {\n        _this7.form.nameColumnDesc = row.columnDesc;\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"setCodeDesc\", function setCodeDesc() {\n    var _this8 = this;\n\n    this.tableInfo.forEach(function (row) {\n      if (_this8.form.codeColumn === row.columnName) {\n        _this8.form.codeColumnDesc = row.columnDesc;\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"getTableByDB\", function getTableByDB() {\n    var _this9 = this;\n\n    this.clearFrom();\n    (0, _indDataTable.getTableListById)(this.form.datasourceId).then(function (data) {\n      if (data.code === 0) {\n        _this9.tableData = data.data;\n      } else {\n        _this9.clearFrom();\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"clearFrom\", function clearFrom() {\n    this.form.nameColumn = '';\n    this.form.nameColumnDesc = '';\n    this.form.tableName = '';\n    this.form.codeColumn = '';\n    this.form.codeColumnDesc = '';\n    this.form.filterColumn = '';\n    this.form.filterValue = '';\n    this.tableData = [];\n    this.tableInfo = [];\n  }), (0, _defineProperty2.default)(_methods, \"formatId\", function formatId(row) {\n    var name = '';\n    this.tableDB.forEach(function (row1) {\n      if (row1.id === row.datasourceId) {\n        name = row1.datasourceName;\n      }\n    });\n    return name;\n  }), (0, _defineProperty2.default)(_methods, \"formatTableName\", function formatTableName(row) {\n    var name = '';\n    this.DictDB.forEach(function (row1) {\n      if (row1.tableName === row.tableName) {\n        name = row1.tableDesc;\n      }\n    });\n    return name;\n  }), (0, _defineProperty2.default)(_methods, \"handleInfo\", function handleInfo(row) {\n    this.form.id = row.id;\n    this.form.dimCode = row.dimCode;\n    this.form.datasourceId = row.datasourceId;\n    this.form.dimName = row.dimName;\n    this.form.tableName = row.tableName;\n    this.form.codeColumn = row.codeColumn;\n    this.form.codeColumnDesc = row.codeColumnDesc;\n    this.form.nameColumn = row.nameColumn;\n    this.form.nameColumnDesc = row.nameColumnDesc;\n    this.form.pid = row.pid;\n    this.form.dimLevel = row.dimLevel;\n    this.form.filterColumn = row.filterColumn;\n    this.form.filterValue = row.filterValue;\n    this.form.alias = row.alias;\n    this.form.pkFlag = row.pkFlag;\n    this.form.crtUserCode = row.crtUserCode;\n    this.form.crtOrgCode = row.crtOrgCode;\n    this.form.crtDate = this.parseTime(row.crtDate);\n    this.form.updUserCode = row.updUserCode;\n    this.form.updOrgCode = row.updOrgCode;\n    this.form.updDate = this.parseTime(row.updDate);\n    this.showDimInfo = true;\n  }), (0, _defineProperty2.default)(_methods, \"showAllDimCode\", function showAllDimCode(data) {\n    console.log(\"========showAllDimCode====>>>>\", data);\n    var _this = this.$refs.dimData;\n    _this.query.tableName = data.tableName;\n    _this.query.columnDimCode = data.dimCode;\n    _this.query.columnDimName = data.dimName;\n    _this.query.columnCodeColumn = data.codeColumn;\n    _this.query.columnNameColumn = data.nameColumn;\n    _this.query.columnDimLevel = data.dimLevel;\n    _this.query.columnFilterColumn = data.filterColumn;\n    _this.query.columnPid = data.pid;\n    _this.tCode = data.codeColumnDesc;\n    _this.tName = data.nameColumnDesc;\n    var temp = String(data.filterValue);\n    _this.query.queryFilter = temp;\n\n    if (temp !== null && temp !== '' && temp.indexOf(',') !== -1) {\n      _this.filterValue = temp.split(',');\n    } else {\n      _this.filterValue.push(temp);\n    }\n\n    _this.searchDimData();\n\n    _this.showAllDim = true;\n  }), (0, _defineProperty2.default)(_methods, \"handleCategoryClick\", function handleCategoryClick(data) {\n    console.log(\"handleCategoryClick =========== \" + data);\n    this.dimLevel = data.dimLevel;\n    this.buttonTreeData = data;\n\n    if (data.dimLevel == 0) {\n      this.query.dimInfoId = null;\n      this.query.treeLevel = data.dimLevel;\n      this.query.tenant = data.tenant;\n      defaultCrud.toQuery();\n    } else if (data.dimLevel == 1) {\n      this.dimension.classificationId = data.id;\n    } else if (data.dimLevel == 2) {\n      //用来配置维度值\n      this.dimensionValue.dimInfoId = data.id;\n      this.dimensionValue.id = null;\n      this.dimTreeInfoChildren = data.children; //用来修改维度赋值\n\n      this.dimension.categoryName = data.categoryName;\n      this.dimension.id = data.id;\n      this.dimension.classificationId = data.classificationId;\n      this.dimension.remarks = data.remarks;\n    } else if (data.dimLevel == 3 || data.dimLevel == 4 || data.dimLevel == 5) {\n      this.dimTreeValueName = data.categoryName;\n      this.dimTreeValueInfoId = data.dimInfoId;\n      this.dimTreeValueLastLevelId = data.lastLevelDimValueId;\n      this.dimTreeValueId = data.id;\n      this.dimTreeValueChildren = data.children;\n      /*\r\n      this.lastLevelDimValueFlag = data.dimLevel == 3;\r\n      this.dimensionValue.categoryName = data.categoryName\r\n      this.dimensionValue.id = data.id\r\n      this.dimensionValue.dimInfoId = data.dimInfoId\r\n      this.dimensionValue.lastLevelDimValueId = data.lastLevelDimValueId\r\n      this.dimensionValue.dimLevel = data.dimLevel\r\n      */\n    }\n\n    if (data.dimLevel == 1 || data.dimLevel == 2 || data.dimLevel == 5) {\n      this.query.treeLevel = data.dimLevel;\n      this.query.treeId = data.id;\n      this.query.dimInfoId = data.id;\n      defaultCrud.toQuery();\n    } else if (data.dimLevel == 3 || data.dimLevel == 4) {\n      this.query.treeLevel = data.dimLevel;\n      this.query.treeId = data.id;\n      this.query.dimInfoId = data.id;\n      defaultCrud.toQuery();\n    }\n  }), (0, _defineProperty2.default)(_methods, \"closeIndDimensionAddDialog\", function closeIndDimensionAddDialog() {\n    this.showIndDimensionAdd = false;\n  }), (0, _defineProperty2.default)(_methods, \"commitDim\", function commitDim() {\n    var _this10 = this;\n\n    this.crud.findVM('form').$refs['form'].validate(function (valid) {\n      if (!valid) {\n        return;\n      }\n\n      if (_this10.dimension.id == null) {\n        _indDimInfo.default.crud.add(_this10.dimension).then(function (data) {\n          if (data.code && data.code !== 0) {\n            _this10.$notify({\n              title: data.msg,\n              type: 'error',\n              duration: 2500\n            }); //this.showIndDimensionAdd = false\n\n          } else {\n            _this10.$notify({\n              title: '新增成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this10.initTreeData();\n\n            _this10.showIndDimensionAdd = false;\n          }\n        });\n      } else {\n        _indDimInfo.default.crud.edit(_this10.dimension).then(function (data) {\n          if (data.code && data.code !== 0) {\n            _this10.$notify({\n              title: data.msg,\n              type: 'error',\n              duration: 2500\n            }); // this.showIndDimensionAdd = false\n\n          } else {\n            _this10.$notify({\n              title: '编辑成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this10.initTreeData();\n\n            _this10.showIndDimensionAdd = false;\n          }\n        });\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"closeIndDimensionValueAddDialog\", function closeIndDimensionValueAddDialog() {\n    this.showIndDimensionValueAdd = false;\n  }), (0, _defineProperty2.default)(_methods, \"commitDimValue\", function commitDimValue() {\n    var _this11 = this;\n\n    this.crud.findVM('form').$refs['form'].validate(function (valid) {\n      if (!valid) {\n        return;\n      }\n\n      if (_this11.dimensionValue.id == null) {\n        _indDimValue.default.crud.add(_this11.dimensionValue).then(function (data) {\n          if (data.code && data.code !== 0) {\n            _this11.$notify({\n              title: data.msg,\n              type: 'error',\n              duration: 2500\n            }); //this.showIndDimensionValueAdd = false\n\n          } else {\n            _this11.$notify({\n              title: '新增成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this11.initTreeData();\n\n            _this11.showIndDimensionValueAdd = false;\n            defaultCrud.toQuery();\n          }\n        });\n      } else {\n        _indDimValue.default.crud.edit(_this11.dimensionValue).then(function (data) {\n          if (data.code && data.code !== 0) {\n            _this11.$notify({\n              title: data.msg,\n              type: 'error',\n              duration: 2500\n            });\n\n            _this11.showIndDimensionValueAdd = false;\n          } else {\n            _this11.$notify({\n              title: '编辑成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this11.initTreeData();\n\n            _this11.showIndDimensionValueAdd = false;\n            defaultCrud.toQuery();\n          }\n        });\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"addDimension\", function addDimension(data) {\n    if (data.dimLevel == 0) {\n      // 新增分类\n      //置空输入项\n      this.category.categoryName = null;\n      this.category.tenant = data.id;\n      this.category.id = null;\n      this.indDimensionCateDialog = '指标维度分类-新增';\n      this.showIndDimensionCateAdd = true;\n    } else if (data.dimLevel == 1) {\n      //新增维度\n      this.indDimensionDialog = '指标维度名称-新增';\n      this.dimension.categoryName = null;\n      this.dimension.tenant = data.tenant;\n      this.dimension.remarks = null;\n      this.dimension.id = null;\n      this.showIndDimensionAdd = true;\n    } else if (data.dimLevel == 2) {\n      //新增维度值\n      this.indDimensionValueDialog = '指标维度值-新增'; // this.dimensionValue.dimInfoId = data.id\n\n      this.dimensionValue.categoryName = null;\n      this.dimensionValue.dimLevel = null;\n      this.dimensionValue.lastLevelDimValueId = null;\n      this.dimensionValue.id = null;\n      this.showIndDimensionValueAdd = true;\n      this.lastLevelDimValueFlag = true;\n    } else if (data.dimLevel > 2) {\n      this.indDimensionValueDialog = '指标维度值-新增';\n      this.dimensionValue.categoryName = null;\n      this.dimensionValue.dimInfoId = data.dimInfoId;\n      this.dimensionValue.dimLevel = data.dimLevel + 1;\n      this.dimensionValue.lastLevelDimValueId = data.id;\n      this.dimensionValue.id = null;\n      this.showIndDimensionValueAdd = true;\n      this.lastLevelDimValueFlag = true;\n    }\n    /*if (data.categoryName === '维度分类') {\r\n      //置空输入项\r\n      this.category.categoryName = null\r\n      this.category.tenant = null\r\n      this.category.id = null\r\n      this.indDimensionCateDialog = '指标维度分类-新增'\r\n      this.showIndDimensionCateAdd = true\r\n    } else if (data.dimLevel == 1 || this.dimLevel == 1 || this.dimLevel == 2) {\r\n      // this.dimension.classificationId = data.id\r\n      if (this.dimension.id != null && this.dimLevel == 2) {\r\n        this.indDimensionDialog = '指标维度名称-修改'\r\n        this.showIndDimensionAdd = true\r\n      } else {\r\n        this.indDimensionDialog = '指标维度名称-新增'\r\n        this.dimension.categoryName = null\r\n        this.dimension.tenant = null\r\n        this.dimension.remarks = null\r\n        this.dimension.id = null\r\n        this.showIndDimensionAdd = true\r\n      }\r\n    }*/\n\n  }), (0, _defineProperty2.default)(_methods, \"addDimensionInfo\", function addDimensionInfo(data) {\n    if (this.dimLevel == 2) {\n      if (this.dimTreeInfoChildren != null && this.dimTreeInfoChildren.length > 0) {\n        this.$message({\n          type: 'error',\n          message: '该维度有子节点，不能修改！'\n        });\n      } else {\n        this.indDimensionDialog = '指标维度名称-修改';\n        /*this.dimension.categoryName = null\r\n        this.dimension.tenant = null\r\n        this.dimension.remarks = null\r\n        this.dimension.id = null*/\n\n        this.showIndDimensionAdd = true;\n      }\n    } else {\n      this.$message({\n        type: 'error',\n        message: '请选择分类！'\n      });\n    }\n  }), (0, _defineProperty2.default)(_methods, \"addDimensionValue\", function addDimensionValue(data) {\n    if (this.dimLevel == 3 || this.dimLevel == 4 || this.dimLevel == 5) {\n      if (this.dimTreeValueChildren != null && this.dimTreeValueChildren.length > 0) {\n        this.$message({\n          type: 'error',\n          message: '该维度值有子节点，不能修改！'\n        });\n      } else {\n        this.indDimensionValueDialog = '维度值-修改';\n        this.dimensionValue.categoryName = this.dimTreeValueName;\n        this.dimensionValue.dimInfoId = this.dimTreeValueInfoId; //this.dimensionValue.dimLevel = data.dimLevel + 1;\n\n        this.dimensionValue.lastLevelDimValueId = this.dimTreeValueLastLevelId;\n        this.dimensionValue.id = this.dimTreeValueId;\n        this.showIndDimensionValueAdd = true;\n        this.lastLevelDimValueFlag = false;\n      }\n      /*     this.dimTreeValueName = data.categoryName;\r\n           this.dimTreeValueInfoId = data.dimInfoId;\r\n           this.dimTreeValueLastLevelId = data.lastLevelDimValueId;\r\n           this.dimTreeValueId = data.id;*/\n\n    } else {\n      this.$message({\n        type: 'error',\n        message: '请选择维度值！'\n      });\n    }\n    /*    if (data.dimLevel > 2 || this.dimLevel == 2) {\r\n            this.indDimensionValueDialog = '维度值-新增'\r\n            // this.dimensionValue.dimInfoId = data.id\r\n            this.dimensionValue.categoryName = null\r\n            this.dimensionValue.dimLevel = null\r\n            this.dimensionValue.lastLevelDimValueId = null\r\n            this.dimensionValue.id = null\r\n            this.showIndDimensionValueAdd = true\r\n            this.lastLevelDimValueFlag = true\r\n          } else if (data.dimLevel == 3 || data.dimLevel == 4 || this.dimLevel == 3 || this.dimLevel == 4 || this.dimLevel == 5) {\r\n            this.indDimensionValueDialog = '维度值-修改'\r\n            this.showIndDimensionValueAdd = true\r\n          }*/\n\n  }), (0, _defineProperty2.default)(_methods, \"handleRemove\", function handleRemove(data) {\n    var _this12 = this;\n\n    //处理删除，level为1表示指标维度分类的操作\n    if (data.dimLevel == 1) {\n      var $this = this;\n      this.$confirm('确定要删除该节点吗?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        if (data.children.length === 0) {\n          _indClassification.default.crud.del([data.id]).then(function (res) {\n            if (res.code !== 0) {\n              $this.$message({\n                type: 'error',\n                message: '删除失败,' + res.msg\n              });\n            } else {\n              $this.$message({\n                type: 'success',\n                message: '删除成功 '\n              });\n\n              _this12.initTreeData();\n            }\n          }).catch(function () {\n            $this.$message({\n              type: 'error',\n              message: '删除失败 '\n            });\n          });\n        } else {\n          $this.$message({\n            type: 'error',\n            message: '该分类已被引用，不可删除'\n          });\n        }\n      });\n    } else if (data.dimLevel == 2) {\n      var _$this = this;\n\n      this.$confirm('确定要删除该节点吗?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        if (data.children.length === 0) {\n          _indDimInfo.default.crud.del([data.id]).then(function (res) {\n            if (res.code !== 0) {\n              _$this.$message({\n                type: 'error',\n                message: '删除失败,' + res.msg\n              });\n            } else {\n              _$this.$message({\n                type: 'success',\n                message: '删除成功 '\n              });\n\n              _this12.initTreeData();\n            }\n          }).catch(function () {\n            _$this.$message({\n              type: 'error',\n              message: '删除失败 '\n            });\n          });\n        } else {\n          _$this.$message({\n            type: 'error',\n            message: '当前节点下有子节点，不能删除'\n          });\n        }\n      });\n    } else if (data.dimLevel == 3 || data.dimLevel == 4 || data.dimLevel == 5) {\n      var _$this2 = this;\n\n      this.$confirm('确定要删除该节点吗?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _indDimValue.default.crud.del([data.id]).then(function (res) {\n          if (res.code !== 0) {\n            _$this2.$message({\n              type: 'error',\n              message: '删除失败,' + res.msg\n            });\n          } else {\n            _$this2.$message({\n              type: 'success',\n              message: '删除成功 '\n            });\n\n            _this12.initTreeData();\n\n            defaultCrud.toQuery();\n          }\n        }).catch(function () {\n          _$this2.$message({\n            type: 'error',\n            message: '删除失败 '\n          });\n        });\n      });\n    }\n  }), (0, _defineProperty2.default)(_methods, \"handleEdit\", function handleEdit(data) {\n    if (data.children != null && data.children.length > 0) {\n      this.$message({\n        type: 'error',\n        message: '该维度值有子节点，不能修改！'\n      });\n      return;\n    }\n\n    if (data.dimLevel == 1) {\n      this.indDimensionCateDialog = '指标维度分类名称-修改';\n      this.category.categoryName = data.categoryName;\n      this.category.tenant = data.tenant;\n      this.category.id = data.id;\n      this.showIndDimensionCateAdd = true;\n    } else if (data.dimLevel == 2) {\n      this.indDimensionDialog = '指标维度名称-修改';\n      this.dimension.categoryName = data.categoryName;\n      this.dimension.tenant = data.tenant;\n      this.dimension.id = data.id;\n      this.dimension.classificationId = data.classificationId;\n      this.dimension.remarks = data.remarks;\n      this.showIndDimensionAdd = true;\n    } else if (data.dimLevel >= 3) {\n      this.indDimensionValueDialog = '指标维度值-修改';\n      this.dimensionValue.categoryName = data.categoryName;\n      this.dimensionValue.id = data.id;\n      this.dimensionValue.lastLevelDimValueId = data.lastLevelDimValueId;\n      this.dimensionValue.dimInfoId = data.dimInfoId;\n      this.showIndDimensionValueAdd = true; //上级维度值不能选中\n\n      this.lastLevelDimValueFlag = false;\n    }\n    /*else if (data.dimLevel == 4 || data.dimLevel == 5) {\r\n    this.indDimensionValueDialog = '维度值-编辑'\r\n    this.dimensionValue.categoryName = data.categoryName\r\n    this.dimensionValue.id = data.id\r\n    this.dimensionValue.lastLevelDimValueId = data.lastLevelDimValueId\r\n    this.dimensionValue.dimInfoId = data.dimInfoId\r\n    this.showIndDimensionValueAdd = true\r\n    }*/\n\n  }), (0, _defineProperty2.default)(_methods, \"closeIndDimensionCateAddDialog\", function closeIndDimensionCateAddDialog() {\n    this.showIndDimensionCateAdd = false;\n  }), (0, _defineProperty2.default)(_methods, \"commitDimCate\", function commitDimCate() {\n    var _this13 = this;\n\n    this.crud.findVM('form').$refs['form'].validate(function (valid) {\n      if (!valid) {\n        return;\n      }\n\n      if (_this13.category.id == null) {\n        _indClassification.default.crud.add(_this13.category).then(function (data) {\n          if (data.code && data.code !== 0) {\n            _this13.$notify({\n              title: '新增失败，' + data.msg,\n              type: 'error',\n              duration: 2500\n            });\n\n            _this13.showIndDimensionCateAdd = false;\n          } else {\n            _this13.$notify({\n              title: '新增成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this13.initTreeData();\n\n            _this13.showIndDimensionCateAdd = false;\n          }\n        });\n      } else {\n        _indClassification.default.crud.edit(_this13.category).then(function (data) {\n          if (data.code && data.code !== 0) {\n            _this13.$notify({\n              title: '编辑失败，' + data.msg,\n              type: 'error',\n              duration: 2500\n            });\n\n            _this13.showIndDimensionCateAdd = false;\n          } else {\n            _this13.$notify({\n              title: '编辑成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this13.initTreeData();\n\n            _this13.showIndDimensionCateAdd = false;\n          }\n        });\n      }\n    });\n  }), (0, _defineProperty2.default)(_methods, \"addDimensionButton\", function addDimensionButton() {\n    //新增按钮\n    if (this.dimLevel == null || this.dimLevel == undefined) {\n      this.$message({\n        type: 'error',\n        message: '请选择左侧维度分类树！'\n      });\n      return;\n    }\n\n    if (this.dimLevel == 5) {\n      this.$message({\n        type: 'error',\n        message: '维度树最多到5级！'\n      });\n      return;\n    }\n\n    this.addDimension(this.buttonTreeData);\n  }), (0, _defineProperty2.default)(_methods, \"modifyDimensionButton\", function modifyDimensionButton() {\n    //修改按钮\n    if (this.dimLevel == null || this.dimLevel == undefined || this.dimLevel == 0) {\n      this.$message({\n        type: 'error',\n        message: '请选择左侧维度分类树！'\n      });\n      return;\n    }\n\n    if (this.buttonTreeData != null && this.buttonTreeData.children && this.buttonTreeData.children.length > 0) {\n      this.$message({\n        type: 'error',\n        message: '该节点下有子节点，不能修改！'\n      });\n      return;\n    }\n\n    this.handleEdit(this.buttonTreeData);\n  }), (0, _defineProperty2.default)(_methods, \"handleZoom\", function handleZoom() {\n    if (this.zoomDirection == 'left') {\n      this.categorySpan = 0;\n      this.tableSpan = 24;\n      this.zoomDirection = 'right';\n    } else {\n      this.categorySpan = 7;\n      this.tableSpan = 17;\n      this.zoomDirection = 'left';\n    }\n  }), _methods),\n  computed: {\n    hasOperatePermission: function hasOperatePermission() {\n      var authorizes = this.$store.getters && this.$store.getters.authorizes;\n      var permissionRoles = ['admin', 'indDimension:del'];\n      return authorizes.some(function (authorize) {\n        return permissionRoles.includes(authorize);\n      });\n    }\n  }\n};\nexports.default = _default;",null]}