{"remainingRequest":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\src\\utils\\request.js","dependencies":[{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\src\\utils\\request.js","mtime":1650772058529},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650772030926},{"path":"C:\\Users\\rdren\\Desktop\\workspace\\DataAssetPlatform\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650772030306}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/rdren/Desktop/workspace/DataAssetPlatform/Pncui-Ind/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _routers = _interopRequireDefault(require(\"@/router/routers\"));\n\nvar _elementUi = require(\"element-ui\");\n\nvar _store = _interopRequireDefault(require(\"@/store\"));\n\nvar _auth = require(\"./auth\");\n\nvar _settings = _interopRequireDefault(require(\"@public/config/settings\"));\n\n// 创建axios实例\nvar service = _axios.default.create({\n  baseURL: process.env.NODE_ENV === 'production' ? process.env.VUE_APP_BASE_API : '/api',\n  // api 的 base_url\n  //baseURL: process.env.VUE_APP_BASE_API === '' ? '/' : process.env.VUE_APP_BASE_API, // api 的 base_url\n  timeout: _settings.default.timeout,\n  // 请求超时时间\n  withCredentials: true\n}); // request拦截器\n\n\nservice.interceptors.request.use(function (config) {\n  if ((0, _auth.getToken)()) {\n    config.headers['Authorization'] = (0, _auth.getToken)(); // 让每个请求携带自定义token 请根据实际情况自行修改\n  }\n\n  config.headers['Content-Type'] = 'application/json'; // console.log('========request.use=========>', store.state.user.user.currentRole)\n\n  var path = window.location.href.replace(window.location.origin, '').replace('/#', '');\n  config.headers['client-page'] = path;\n\n  try {\n    if ((0, _auth.getCurrentRole)()) {\n      config.headers['current-roleid'] = (0, _auth.getCurrentRole)().id;\n    }\n  } catch (e) {}\n\n  return config;\n}, function (error) {\n  // Do something with request error\n  console.log(error); // for debug\n\n  Promise.reject(error);\n}); // response 拦截器\n\nservice.interceptors.response.use(function (response) {\n  var code = response.status;\n\n  if (code < 200 || code > 300) {\n    _elementUi.Notification.error({\n      title: response.message\n    });\n\n    return Promise.reject('error');\n  } else {\n    return response.data;\n  }\n}, function (error) {\n  var code = 0;\n  var msg = '';\n\n  try {\n    code = error.response.data.status;\n    msg = error.response.data.message;\n  } catch (e) {\n    if (error.toString().indexOf('Error: timeout') !== -1) {\n      _elementUi.Notification.error({\n        title: '网络请求超时',\n        duration: 5000\n      });\n\n      return Promise.reject(error);\n    }\n  }\n\n  if (code) {\n    if (code === 401) {\n      _elementUi.MessageBox.confirm('登录状态已过期，您可以继续留在该页面，或者重新登录', '系统提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _store.default.dispatch('LogOut').then(function () {\n          location.reload(); // 为了重新实例化vue-router对象 避免bug\n        });\n      });\n    } else if (code === 403) {\n      _routers.default.push({\n        path: '/401'\n      });\n    } else {\n      var errorMsg = error.response.data.message;\n\n      if (errorMsg !== undefined) {\n        _elementUi.Notification.error({\n          title: errorMsg,\n          duration: 5000\n        });\n      }\n    }\n  } else {\n    _elementUi.Notification.error({\n      title: '接口请求失败',\n      duration: 5000\n    });\n  }\n\n  return Promise.reject(error);\n});\nvar _default = service;\nexports.default = _default;",null]}