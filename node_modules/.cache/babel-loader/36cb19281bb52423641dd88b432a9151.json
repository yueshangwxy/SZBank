{"remainingRequest":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js!F:\\code\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\code\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\code\\indicator\\Pncui-Indicator\\src\\views\\indicators\\manual\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\code\\indicator\\Pncui-Indicator\\src\\views\\indicators\\manual\\index.vue","mtime":1643157926523},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\code\\indicator\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _defineProperty from \"F:/code/indicator/Pncui-Indicator/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _objectSpread from \"F:/code/indicator/Pncui-Indicator/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _methods;\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport indIndicatorResult, { getData, getDept, importExcel, add, toApprove, updateApproveStatus, findToApproveInd } from \"../../../api/indicators/indIndicatorManual\";\nimport { getResultDepts } from '@/api/indicators/indResultSubscribe';\nimport CRUD, { presenter, header, form, crud } from '@crud/crud';\nimport rrOperation from '@crud/RR.operation';\nimport crudOperation from '@crud/CRUD.operation';\nimport udOperation from '@crud/UD.operation';\nimport pagination from '@crud/Pagination';\nimport category from \"../category/category\";\nimport Treeselect from '@riophae/vue-treeselect';\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'; // crud交由presenter持有\n\nvar defaultCrud = CRUD({\n  title: '指标补录',\n  url: indIndicatorResult.url,\n  sort: 'id,desc',\n  crudMethod: _objectSpread({}, indIndicatorResult.method)\n});\nvar defaultForm = {\n  id: null,\n  ieId: null,\n  ieCode: null,\n  ieName: null,\n  ieValue: null,\n  status: null,\n  crtUserCode: null,\n  crtOrgCode: null,\n  crtDate: null,\n  updUserCode: null,\n  updOrgCode: null,\n  updDate: null,\n  frequency: null,\n  supplementaryValue: null,\n  supplementaryReason: null,\n  ieKindOneCode: null,\n  ieKindOneName: null,\n  ieKindTwoName: null,\n  approveStatus: null,\n  submitDescribe: null\n};\n/*  const requestXML=\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\" +\n          \"<service>\" +\n          \"<LOCAL_HEAD>\" +\n          \"</LOCAL_HEAD>\"+\n          \"<SYS_HEAD>\" +\n          \"<SERVICE_CODE attr=\\\"field\\\"></SERVICE_CODE>\"+\n          \"<SERVICE_SCENE attr=\\\"field\\\"></SERVICE_SCENE>\"+\n          \"<CONSUMER_ID attr=\\\"field\\\"></CONSUMER_ID>\"+\n          \"<CONSUMER_SEQ_NO attr=\\\"field\\\"></CONSUMER_SEQ_NO>\"+\n          \"<BUSS_SEQ_NO attr=\\\"field\\\"></BUSS_SEQ_NO>\"+\n          \"<TRAN_DATE attr=\\\"field\\\"></TRAN_DATE>\"+\n          \"<TRAN_TIMESTAMP attr=\\\"field\\\"></TRAN_TIMESTAMP>\"+\n          \"<TRAN_FLAG attr=\\\"field\\\"></TRAN_FLAG>\"+\n          \"</SYS_HEAD>\"+\n          \"<BODY>\" +\n          \"<INDEX_CODE attr=\\\"field\\\">A00001</INDEX_CODE>\"+\n          \"<DATE_DATE attr=\\\"field\\\">2021-10-29</DATE_DATE>\"+\n          \"</BODY>\"+\n          \"</service>\";*/\n\nvar bizNames = {};\nvar deptList = [];\nvar toApproveData = [];\nexport default {\n  name: 'IndIndicatorResult',\n  components: {\n    Treeselect: Treeselect,\n    pagination: pagination,\n    crudOperation: crudOperation,\n    rrOperation: rrOperation,\n    category: category,\n    udOperation: udOperation\n  },\n  mixins: [presenter(defaultCrud), header(), form(defaultForm), crud()],\n  dicts: ['RETENTION', 'IE_TYPE', 'IE_STATUS', 'IND_CURRENCY', 'IND_FIRST_TYPE', 'BUSSINESS_DEPT', 'IE_FREQUENCY', 'IND_APPROVE_STATUS'],\n  data: function data() {\n    return {\n      showDialog: false,\n      toApproveDialog: false,\n      innerVisible: false,\n      showLoad: true,\n      ids: null,\n      infoIds: null,\n      importDataText: '导入数据',\n      importDisabled: false,\n      permission: {\n        add: ['admin', 'indIndicatorResult:add'],\n        edit: ['admin', 'indIndicatorResult:edit'],\n        del: ['admin', 'indIndicatorResult:del']\n      },\n      readOnly: false,\n      bizNames: bizNames,\n      deptList: deptList,\n      toApproveData: toApproveData,\n      cur_page: 1,\n      pageSize: 5,\n      pageSizes: [5, 10, 20, 30, 40, 50],\n      total: 0,\n      count: 0,\n      rules: {\n        ieName: [{\n          required: true,\n          message: '指标名称不能为空',\n          trigger: 'change'\n        }],\n        ieCode: [{\n          required: true,\n          message: '指标编号不能为空',\n          trigger: 'change'\n        }],\n        currency: [{\n          required: true,\n          message: '币种不能为空',\n          trigger: 'change'\n        }],\n        frequency: [{\n          required: true,\n          message: '频率不能为空',\n          trigger: 'change'\n        }],\n        supplementaryValue: [{\n          required: true,\n          message: '补录值不能为空',\n          trigger: 'blur'\n        }],\n        supplementaryReason: [{\n          required: true,\n          message: '补录原因不能为空',\n          trigger: 'blur'\n        }],\n        deptNo: [{\n          required: true,\n          message: '业务属主机构不能为空',\n          trigger: 'change'\n        }],\n        periodDate: [{\n          required: true,\n          message: '数据日期不能为空',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.resetQuery();\n  },\n  methods: (_methods = {\n    resetQuery: function resetQuery() {\n      this.crud.resetQuery(false);\n      this.crud.refresh();\n    }\n  }, _defineProperty(_methods, CRUD.HOOK.beforeRefresh, function () {\n    this.crud.optShow.del = false;\n    this.crud.optShow.add = false;\n    return true;\n  }), _defineProperty(_methods, \"forceUpdate\", function forceUpdate(e) {\n    this.$forceUpdate(); //\n  }), _defineProperty(_methods, \"downloadTemplate\", function downloadTemplate() {\n    //注意路径，前面不要加 ./ 会形成相对路径，点击下载不了。\n    window.open('/ind_indicator_result.xlsx', '_blank');\n  }), _defineProperty(_methods, \"handleSizeChange\", function handleSizeChange(val) {\n    this.pageSize = val;\n    this.cur_page = 1;\n  }), _defineProperty(_methods, \"handleCurrentChange\", function handleCurrentChange(val) {\n    this.cur_page = val;\n    /*\n            this.tableData = this.allData.slice((pageNumber - 1) * pageSize, pageNumber * pageSize)\n    */\n  }), _defineProperty(_methods, \"getRowKeys\", function getRowKeys(row) {\n    return row.id;\n  }), _defineProperty(_methods, \"selectChange\", function selectChange() {\n    for (var i = 0; i < Object.keys(this.bizNames).length; i++) {\n      if (this.form.ieName == this.bizNames[i].bizName) {\n        this.form.ieCode = this.bizNames[i].bizCode;\n        this.form.ieId = this.bizNames[i].id;\n        this.form.ieKindOneCode = this.bizNames[i].indFirstType;\n        this.form.ieKindOneName = this.bizNames[i].indFirstTypeName;\n        this.form.ieKindTwoCode = this.bizNames[i].indSecondType;\n        this.form.ieKindTwoName = this.bizNames[i].indSecondTypeName; // this.form.frequency = this.bizNames[i].indFrequency\n      }\n    }\n  }), _defineProperty(_methods, \"addOrEdit\", function addOrEdit(data) {\n    if (data.length > 0) {\n      this.form.id = data[0].id;\n      this.form.ieName = data[0].ieName;\n      this.form.ieCode = data[0].ieCode;\n      this.form.frequency = data[0].frequency;\n      this.form.deptNo = data[0].deptNo;\n      this.form.deptName = data[0].deptName;\n      this.form.periodDate = data[0].periodDate;\n      this.form.currency = data[0].currency;\n      this.form.supplementaryValue = data[0].supplementaryValue;\n      this.form.supplementaryReason = data[0].supplementaryReason;\n      this.form.approveStatus = data[0].approveStatus;\n      this.form.ieKindOneCode = data[0].ieKindOneCode;\n      this.form.ieKindOneName = data[0].ieKindOneName;\n      this.form.ieKindTwoCode = data[0].ieKindTwoCode;\n      this.form.ieKindTwoName = data[0].ieKindTwoName;\n      this.readOnly = true;\n\n      if (this.form.approveStatus == \"1\") {\n        this.$message({\n          message: '审批中的指标信息不可更改',\n          type: 'warning'\n        });\n      } else {\n        this.showDialog = true;\n      }\n    } else {\n      this.showDialog = true;\n    }\n  }), _defineProperty(_methods, \"toEdit\", function toEdit(cloumn) {\n    this.form.id = cloumn.id;\n    this.form.ieName = cloumn.ieName;\n    this.form.ieCode = cloumn.ieCode;\n    this.form.frequency = cloumn.frequency;\n    this.form.deptNo = cloumn.deptNo;\n    this.form.deptName = cloumn.deptName;\n    this.form.periodDate = cloumn.periodDate;\n    this.form.currency = cloumn.currency;\n    this.form.supplementaryValue = cloumn.supplementaryValue;\n    this.form.supplementaryReason = cloumn.supplementaryReason;\n    this.readOnly = true;\n    this.showDialog = true;\n  }), _defineProperty(_methods, \"submitCU\", function submitCU() {\n    var _this = this;\n\n    this.$refs['form'].validate(function (valid) {\n      if (!valid) {\n        return;\n      } else {\n        add(_this.form).then(function (data) {\n          if (data.code === 0) {\n            _this.$message.success({\n              message: '操作成功!'\n            });\n\n            _this.closeFlowDialog();\n\n            _this.crud.toQuery();\n          } else {\n            _this.$message.error({\n              message: data.msg\n            });\n\n            _this.closeFlowDialog();\n\n            _this.crud.toQuery();\n          }\n        });\n      }\n    });\n  }), _defineProperty(_methods, \"closeFlowDialog\", function closeFlowDialog() {\n    var _this2 = this;\n\n    this.form.id = \"\";\n    this.form.ieName = \"\";\n    this.form.ieCode = \"\";\n    this.form.frequency = \"\";\n    this.form.deptNo = \"\";\n    this.form.deptName = \"\";\n    this.form.periodDate = \"\";\n    this.form.currency = \"\";\n    this.form.supplementaryValue = \"\";\n    this.form.supplementaryReason = \"\"; //this.crud.selections = [];\n\n    this.readOnly = false; //this.crud.toQuery();\n\n    this.showDialog = false;\n    this.$nextTick(function () {\n      _this2.$refs.form.resetFields();\n    });\n  }), _defineProperty(_methods, \"showApproveDialog\", function showApproveDialog() {\n    var _this3 = this;\n\n    this.toApproveDialog = true;\n    this.$refs.table.clearSelection();\n    findToApproveInd().then(function (data) {\n      _this3.toApproveData = data.data;\n      _this3.total = _this3.toApproveData.length;\n      _this3.count = parseInt(_this3.total) / parseInt(_this3.pageSize);\n      _this3.count = Math.ceil(_this3.count);\n      _this3.showLoad = false;\n    });\n  }), _defineProperty(_methods, \"closeToApproveDialog\", function closeToApproveDialog() {\n    this.toApproveDialog = false;\n    this.showLoad = true;\n    this.cur_page = 1;\n    this.$refs.toApproveData.clearSelection();\n    this.crud.toQuery();\n  }), _defineProperty(_methods, \"toApprove\", function toApprove(data) {\n    this.ids = \"\";\n    this.infoIds = \"\";\n\n    for (var i = 0; i < Object.keys(data).length; i++) {\n      this.ids += data[i].id + \",\";\n    }\n\n    for (var i = 0; i < Object.keys(data).length; i++) {\n      this.infoIds += data[i].infoId + \",\";\n    }\n\n    this.ids = this.ids.substring(0, this.ids.lastIndexOf(\",\"));\n    this.infoIds = this.infoIds.substring(0, this.infoIds.lastIndexOf(\",\"));\n    this.innerVisible = true;\n  }), _defineProperty(_methods, \"closeSubmitDialog\", function closeSubmitDialog() {\n    this.innerVisible = false;\n    this.form.submitDescribe = \"\";\n  }), _defineProperty(_methods, \"submit\", function submit() {\n    var _this4 = this;\n\n    updateApproveStatus(this.ids, this.infoIds, this.form.submitDescribe).then(function (data) {\n      if (data.msg == \"成功\" || data.msg == \"操作成功\") {\n        _this4.$message.success({\n          message: '操作成功!'\n        });\n\n        _this4.closeSubmitDialog();\n\n        _this4.closeToApproveDialog();\n      } else {\n        _this4.$message.error({\n          message: data.msg\n        });\n      }\n    });\n  }), _defineProperty(_methods, \"valueChange\", function valueChange(e) {\n    this.form.supplementaryValue = e.target.value;\n  }), _defineProperty(_methods, \"beforeUpload\", function beforeUpload(file) {\n    var FileExt = file.name.replace(/.+\\./, \"\");\n\n    if ([\"xls\", \"xlsx\"].indexOf(FileExt.toLowerCase()) === -1) {\n      this.$message({\n        type: \"warning\",\n        message: \"请上传后缀名为xls、xlsx的附件！\"\n      });\n      return false;\n    }\n\n    this.importDataText = '正在导入';\n    this.importDisabled = true;\n  }), _defineProperty(_methods, \"handleSuccess\", function handleSuccess() {\n    this.importDataText = '导入数据';\n    this.importDisabled = false;\n    this.$refs.upload.clearFiles();\n    this.crud.toQuery();\n  }), _defineProperty(_methods, \"uploadFile\", function uploadFile(item) {\n    var _this5 = this;\n\n    var $this = this;\n    var errorMsg = [];\n    var h = this.$createElement;\n    this.isImported = true;\n    var formData = new FormData();\n    formData.append(\"file\", item.file);\n    importExcel(formData).then(function (data) {\n      if (data.msg == \"成功\" || data.msg == \"操作成功\") {\n        $this.$message({\n          showClose: true,\n          type: 'success',\n          message: '导入成功 '\n        });\n\n        _this5.handleSuccess();\n      } else {\n        for (var i in data.msg) {\n          errorMsg.push(h('p', null, data.msg[i]));\n        }\n\n        $this.$message({\n          showClose: true,\n          duration: 0,\n          type: 'error',\n          message: h('div', null, errorMsg)\n        });\n\n        _this5.handleSuccess();\n      }\n    });\n  }), _defineProperty(_methods, \"getDepts\", function getDepts() {\n    var _this6 = this;\n\n    getResultDepts().then(function (res) {\n      _this6.deptList = res.content;\n    });\n  }), _methods),\n  mounted: function mounted() {\n    var _this7 = this;\n\n    getData().then(function (data) {\n      _this7.bizNames = data.data;\n    }), this.getDepts();\n  }\n};",null]}