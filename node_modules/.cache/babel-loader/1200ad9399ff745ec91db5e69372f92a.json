{"remainingRequest":"D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform\\Pncui-Indicator\\src\\views\\indicators\\indicator\\base\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform\\Pncui-Indicator\\src\\views\\indicators\\indicator\\base\\index.vue","mtime":1647917138764},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647917124586},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":1647917124178},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647917124586},{"path":"D:\\code\\DataAssetPlatform\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":1647917137429}],"contextDependencies":[],"result":["import _defineProperty from \"D:/code/DataAssetPlatform/Pncui-Indicator/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _createForOfIteratorHelper from \"D:/code/DataAssetPlatform/Pncui-Indicator/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"D:/code/DataAssetPlatform/Pncui-Indicator/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _methods;\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport crudIndIndicatorInfo, { add, checkDept, getAllSource, getAtom, getAtomDimenston, updateStatus, getBaseIndicatorByIeCode, getAllAtomInfos, process, getIndBaseRule } from \"../../../../api/indicators/indIndicatorInfo\";\nimport CRUD, { presenter, header, form, crud } from '@crud/crud';\nimport rrOperation from '@crud/RR.operation';\nimport crudOperation from '@crud/ICRUD.operation';\nimport udOperation from '@crud/UD.operation';\nimport pagination from '@crud/Pagination';\nimport category from \"../../category/category\";\nimport dimensionPage from \"./dimensionPage\";\nimport limitRulePage from \"./limitRulePage\";\nimport lookDetails from \"../details/lookBaseDetails\";\nimport baseDevelop from \"./baseDevelop\";\nimport { getDepts as _getDepts } from '@system/api/system/dept';\nimport Treeselect from '@riophae/vue-treeselect';\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'; //import checkPermission from '@eladmin/utils/permission'\n\nimport toStartDetails from \"../details/toStartBaseDetails\";\nimport ieCodeHistory from \"../details/ieCodeHistory\";\nimport { mapGetters } from 'vuex'; // crud交由presenter持有\n\nvar defaultCrud = CRUD({\n  title: '指标信息',\n  url: crudIndIndicatorInfo.url,\n  sort: 'id,desc',\n  optShow: {\n    del: false\n  },\n  crudMethod: _objectSpread({}, crudIndIndicatorInfo.method)\n});\nvar defaultForm = {\n  id: null,\n  ieCode: null,\n  ieName: null,\n  categoryId: null,\n  ieProp: null,\n  ieType: '1',\n  ieDesc: null,\n  ieRule: null,\n  dimNames: null,\n  ieDefaultValue: null,\n  ieMethod: null,\n  calcFreq: null,\n  status: '0',\n  ieDataUnit: '',\n  formulateBasis: '',\n  startDate: new Date(),\n  endDate: null,\n  retention: '1,Y',\n  processInstanceId: null,\n  manageDept: null,\n  crtUserCode: null,\n  crtOrgCode: null,\n  crtDate: null,\n  updUserCode: null,\n  updOrgCode: null,\n  updDate: null,\n  viewDepts: [],\n  viewDept: null,\n  indBaseRule: {\n    calcRule: null,\n    // 加工规则\n    dataSource: null,\n    // 数据源\n    expression: 'sum',\n    // 取数表达式\n    dataTable: null,\n    // 取数表名-即原子指标中的存储表名\n    measureColumn: null,\n    // 度量\n    bizCode: null // 原子指标\n\n  },\n  indDimRelations: [],\n  // 指标维度关系\n  indBaseRuleFilters: [],\n  // 指标附加规则\n  dimVals: null,\n  // 维度选择页面传来的显示维度\n  limitRule: null // 限制规则\n\n};\nexport default {\n  name: 'BaseIndicatorInfo',\n  components: {\n    pagination: pagination,\n    crudOperation: crudOperation,\n    rrOperation: rrOperation,\n    udOperation: udOperation,\n    category: category,\n    dimensionPage: dimensionPage,\n    limitRulePage: limitRulePage,\n    lookDetails: lookDetails,\n    baseDevelop: baseDevelop,\n    Treeselect: Treeselect,\n    toStartDetails: toStartDetails,\n    ieCodeHistory: ieCodeHistory\n  },\n  mixins: [presenter(defaultCrud), header(), form(defaultForm), crud()],\n  dicts: ['IE_PROP', 'IE_SCOPE', 'IE_TYPE', 'IE_METHOD', 'CALC_FREQ', 'IE_STATUS', 'IE_DATA_UNIT', 'RETENTION', 'EXPRESSION'],\n  data: function data() {\n    return {\n      manageDeptEdited: false,\n      table: {\n        columns: {\n          id: 'hidden',\n          crtOrgCode: 'hidden',\n          updOrgCode: 'hidden',\n          calcFreq: 'hidden',\n          retention: 'hidden'\n        }\n      },\n      permission: {\n        add: ['admin', 'baseIndIndicatorInfo:add'],\n        submit: ['admin', 'baseIndIndicatorInfo:submit'],\n        develop: ['admin', 'baseIndIndicatorInfo:develop'],\n        upLine: ['admin', 'baseIndIndicatorInfo:upLine'],\n        startUsing: ['admin', 'baseIndIndicatorInfo:startUsing'],\n        stopUsing: ['admin', 'baseIndIndicatorInfo:stopUsing'],\n        processA: ['admin', 'baseIndIndicatorInfo:processA'],\n        edit: ['admin', 'baseIndIndicatorInfo:edit'],\n        del: ['admin', 'baseIndIndicatorInfo:del'],\n        details: ['admin', 'baseIndIndicatorInfo:details'],\n        stopUsing1: []\n      },\n      rules: {\n        ieName: [{\n          required: true,\n          message: '指标名称不能为空',\n          trigger: 'blur'\n        }],\n        ieProp: [{\n          required: true,\n          message: '指标类别不能为空',\n          trigger: 'change'\n        }],\n        viewDepts: [{\n          required: true,\n          message: '查看部门不能为空',\n          trigger: 'change'\n        }],\n        manageDept: [{\n          required: true,\n          message: '管理部门不能为空',\n          trigger: 'change'\n        }],\n        formulateBasis: [{\n          required: true,\n          message: '指标类型不能为空',\n          trigger: 'change'\n        }],\n        ieDataUnit: [{\n          required: true,\n          message: '指标单位不能为空',\n          trigger: 'change'\n        }],\n        ieDesc: [{\n          required: true,\n          message: '指标描述不能为空',\n          trigger: 'change'\n        }],\n        'indBaseRule.bizCode': [{\n          required: true,\n          message: '原子指标不能为空',\n          trigger: 'blur'\n        }],\n        'indBaseRule.measureColumn': [{\n          required: true,\n          message: '原子指标不能为空',\n          trigger: 'blur'\n        }]\n      },\n      sourceData: [],\n      // 数据源信息\n      atom: [],\n      // 原子指标\n      measureInfo: [],\n      // 度量信息\n      dimInfo: [],\n      // 原子指标维度信息\n      processDialog: false,\n      // 计算输日期的页面\n      processParam: {\n        // 传给后台的参数\n        codes: [],\n        periodDate: ''\n      },\n      dateValue: '',\n      // 计算日期\n      depts: [],\n      // 部门数组\n      viewDept: [],\n      // 查看部门数组\n      tea: '',\n      ieCodeHis: null\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['user'])),\n  created: function created() {\n    this.$nextTick(function () {});\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.crud.resetQuery();\n\n    _getDepts({\n      enabled: true,\n      pid: '0'\n    }).then(function (res) {\n      var dep = [];\n      res.content.forEach(function (item) {\n        /*if (item.id != '89999053' && item.id != '89999024' && item.id != '00000203'\r\n            && item.id != '89999052' && item.id != '00000201' && item.id != '89999001'\r\n            && item.id != '89999048' && item.id != '89999020' && item.id != '89999015' && item.id != '89999047') {*/\n        dep.push(item); //}\n      });\n      _this2.depts = dep; // console.log(this.depts)\n    });\n  },\n  methods: (_methods = {\n    //checkPermission,\n    // 选择指标级别后关联管理部门\n    changeIeScope: function changeIeScope(data) {\n      if (data == 1) {\n        this.manageDeptEdited = true;\n        /* getInfo().then(res => {\r\n           this.form.manageDept = res.deptId\r\n         })*/\n\n        this.form.manageDept = this.user.deptId;\n        console.log('------------>>>>>---->>>', this.user.deptId);\n      } else {\n        this.form.manageDept = null;\n        this.manageDeptEdited = false;\n      }\n    }\n  }, _defineProperty(_methods, CRUD.HOOK.beforeRefresh, function () {\n    this.query.ieType = '1';\n    this.query.queryType = '1';\n    return true;\n  }), _defineProperty(_methods, \"handleCategoryClick\", function handleCategoryClick(data) {\n    this.crud.form.categoryId = data.id; // console.log(data)\n\n    this.crud.query.categoryIds = data.childrenIds; // data.childrenIds\n\n    this.form.categoryId = data.id;\n    this.crud.refresh();\n  }), _defineProperty(_methods, CRUD.HOOK.beforeToAdd, function () {\n    var _this3 = this;\n\n    console.log('类别', this.form.categoryId);\n\n    if (!this.form.categoryId) {\n      this.crud.notify('请选择类别', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    }\n\n    if (this.form.categoryId === '0') {\n      this.crud.notify('根节点不能添加', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    } // 获取数据源\n\n    /* getAllSource().then(data => {\r\n      this.sourceData = data.data\r\n    })*/\n    // 获取原子指标-初始化新增菜单时默认查询当前连接(暂定数据源='')的原子指标信息\n\n    /* const param = {\r\n      sourceDataSource: ''\r\n    }\r\n    getAtom(param).then(data => {\r\n      this.atom = data.data\r\n    })*/\n\n\n    getAllAtomInfos().then(function (data) {\n      _this3.atom = data.data;\n    }); // 获取部门信息\n\n    this.getDepts();\n  }), _defineProperty(_methods, CRUD.HOOK.beforeDelete, function () {\n    var _this4 = this;\n\n    var _iterator = _createForOfIteratorHelper(this.crud.selections),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var items = _step.value;\n\n        if (items.status != 0) {\n          this.crud.notify('该状态的指标不允许删除', CRUD.NOTIFICATION_TYPE.ERROR);\n          return false;\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    getAllAtomInfos().then(function (data) {\n      _this4.atom = data.data;\n    }); // 获取部门信息\n\n    this.getDepts();\n  }), _defineProperty(_methods, \"atomChangeHandle\", function atomChangeHandle(val) {\n    var _this5 = this;\n\n    this.atom.some(function (item) {\n      if (item.bizCode == val) {\n        // 1.自动注入取数表名\n        _this5.form.indBaseRule.dataTable = item.bizTabCode; // 2.根据原子指标编号查询原子指标维度信息表;生成维度信息\n\n        var dimParam = {\n          bizCode: item.bizCode,\n          dimType: 'D'\n        };\n        getAtomDimenston(dimParam).then(function (data) {\n          _this5.dimInfo = data.data;\n        }); // 3.根据原子指标编号查询原子指标维度信息表;生成度量信息\n\n        var meaParam = {\n          bizCode: item.bizCode,\n          dimType: 'M'\n        };\n        getAtomDimenston(meaParam).then(function (data) {\n          _this5.measureInfo = data.data;\n        }); // 清空\n\n        _this5.form.indBaseRule.measureColumn = null;\n        _this5.form.dimVals = null;\n        _this5.form.limitRule = null;\n      }\n    });\n  }), _defineProperty(_methods, \"dimClickHandle\", function dimClickHandle() {\n    // 将维度信息传递过去并将结果返回\n    var _this = this.$refs.dimensionPage;\n    _this.title = '统计维度';\n    _this.dimInfo = this.dimInfo;\n    _this.indDimRelations = this.form.indDimRelations; // 默认选中的值\n\n    _this.selectRow(); // 做默认选中的处理\n\n\n    _this.dimensionDialog = true;\n  }), _defineProperty(_methods, \"getDimensionPage\", function getDimensionPage(data1, data2) {\n    this.form.dimVals = data1;\n    this.form.indDimRelations = data2;\n  }), _defineProperty(_methods, \"limitRuleClickHandle\", function limitRuleClickHandle() {\n    // 将维度信息传递过去选择后将结果返回\n    var _this = this.$refs.limitRulePage;\n    _this.title = '限制规则';\n    _this.dimInfo = this.dimInfo;\n    _this.tableData = [];\n    _this.tableName = this.form.indBaseRule.dataTable; // 表名,查询值列表的参数\n\n    _this.indBaseRuleFilters = this.form.indBaseRuleFilters; // 默认选中的值\n\n    _this.selectRow(); // 做默认选中的处理\n\n\n    _this.limitRuleDialog = true;\n  }), _defineProperty(_methods, \"getLimitPage\", function getLimitPage(data1, data2) {\n    this.form.limitRule = data1;\n    this.form.indBaseRuleFilters = data2;\n  }), _defineProperty(_methods, CRUD.HOOK.beforeToEdit, function () {\n    if (this.form.status != 0 && this.form.status != 2) {\n      this.crud.notify('只有未提交或退回的数据才能修改能修改', CRUD.NOTIFICATION_TYPE.ERROR);\n      this.crud.resetForm();\n      return false;\n    } // 获取部门信息\n\n\n    this.getDepts(); // 通过指标编号查询基础指标规则+维度+附加规则\n\n    /* const param = {\r\n      'ieCode': this.form.ieCode\r\n    }\r\n    getBaseIndicatorByIeCode(this.form.ieCode).then(returnData => {\r\n      if (returnData.code === 0) {\r\n        this.form.indBaseRule = returnData.data.indBaseRule\r\n        this.form.indDimRelations = returnData.data.indDimRelations\r\n        this.form.indBaseRuleFilters = returnData.data.indBaseRuleFilters\r\n        this.form.dimVals = returnData.data.dimVals\r\n        this.form.limitRule = returnData.data.limitRule\r\n        // 获取原子指标-初始化新增菜单时默认查询当前连接(暂定数据源='')的原子指标信息\r\n        /!* const param1 = {\r\n          sourceDataSource: ''\r\n        }\r\n        getAtom(param1).then(data => {\r\n          this.atom = data.data\r\n        })*!/\r\n        // 获取原子指标\r\n        getAllAtomInfos().then(data => {\r\n          this.atom = data.data\r\n        })\r\n        // 根据原子指标编号查询原子指标维度信息表;生成维度信息\r\n        const dimParam = {\r\n          bizCode: this.form.indBaseRule.bizCode,\r\n          dimType: 'D'\r\n        }\r\n        getAtomDimenston(dimParam).then(data => {\r\n          this.dimInfo = data.data\r\n        })\r\n        // 根据原子指标编号查询原子指标维度信息表;生成度量信息\r\n        const meaParam = {\r\n          bizCode: this.form.indBaseRule.bizCode,\r\n          dimType: 'M'\r\n        }\r\n        getAtomDimenston(meaParam).then(data => {\r\n          this.measureInfo = data.data\r\n        })\r\n      }\r\n    })*/\n  }), _defineProperty(_methods, \"subApprove\", function subApprove(data) {\n    var _this6 = this;\n\n    var temp = 0;\n    var param = [];\n\n    for (var i = 0; i < data.length; i++) {\n      // 状态校验-只能选择0-未审批\n      if (data[i].status != 0) {\n        temp = -1;\n        break;\n      }\n\n      var indIndicatorInfo = {\n        'id': data[i].id,\n        'status': '1',\n        'ieProp': data[i].ieProp\n      };\n      param.push(indIndicatorInfo);\n    }\n\n    if (temp == -1) {\n      this.crud.notify('请选择已创建的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    }\n\n    this.$confirm(\"\\u786E\\u5B9A\\u8981\\u63D0\\u4EA4\\u6240\\u9009\\u6570\\u636E\\u5417?\", '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    }).then(function () {\n      _this6.crud.notify('操作成功!', CRUD.NOTIFICATION_TYPE.SUCCESS);\n\n      _this6.crud.toQuery();\n      /*updateStatus(param).then(returnData => {\r\n        if (returnData.code === 0) {\r\n          this.crud.notify('操作成功!', CRUD.NOTIFICATION_TYPE.SUCCESS)\r\n          this.crud.toQuery()\r\n        } else {\r\n          this.crud.notify('操作失败!错误原因:' + returnData.msg, CRUD.NOTIFICATION_TYPE.ERROR)\r\n          this.crud.toQuery()\r\n        }\r\n      })*/\n\n    });\n  }), _defineProperty(_methods, \"baseDevelop\", function baseDevelop(data) {\n    // 状态校验-只能选择0-未审批或3-已退回的数据\n    if (data.status != 2) {\n      this.crud.notify('请选择已审批的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    }\n\n    var _this = this.$refs.baseDevelop;\n    _this.title = '基础指标开发[' + data.ieCode + ']';\n    _this.form.ieCode = data.ieCode; // 通过指标编号查询基础指标规则+维度+附加规则\n\n    var param = {\n      'ieCode': data.ieCode\n    };\n    getBaseIndicatorByIeCode(data.ieCode).then(function (returnData) {\n      if (returnData.code === 0) {\n        _this.form.indBaseRule = returnData.data.indBaseRule;\n        _this.form.indDimRelations = returnData.data.indDimRelations;\n        _this.form.indBaseRuleFilters = returnData.data.indBaseRuleFilters;\n        _this.form.dimVals = returnData.data.dimVals;\n        _this.form.limitRule = returnData.data.limitRule; // 根据原子指标编号查询原子指标维度信息表;生成维度信息\n\n        var dimParam = {\n          bizCode: _this.form.indBaseRule.bizCode,\n          dimType: 'D'\n        };\n        getAtomDimenston(dimParam).then(function (data) {\n          _this.dimInfo = data.data;\n        }); // 根据原子指标编号查询原子指标维度信息表;生成度量信息\n\n        var meaParam = {\n          bizCode: _this.form.indBaseRule.bizCode,\n          dimType: 'M'\n        };\n        getAtomDimenston(meaParam).then(function (data) {\n          _this.measureInfo = data.data;\n        });\n      } else {\n        _this.form.indBaseRule = {\n          calcRule: null,\n          // 加工规则\n          dataSource: null,\n          // 数据源\n          expression: 'sum',\n          // 取数表达式\n          dataTable: null,\n          // 取数表名-即原子指标中的存储表名\n          measureColumn: null,\n          // 度量\n          bizCode: null // 原子指标\n\n        };\n        _this.form.indDimRelations = [];\n        _this.form.indBaseRuleFilters = [];\n        _this.form.dimVals = null;\n        _this.form.limitRule = null;\n        _this.dimInfo = [];\n        _this.measureInfo = [];\n      }\n    }); // 获取原子指标-初始化新增菜单时默认查询当前连接(暂定数据源='')的原子指标信息\n\n    /* const param1 = {\r\n      sourceDataSource: ''\r\n    }\r\n    getAtom(param1).then(data => {\r\n      this.atom = data.data\r\n    })*/\n    // 获取原子指标\n\n    getAllAtomInfos().then(function (data) {\n      _this.atom = data.data;\n    });\n    _this.baseDevelopDialog = true;\n  }), _defineProperty(_methods, \"refQuery\", function refQuery(data) {\n    this.crud.toQuery();\n  }), _defineProperty(_methods, \"upLine\", function upLine(data) {\n    var _this7 = this;\n\n    var temp = 0;\n    var param = [];\n    var ieCodes = [];\n\n    for (var i = 0; i < data.length; i++) {\n      // 状态校验-只能选择0-已审批\n      if (data[i].status != 2) {\n        temp = -1;\n        break;\n      }\n\n      var indIndicatorInfo = {\n        'id': data[i].id,\n        'status': '4'\n      };\n      param.push(indIndicatorInfo);\n      ieCodes.push(data[i].ieCode);\n    }\n\n    if (temp == -1) {\n      this.crud.notify('请选择已审批的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    } // 开发校验通过后执行审批\n\n\n    getIndBaseRule(ieCodes).then(function (returnData) {\n      if (returnData.code !== 0) {\n        _this7.crud.notify(returnData.msg + '指标未进行开发', CRUD.NOTIFICATION_TYPE.ERROR);\n      } else {\n        _this7.$confirm(\"\\u786E\\u5B9A\\u4E0A\\u7EBF\\u6240\\u9009\\u6570\\u636E\\u5417?\", '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          // 开发校验通过后,修改状态\n          updateStatus(param).then(function (returnData) {\n            if (returnData.code === 0) {\n              _this7.crud.notify('操作成功', CRUD.NOTIFICATION_TYPE.SUCCESS);\n\n              _this7.crud.toQuery();\n            } else {\n              _this7.crud.notify('操作失败!错误原因:' + returnData.msg, CRUD.NOTIFICATION_TYPE.ERROR);\n\n              _this7.crud.toQuery();\n            }\n          });\n        });\n      }\n    });\n  }), _defineProperty(_methods, \"startUsing\", function startUsing(data) {\n    var _this8 = this;\n\n    var temp = 0;\n    var param = [];\n\n    for (var i = 0; i < data.length; i++) {\n      // 状态校验-只能选择4-已上线，不能啟用6-停用的数据\n      if (data[i].status != 4) {\n        temp = -1;\n        break;\n      }\n\n      var indIndicatorInfo = {\n        'id': data[i].id,\n        'status': '5'\n      };\n      param.push(indIndicatorInfo);\n    }\n\n    if (temp == -1) {\n      this.crud.notify('请选择已上线的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    }\n\n    this.$confirm(\"\\u786E\\u5B9A\\u542F\\u7528\\u6240\\u9009\\u6570\\u636E\\u5417?\", '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    }).then(function () {\n      updateStatus(param).then(function (returnData) {\n        if (returnData.code === 0) {\n          _this8.crud.notify('操作成功', CRUD.NOTIFICATION_TYPE.SUCCESS);\n\n          _this8.crud.toQuery();\n        } else {\n          _this8.crud.notify('操作失败!错误原因:' + returnData.msg, CRUD.NOTIFICATION_TYPE.ERROR);\n\n          _this8.crud.toQuery();\n        }\n      });\n    });\n  }), _defineProperty(_methods, \"stopUsing2\", function stopUsing2(data) {\n    var _this9 = this;\n\n    var temp = 0;\n    var param = [];\n    checkDept(data.manageDept).then(function (res) {\n      _this9.tea = res.code;\n\n      if (res.code !== 0) {\n        _this9.crud.notify('请选择自己管理部门的指标', CRUD.NOTIFICATION_TYPE.ERROR);\n\n        return false;\n      } else {\n        if (data.status != 5) {\n          temp = -1;\n        }\n\n        var indIndicatorInfo = {\n          'id': data.id,\n          'ieCode': data.ieCode,\n          'ieName': data.ieName,\n          'status': '6'\n        };\n        param.push(indIndicatorInfo);\n\n        if (temp == -1) {\n          _this9.crud.notify('请选择启用的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n\n          return false;\n        }\n\n        _this9.$confirm(\"\\u786E\\u5B9A\\u505C\\u7528\\u6240\\u9009\\u6570\\u636E\\u5417?\", '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          updateStatus(param).then(function (returnData) {\n            if (returnData.code === 0) {\n              _this9.crud.notify('操作成功', CRUD.NOTIFICATION_TYPE.SUCCESS);\n\n              _this9.crud.toQuery();\n            } else {\n              _this9.crud.notify('操作失败!错误原因:' + returnData.msg, CRUD.NOTIFICATION_TYPE.ERROR);\n\n              _this9.crud.toQuery();\n            }\n          });\n        });\n      }\n    });\n  }), _defineProperty(_methods, \"stopUsing\", function stopUsing(data) {\n    var _this10 = this;\n\n    var temp = 0;\n    var param = [];\n\n    for (var i = 0; i < data.length; i++) {\n      // 状态校验-只能选择4-启用数据\n      if (data[i].status != 5) {\n        temp = -1;\n        break;\n      }\n\n      var indIndicatorInfo = {\n        'id': data[i].id,\n        'status': '6'\n      };\n      param.push(indIndicatorInfo);\n    }\n\n    if (temp == -1) {\n      this.crud.notify('请选择启用的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    }\n\n    this.$confirm(\"\\u786E\\u5B9A\\u505C\\u7528\\u6240\\u9009\\u6570\\u636E\\u5417?\", '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    }).then(function () {\n      updateStatus(param).then(function (returnData) {\n        if (returnData.code === 0) {\n          _this10.crud.notify('操作成功', CRUD.NOTIFICATION_TYPE.SUCCESS);\n\n          _this10.crud.toQuery();\n        } else {\n          _this10.crud.notify('操作失败!错误原因:' + returnData.msg, CRUD.NOTIFICATION_TYPE.ERROR);\n\n          _this10.crud.toQuery();\n        }\n      });\n    });\n  }), _defineProperty(_methods, \"detailsHis\", function detailsHis(row, detailFlag) {\n    var _this11 = this;\n\n    var _this = this.$refs.ieCodeHistory;\n    _this.openFlag = true;\n    _this.ieCodePara = row.ieCode;\n    this.ieCodeHis = row.ieCode;\n    this.$nextTick(function () {\n      _this11.$refs.ieCodeHistory.refresh();\n    });\n  }), _defineProperty(_methods, \"details\", function details(row, detailFlag) {\n    var _this = null;\n\n    if (detailFlag == 'detail') {\n      _this = this.$refs.lookDetails;\n    } else if (detailFlag == 'start') {\n      _this = this.$refs.toStartDetails;\n    } // 打开详情页面时查询相关信息\n    // 通过指标编号查询基础指标规则+维度+附加规则\n\n\n    var param = {\n      'ieCode': row.ieCode\n    };\n    getBaseIndicatorByIeCode(row.ieCode).then(function (returnData) {\n      if (returnData.code === 0) {\n        row.indBaseRule = returnData.data.indBaseRule;\n        row.indDimRelations = returnData.data.indDimRelations;\n        row.indBaseRuleFilters = returnData.data.indBaseRuleFilters;\n        row.dimVals = returnData.data.dimVals;\n        row.limitRule = returnData.data.limitRule; // 获取原子指标-初始化新增菜单时默认查询当前连接(暂定数据源='')的原子指标信息\n\n        /* const param1 = {\r\n          sourceDataSource: ''\r\n        }\r\n        getAtom(param1).then(data => {\r\n          _this.atom = data.data\r\n        })*/\n        // 获取原子指标\n\n        getAllAtomInfos().then(function (data) {\n          _this.atom = data.data;\n        }); // 根据原子指标编号查询原子指标维度信息表;生成维度信息\n\n        var dimParam = {\n          bizCode: row.indBaseRule.bizCode,\n          dimType: 'D'\n        };\n        getAtomDimenston(dimParam).then(function (data) {\n          _this.dimInfo = data.data;\n        }); // 根据原子指标编号查询原子指标维度信息表;生成度量信息\n\n        var meaParam = {\n          bizCode: row.indBaseRule.bizCode,\n          dimType: 'M'\n        };\n        getAtomDimenston(meaParam).then(function (data) {\n          _this.measureInfo = data.data;\n        });\n      } else {\n        row.indBaseRule = {};\n        row.indDimRelations = null;\n        row.indBaseRuleFilters = null;\n        row.dimVals = null;\n        row.limitRule = null;\n      }\n    });\n\n    _getDepts({\n      enabled: true\n    }).then(function (res) {\n      _this.depts = res.content;\n      _this.viewDept = [{\n        id: 0,\n        label: '总行机关',\n        children: res.content\n      }];\n    });\n\n    _this.title = '详情';\n    _this.form = row;\n    _this.detailsDialog = true;\n  }), _defineProperty(_methods, \"processA\", function processA(data) {\n    // 只能选择已审批的数据\n    var temp = 0;\n\n    for (var i = 0; i < data.length; i++) {\n      // 状态校验-只能选择5-启用\n      if (data[i].status != 5) {\n        temp = -1;\n        break;\n      }\n    }\n\n    if (temp == -1) {\n      this.crud.notify('请选择已启用的数据', CRUD.NOTIFICATION_TYPE.ERROR);\n      return false;\n    }\n\n    var codes = [];\n\n    for (var _i = 0; _i < data.length; _i++) {\n      codes.push(data[_i].ieCode);\n    }\n\n    this.processParam.codes = codes;\n    this.processDialog = true;\n  }), _defineProperty(_methods, \"processB\", function processB() {\n    var _this12 = this;\n\n    if (this.dateValue == '') {\n      this.crud.notify('日期不能为空', CRUD.NOTIFICATION_TYPE.ERROR);\n    } else {\n      var dateValue = this.dateFormat(this.dateValue, 'YYYYMMDD');\n      this.processParam.periodDate = dateValue;\n      process(this.processParam, 'base').then(function (data) {\n        if (data.code == 0) {\n          _this12.crud.notify(data.msg, CRUD.NOTIFICATION_TYPE.SUCCESS);\n        } else {\n          _this12.crud.notify(data.msg, CRUD.NOTIFICATION_TYPE.ERROR);\n        }\n\n        _this12.processDialog = false;\n      });\n    }\n  }), _defineProperty(_methods, \"getDepts\", function getDepts() {\n    var _this13 = this;\n\n    _getDepts({\n      enabled: true,\n      pid: '1',\n      deptCategory: '0'\n    }).then(function (res) {\n      var dep = [];\n      /* res.content.forEach(function (item) {\r\n         if (item.id != '89999053' && item.id != '89999024' && item.id != '00000203'\r\n             && item.id != '89999052' && item.id != '00000201' && item.id != '89999001'\r\n             && item.id != '89999048' && item.id != '89999020' && item.id != '89999015' && item.id != '89999047') {\r\n           dep.push(item)\r\n         }\r\n       });\r\n       this.depts = dep*/\n      // console.log( this.depts)\n\n      _this13.depts = res.content;\n      _this13.viewDept = [{\n        id: 0,\n        label: '总行机关',\n        children: res.content\n      }];\n    });\n  }), _methods)\n};",null]}