{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\dataServicePlatform\\applyForApi.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\src\\views\\indicators\\dataServicePlatform\\applyForApi.vue","mtime":1654824275281},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/code/DataAssetPlatform000/Pncui-Ind/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.array.from\");\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"D:/code/DataAssetPlatform000/Pncui-Ind/node_modules/@babel/runtime/helpers/defineProperty\"));\n\nvar _selectUser = _interopRequireDefault(require(\"./selectUser.vue\"));\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar _default = {\n  components: {\n    selectUser: _selectUser.default\n  },\n  data: function data() {\n    var _rules;\n\n    return {\n      title: \"API申请\",\n      editPage: false,\n      showSelectUser: false,\n      id: \"\",\n      ruleForm: {\n        name: \"\",\n        description: \"\",\n        overtime: \"\",\n        currentLimit: \"\",\n        type: \"\",\n        destinationAddress: \"\",\n        latestGenerationTime: \"\",\n        separator: \"\",\n        fileFormat: \"\",\n        serviceType: \"1\",\n        status: \"\",\n        dept: \"\",\n        belongUser: \"\",\n        dockName: \"\",\n        fieldList: \"\",\n        belongApplication: \"\",\n        belongApplicationName: \"\",\n        sitPath: \"\",\n        prePath: \"\",\n        serviceParamList: [{\n          name: \"\",\n          type: \"\",\n          parameterType: \"1\",\n          // 1入参 2出参\n          description: \"\",\n          defaultValue: \"\",\n          isPass: \"\"\n        }, {\n          name: \"\",\n          type: \"\",\n          parameterType: \"2\",\n          // 1入参 2出参\n          description: \"\",\n          defaultValue: \"\",\n          isPass: \"\"\n        }],\n        applicationInfoList: []\n      },\n      labelPosition: \"top\",\n      rules: (_rules = {\n        name: [{\n          required: true,\n          message: \"请输入名称\",\n          trigger: \"blur\"\n        }],\n        description: [{\n          required: true,\n          message: \"请输入描述\",\n          trigger: \"blur\"\n        }],\n        overtime: [{\n          required: true,\n          message: \"请输入超时\",\n          trigger: \"blur\"\n        }],\n        currentLimit: [{\n          required: true,\n          message: \"请输入限流\",\n          trigger: \"blur\"\n        }],\n        type: [{\n          required: true,\n          message: \"请选择接口类型\",\n          trigger: \"change\"\n        }],\n        dept: [{\n          required: true,\n          message: \"请选择所属部门\",\n          trigger: \"change\"\n        }],\n        dockName: [{\n          required: true,\n          message: \"请输入对接人\",\n          trigger: \"change\"\n        }],\n        status: [{\n          required: true,\n          message: \"请选择接口状态\",\n          trigger: \"change\"\n        }],\n        sitPath: [{\n          required: true,\n          message: \"请输入测试地址\",\n          trigger: \"blur\"\n        }],\n        prePath: [{\n          required: true,\n          message: \"请输入生产地址\",\n          trigger: \"blur\"\n        }],\n        belongApplicationName: [{\n          required: true,\n          message: \"请选择归属应用\",\n          trigger: \"change\"\n        }],\n        applicationInfoList: [{\n          required: true,\n          message: \"请选择可访问应用\",\n          trigger: \"change\"\n        }]\n      }, (0, _defineProperty2.default)(_rules, \"applicationInfoList\", [{\n        required: true,\n        message: \"请选择可访问应用\",\n        trigger: \"change\"\n      }]), (0, _defineProperty2.default)(_rules, \"paramsName\", [{\n        required: true,\n        message: \"请输入参数名称\",\n        trigger: \"blur\"\n      }]), (0, _defineProperty2.default)(_rules, \"paramsType\", [{\n        required: true,\n        message: \"请选择参数类型\",\n        trigger: \"change\"\n      }]), (0, _defineProperty2.default)(_rules, \"paramsIsPass\", [{\n        required: true,\n        message: \"请选择参数是否必传\",\n        trigger: \"change\"\n      }]), (0, _defineProperty2.default)(_rules, \"paramsDefault\", [{\n        required: true,\n        message: \"请输入默认值\",\n        trigger: \"blur\"\n      }]), (0, _defineProperty2.default)(_rules, \"paramsDesc\", [{\n        required: true,\n        message: \"请输入参数说明\",\n        trigger: \"blur\"\n      }]), _rules),\n      // 应用列表\n      appList: [],\n      // 部门树\n      deptTree: []\n    };\n  },\n  mounted: function mounted() {\n    this.initData();\n  },\n  // beforeRouteLeave(to, from, next) {\n  //   if (to.name === \"myService\") {\n  //     this.$store.commit(\"SET_KEEPALIVE\", true);\n  //   } else {\n  //     this.$store.commit(\"SET_KEEPALIVE\", false);\n  //   }\n  //   next();\n  // },\n  // watch: {\n  //   $route(e) {\n  //     if (e.name === \"applyForApi\") {\n  //       this.initData();\n  //     }\n  //   }\n  // },\n  methods: {\n    initData: function initData() {\n      var _this = this;\n\n      this.editPage = this.$route.name === \"editApi\" ? true : false;\n\n      if (this.editPage) {\n        this.title = this.$route.meta.title;\n      }\n\n      this.$api.findDeptTree({}).then(function (res) {\n        _this.deptTree = res.data;\n      });\n      this.$api.qryOpenApp({}).then(function (res) {\n        _this.appList = res.data;\n      });\n      this.id = this.$route.query.id ? this.$route.query.id : \"\";\n\n      if (this.$route.name === \"editApi\") {\n        this.$api.viewServiceDetail({\n          id: this.id\n        }).then(function (res) {\n          _this.ruleForm = res.data;\n        });\n      }\n    },\n    selectBelongApplication: function selectBelongApplication(name) {\n      var app = this.appList.filter(function (item) {\n        return item.appName === name;\n      });\n      this.$set(this.ruleForm, \"belongApplication\", app[0].appCode);\n    },\n    slectBelongUser: function slectBelongUser(user) {\n      if (user && user.username) {\n        this.$set(this.ruleForm, \"dockName\", user.nickName);\n        this.$set(this.ruleForm, \"belongUser\", user.username);\n      }\n\n      this.showSelectUser = !this.showSelectUser;\n    },\n    // 添加入参\n    addReqParams: function addReqParams() {\n      this.ruleForm.serviceParamList.push({\n        name: \"\",\n        type: \"\",\n        parameterType: \"1\",\n        description: \"\",\n        defaultValue: \"\",\n        isPass: \"\"\n      });\n    },\n    // 删除入参\n    delReqParams: function delReqParams(index) {\n      this.ruleForm.serviceParamList.splice(index, 1);\n    },\n    // 添加出参\n    addResParams: function addResParams() {\n      this.ruleForm.serviceParamList.push({\n        name: \"\",\n        type: \"\",\n        parameterType: \"2\",\n        description: \"\",\n        defaultValue: \"\",\n        isPass: \"\"\n      });\n    },\n    // 删除出参\n    delResParams: function delResParams(index) {\n      this.ruleForm.serviceParamList.splice(index, 1);\n    },\n    // 取消\n    cancel: function cancel() {\n      var _this2 = this;\n\n      var currentView = this.$store.state.tagsView.visitedViews[0];\n\n      var _iterator = _createForOfIteratorHelper(this.$store.state.tagsView.visitedViews),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          currentView = _step.value;\n\n          if (currentView.path === this.$route.path) {\n            break;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this.$store.dispatch(\"tagsView/delView\", currentView).then(function () {\n        _this2.$router.push({\n          path: \"/dataServicePlatform/myService\"\n        });\n      });\n    },\n    // 提交申请\n    submitApplication: function submitApplication() {\n      var _this3 = this;\n\n      this.$refs.ruleForm.validate(function (valid) {\n        if (valid) {\n          _this3.$api.applyForService(_this3.ruleForm).then(function (res) {\n            if (res.code == 0 || res.code == 200) {\n              _this3.$message.success(res.msg);\n\n              _this3.cancel();\n            } else {\n              _this3.$message.error(res.msg);\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    // 确认更新\n    confirmModify: function confirmModify() {\n      var _this4 = this;\n\n      this.$refs.ruleForm.validate(function (valid) {\n        if (valid) {\n          _this4.$api.serviceUpdate(_this4.ruleForm).then(function (res) {\n            if (res.code == 0 || res.code == 200) {\n              _this4.$message.success(res.msg);\n\n              _this4.cancel();\n            } else {\n              _this4.$message.error(res.msg);\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    }\n  }\n};\nexports.default = _default;",null]}