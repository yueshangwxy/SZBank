{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\pncui-workflow\\src\\views\\activiti\\model.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\pncui-workflow\\src\\views\\activiti\\model.vue","mtime":1650418882911},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/code/DataAssetPlatform000/Pncui-Ind/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _activiti = require(\"../../api/workflow/activiti\");\n\nvar _FlowEditor = _interopRequireDefault(require(\"../../components/Activiti/FlowEditor\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'Model',\n  data: function data() {\n    return {\n      rows: [],\n      loading: false,\n      showEdit: false,\n      showAdd: false,\n      showPublish: false,\n      showImport: false,\n      modelId: '',\n      modelName: '',\n      fileData: {},\n      query: {\n        modelName: '',\n        modelKey: ''\n      },\n      form: {\n        modelName: '',\n        modelKey: '',\n        deployName: '',\n        category: '',\n        id: '',\n        uploadFiles: []\n      },\n      page: {\n        // 页码\n        start: 0,\n        // 每页数据条数\n        size: 10,\n        // 总数据条数\n        total: 0\n      },\n      rules: {\n        modelName: [{\n          required: true,\n          message: '名称不能为空',\n          trigger: 'blur'\n        }],\n        modelKey: [{\n          required: true,\n          message: 'Key不能为空',\n          trigger: 'blur'\n        }]\n      },\n      rules2: {\n        deployName: [{\n          required: true,\n          message: '名称不能为空',\n          trigger: 'blur'\n        }],\n        category: [{\n          required: true,\n          message: '分类不能为空',\n          trigger: 'blur'\n        }]\n      },\n      rules3: {\n        modelName: [{\n          required: true,\n          message: '名称不能为空',\n          trigger: 'blur'\n        }],\n        modelKey: [{\n          required: true,\n          message: 'Key不能为空',\n          trigger: 'blur'\n        }],\n        uploadFiles: [{\n          required: true,\n          message: '模型文件不能为空',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  components: {\n    FlowEditor: _FlowEditor.default\n  },\n  mounted: function mounted() {\n    this.refresh();\n  },\n  methods: {\n    refresh: function refresh() {\n      var _this = this;\n\n      (0, _activiti.models)({\n        key: this.query.modelKey,\n        name: this.query.modelName,\n        size: this.page.size,\n        page: this.page.start\n      }).then(function (res) {\n        //console.log(res)\n        _this.rows = res.data.records;\n        _this.page.total = res.data.total;\n      });\n    },\n    editModel: function editModel(row) {\n      this.modelId = row.id;\n      this.modelName = row.name;\n      this.showEdit = true;\n    },\n    addModel: function addModel() {\n      this.showAdd = true;\n      this.query.modelKey = '';\n      this.query.modelName = '';\n    },\n    doAddModel: function doAddModel() {\n      var _this2 = this;\n\n      (0, _activiti.addModel)(this.form.modelKey, this.form.modelName).then(function (res) {\n        if (res.code === 0) {\n          _this2.showAdd = false;\n\n          _this2.$message.success('添加成功' + res.data.id);\n\n          _this2.refresh();\n        } else {\n          _this2.$message.error(res.msg || '添加失败');\n        }\n        /*this.editModel({\n          id: res.data.id,\n          name: this.form.modelName\n        })*/\n\n      });\n    },\n    delModel: function delModel(row) {\n      var _this3 = this;\n\n      this.$confirm('确定要删除该模型吗？').then(function () {\n        (0, _activiti.delModel)(row.id).then(function (res) {\n          if (res.code === 0) {\n            _this3.refresh();\n\n            _this3.$message.success('删除成功');\n          } else {\n            _this3.$message.error(res.msg);\n          }\n        });\n      });\n    },\n    pubModel: function pubModel(row) {\n      this.form.id = row.id;\n      this.form.deployName = row.name;\n      this.showPublish = true;\n    },\n    doPublish: function doPublish() {\n      var _this4 = this;\n\n      (0, _activiti.pubModel)(this.form.id, this.form).then(function (res) {\n        if (res.code === 0) {\n          _this4.showPublish = false;\n\n          _this4.$message.success('发布成功');\n\n          _this4.refresh();\n        } else {\n          _this4.$message.error(res.msg);\n        }\n      });\n    },\n    expModel: function expModel(row) {\n      (0, _activiti.expModel)(row.id).then(function (res) {\n        var url = window.URL.createObjectURL(new Blob([res]));\n        var link = document.createElement('a');\n        link.style.display = 'none';\n        link.href = url;\n        var fileName = (row.key || row.name) + '.bpmn';\n        link.setAttribute('download', fileName);\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      });\n    },\n    handleChange: function handleChange(param) {\n      console.log('handchange--->>', param);\n      this.fileData.append('file', param.file); //传文件\n    },\n    submitUpload: function submitUpload() {\n      var _this5 = this;\n\n      this.fileData = new FormData(); // new formData对象\n\n      console.log('submit>>', this.fileData);\n      this.$refs.upload.submit();\n      var fd = new FormData();\n      fd.append('file', this.fileData);\n      this.fileData.append('modelName', this.form.modelName);\n      this.fileData.append('modelKey', this.form.modelKey);\n      console.log('befor upload>>', fd);\n      (0, _activiti.impModel)(this.fileData).then(function (res) {\n        if (res.code == 0) {\n          _this5.showImport = false;\n\n          _this5.$message.success('导入成功');\n\n          _this5.refresh();\n        } else {\n          _this5.$message.error(res.msg);\n        }\n      });\n    },\n    handleRemove: function handleRemove(file, fileList) {\n      console.log(file, fileList);\n    },\n    // 当前页改变\n    pageChangeHandler: function pageChangeHandler(e) {\n      this.page.start = e;\n      this.refresh();\n    },\n    // 每页条数改变\n    sizeChangeHandler: function sizeChangeHandler(e) {\n      this.page.size = e;\n      this.page.start = 1;\n      this.refresh();\n    }\n  }\n};\nexports.default = _default;",null]}