{"remainingRequest":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\eladmin-system\\src\\views\\system\\auth\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\eladmin-system\\src\\views\\system\\auth\\index.vue","mtime":1650418877001},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\babel-loader\\lib\\index.js","mtime":1650418872733},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650418873221},{"path":"D:\\code\\DataAssetPlatform000\\Pncui-Ind\\node_modules\\vue-loader\\lib\\index.js","mtime":1650418886580}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/code/DataAssetPlatform000/Pncui-Ind/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _request = _interopRequireDefault(require(\"@/utils/request\"));\n\nvar _qs = _interopRequireDefault(require(\"qs\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'Auth',\n  dicts: ['DATA_AUTH_TYPE'],\n  data: function data() {\n    return {\n      authActiveName: 'role',\n      menuActiveName: 'admin',\n      currentType: 'role',\n      currentId: '',\n      currentRoleLevel: null,\n      menuTreeDefaultProps: {\n        children: 'children',\n        label: 'name'\n      },\n      deptTab: {\n        query: {\n          name: '',\n          id: ''\n        },\n        data: [],\n        loading: false\n      },\n      roleTab: {\n        query: {\n          blurry: ''\n        },\n        data: [],\n        loading: true,\n        total: 0,\n        page: 0,\n        size: 10\n      },\n      userTab: {\n        query: {\n          blurry: ''\n        },\n        data: [],\n        loading: true,\n        total: 0,\n        page: 0,\n        size: 10\n      },\n      adminTab: {\n        menuLoading: false,\n        data: [],\n        loading: false,\n        operators: [],\n        strictly: true\n      },\n      menuIds: [],\n      strictly: true\n    };\n  },\n  mounted: function mounted() {\n    this.toQueryRole(); // this.getAdminmenus()\n  },\n  methods: {\n    authHandleClick: function authHandleClick(tab, event) {\n      if (tab.name === 'dept') {\n        this.currentType = 'dept';\n        this.$refs.adminMenuTree.setCheckedKeys([]);\n        this.toQueryDept();\n      } else if (tab.name === 'role') {\n        this.currentType = 'role';\n        this.$refs.adminMenuTree.setCheckedKeys([]);\n        this.toQueryRole();\n      } else if (tab.name === 'user') {\n        this.currentType = 'user';\n        this.$refs.adminMenuTree.setCheckedKeys([]);\n        this.toQueryUser();\n      }\n    },\n    menuHandleClick: function menuHandleClick(tab, event) {// this.getAdminmenus()\n    },\n    // 机构权限配置\n    toQueryDept: function toQueryDept() {\n      var _this = this;\n\n      _this.deptTab.loading = true; // _this.deptTab.data = [];\n\n      (0, _request.default)({\n        url: '/api/dept' + '?' + _qs.default.stringify(_this.deptTab.query, {\n          indices: false\n        }),\n        method: 'get'\n      }).then(function (res) {\n        _this.deptTab.data = res.content;\n        _this.deptTab.loading = false; //  console.log(_this.deptTab.data)\n      });\n    },\n    onSelectDept: function onSelectDept(currentRow, oldCurrentRow) {\n      var _this2 = this;\n\n      // console.log(currentRow,oldCurrentRow)\n      if (currentRow) {\n        this.adminTab.strictly = true;\n        this.currentId = currentRow.id;\n        this.$refs.adminMenuTree.setCheckedKeys([]);\n        (0, _request.default)({\n          url: '/auths/menus' + '?' + _qs.default.stringify({\n            type: 'dept',\n            id: currentRow.id\n          }, {\n            indices: false\n          }),\n          method: 'get'\n        }).then(function (res) {\n          _this2.adminTab.data = res;\n          _this2.adminTab.loading = false;\n          _this2.adminTab.strictly = false;\n        });\n      }\n    },\n    // 角色权限配置\n    toQueryRole: function toQueryRole() {\n      var _this = this;\n\n      _this.roleTab.loading = true;\n      var sort = 'level,asc';\n      this.params = {\n        page: this.roleTab.page,\n        size: this.roleTab.size,\n        sort: sort\n      };\n      this.params['blurry'] = _this.roleTab.query.blurry;\n      (0, _request.default)({\n        url: '/api/roles' + '?' + _qs.default.stringify(_this.params, {\n          indices: false\n        }),\n        method: 'get'\n      }).then(function (res) {\n        // console.log(res.content)\n        _this.roleTab.data = res.content;\n        _this.roleTab.total = res.totalElements;\n        _this.roleTab.loading = false;\n      });\n    },\n    onSelectRole: function onSelectRole(currentRow, oldCurrentRow) {\n      var _this3 = this;\n\n      if (currentRow) {\n        this.currentId = currentRow.id;\n        this.adminTab.strictly = true; // this.adminTab.loading = true\n\n        this.currentRoleLevel = currentRow.level;\n        this.$refs.adminMenuTree.setCheckedKeys([]);\n        (0, _request.default)({\n          url: '/auths/menus/role/' + currentRow.id,\n          method: 'get'\n        }).then(function (res) {\n          console.log('======get role auths::', res);\n          _this3.adminTab.data = res.auths;\n          _this3.adminTab.operators = res.operators;\n          _this3.adminTab.strictly = false;\n        });\n      }\n    },\n    rolePageChange: function rolePageChange(e) {\n      this.roleTab.page = e - 1;\n      this.toQueryRole();\n    },\n    roleSizeChange: function roleSizeChange(e) {\n      this.roleTab.page = 0;\n      this.roleTab.size = e;\n      this.toQueryRole();\n    },\n    // 用户权限配置\n    toQueryUser: function toQueryUser() {\n      var _this = this;\n\n      _this.userTab.loading = true;\n      var sort = 'id,desc';\n      this.params = {\n        page: this.userTab.page,\n        size: this.userTab.size,\n        sort: sort\n      };\n      this.params['blurry'] = _this.userTab.query.blurry;\n      (0, _request.default)({\n        url: '/api/users' + '?' + _qs.default.stringify(_this.params, {\n          indices: false\n        }),\n        method: 'get'\n      }).then(function (res) {\n        // console.log(res.content)\n        _this.userTab.data = res.content;\n        _this.userTab.total = res.totalElements;\n        _this.userTab.loading = false;\n      });\n    },\n    onSelectUser: function onSelectUser(currentRow, oldCurrentRow) {\n      var _this4 = this;\n\n      // console.log(currentRow,oldCurrentRow)\n      if (currentRow) {\n        this.adminTab.strictly = true;\n        this.currentId = currentRow.id;\n        this.$refs.adminMenuTree.setCheckedKeys([]);\n        (0, _request.default)({\n          url: '/auth/menus' + '?' + _qs.default.stringify({\n            type: 'user',\n            id: currentRow.id\n          }, {\n            indices: false\n          }),\n          method: 'get'\n        }).then(function (res) {\n          _this4.adminTab.data = res.auths;\n          _this4.adminTab.this.adminTab.strictly = false;\n        });\n      }\n    },\n    userPageChange: function userPageChange(e) {\n      this.userTab.page = e - 1;\n      this.toQueryUser();\n    },\n    userSizeChange: function userSizeChange(e) {\n      this.userTab.page = 0;\n      this.userTab.size = e;\n      this.toQueryUser();\n    },\n    // 加载admin菜单\n\n    /* getAdminmenus() {\r\n      var _this = this\r\n      request({\r\n        url: '/api/menus/tree',\r\n        method: 'get'\r\n      }).then(res => {\r\n        _this.adminTab.data = res\r\n        _this.adminTab.loading = false\r\n      })\r\n    },*/\n    doSaveAdminMenus: function doSaveAdminMenus() {\n      var _this5 = this;\n\n      this.adminTab.menuLoading = true; // var _this = this\n\n      var menus = [];\n      /* this.$refs.adminMenuTree.getHalfCheckedNodes().forEach(function(data, index) {\r\n        menus.push({id:data.id,auth:data.dataAuthType})\r\n      })*/\n      // 得到已选中的 key 值\n\n      console.log('=====getCheckedKeys========', menus, this.$refs.adminMenuTree.getCheckedNodes(false, true));\n      this.$refs.adminMenuTree.getCheckedNodes(false, true).forEach(function (data, index) {\n        menus.push({\n          resourceId: data.id,\n          authorizeType: '03',\n          dataAuthType: data.dataAuthType\n        });\n      });\n      (0, _request.default)({\n        url: '/auths/menus/' + this.currentType + '/' + this.currentId,\n        method: 'post',\n        data: menus\n      }).then(function (res) {\n        _this5.adminTab.menuLoading = false;\n\n        _this5.$notify({\n          title: '保存成功',\n          type: 'success',\n          duration: 2500\n        });\n      });\n    }\n  }\n};\nexports.default = _default;",null]}