{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-802e15e2\"],{2175:function(t,e,a){\"use strict\";a.r(e);var s=a(\"9705\"),i=a(\"4780\");for(var r in i)\"default\"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var o=a(\"2877\"),n=Object(o[\"a\"])(i[\"default\"],s[\"a\"],s[\"b\"],!1,null,\"2eba320a\",null);e[\"default\"]=n.exports},4120:function(t,e,a){\"use strict\";a.r(e),a.d(e,\"add\",(function(){return r})),a.d(e,\"del\",(function(){return o})),a.d(e,\"edit\",(function(){return n})),a.d(e,\"editUser\",(function(){return l})),a.d(e,\"updatePass\",(function(){return c})),a.d(e,\"updateEmail\",(function(){return u}));var s=a(\"c7be\"),i=a(\"37a2\");function r(t){return Object(s[\"default\"])({url:\"api/users\",method:\"post\",data:t})}function o(t){return Object(s[\"default\"])({url:\"api/users\",method:\"delete\",data:t})}function n(t){return Object(s[\"default\"])({url:\"api/users\",method:\"put\",data:t})}function l(t){return Object(s[\"default\"])({url:\"api/users/center\",method:\"put\",data:t})}function c(t){const e={oldPass:Object(i[\"encrypt\"])(t.oldPass),newPass:Object(i[\"encrypt\"])(t.newPass)};return Object(s[\"default\"])({url:\"api/users/updatePass/\",method:\"post\",data:e})}function u(t){const e={password:Object(i[\"encrypt\"])(t.pass),email:t.email};return Object(s[\"default\"])({url:\"api/users/updateEmail/\"+t.code,method:\"post\",data:e})}e[\"default\"]={add:r,edit:n,del:o}},4780:function(t,e,a){\"use strict\";a.r(e);var s=a(\"cf64\"),i=a.n(s);for(var r in s)\"default\"!==r&&function(t){a.d(e,t,(function(){return s[t]}))}(r);e[\"default\"]=i.a},\"4d76\":function(t,e,a){\"use strict\";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticStyle:{display:\"inline-block\"}},[a(\"el-dialog\",{attrs:{visible:t.dialog,\"close-on-click-modal\":!1,\"before-close\":t.cancel,title:t.title,\"append-to-body\":\"\",width:\"550px\"},on:{\"update:visible\":function(e){t.dialog=e},close:t.cancel}},[a(\"el-form\",{ref:\"form\",attrs:{model:t.form,rules:t.rules,size:\"small\",\"label-width\":\"88px\"}},[a(\"el-form-item\",{attrs:{label:\"旧密码\",prop:\"oldPass\"}},[a(\"el-input\",{staticStyle:{width:\"370px\"},attrs:{type:\"password\",\"auto-complete\":\"on\"},model:{value:t.form.oldPass,callback:function(e){t.$set(t.form,\"oldPass\",e)},expression:\"form.oldPass\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"新密码\",prop:\"newPass\"}},[a(\"el-input\",{staticStyle:{width:\"370px\"},attrs:{type:\"password\",\"auto-complete\":\"on\"},model:{value:t.form.newPass,callback:function(e){t.$set(t.form,\"newPass\",e)},expression:\"form.newPass\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"确认密码\",prop:\"confirmPass\"}},[a(\"el-input\",{staticStyle:{width:\"370px\"},attrs:{type:\"password\",\"auto-complete\":\"on\"},model:{value:t.form.confirmPass,callback:function(e){t.$set(t.form,\"confirmPass\",e)},expression:\"form.confirmPass\"}})],1)],1),t._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{attrs:{type:\"text\"},on:{click:t.cancel}},[t._v(\"取消\")]),t._v(\" \"),a(\"el-button\",{attrs:{loading:t.loading,type:\"primary\"},on:{click:t.doSubmit}},[t._v(\"确认\")])],1)],1)],1)},i=[];a.d(e,\"a\",(function(){return s})),a.d(e,\"b\",(function(){return i}))},\"5ecd\":function(t,e,a){\"use strict\";a.r(e);var s=a(\"8865\"),i=a.n(s);for(var r in s)\"default\"!==r&&function(t){a.d(e,t,(function(){return s[t]}))}(r);e[\"default\"]=i.a},\"64b4d\":function(t,e,a){\"use strict\";a.r(e),a.d(e,\"resetEmail\",(function(){return i})),a.d(e,\"updatePass\",(function(){return r}));var s=a(\"c7be\");function i(t){return Object(s[\"default\"])({url:\"api/code/resetEmail\",method:\"post\",data:t})}function r(t){return Object(s[\"default\"])({url:\"api/users/updatePass/\"+t,method:\"get\"})}},6584:function(t,e,a){\"use strict\";a.r(e);var s=a(\"e82a\"),i=a.n(s);for(var r in s)\"default\"!==r&&function(t){a.d(e,t,(function(){return s[t]}))}(r);e[\"default\"]=i.a},8865:function(t,e,a){\"use strict\";var s=a(\"4ea4\");Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var i=s(a(\"4e4a\")),r=a(\"4120\"),o=s(a(\"a78e\")),n={data:function(){var t=this,e=function(e,a,s){a?t.form.newPass!==a?s(new Error(\"两次输入的密码不一致\")):s():s(new Error(\"请再次输入密码\"))};return{loading:!1,dialog:!1,title:\"修改密码\",form:{oldPass:\"\",newPass:\"\",confirmPass:\"\"},rules:{oldPass:[{required:!0,message:\"请输入旧密码\",trigger:\"blur\"}],newPass:[{required:!0,message:\"请输入新密码\",trigger:\"blur\"},{min:6,max:20,message:\"长度在 6 到 16 个字符\",trigger:\"blur\"}],confirmPass:[{required:!0,validator:e,trigger:\"blur\"}]}}},methods:{cancel:function(){this.resetForm(),o.default.remove(\"defaultPass\")},doSubmit:function(){var t=this;this.$refs[\"form\"].validate((function(e){if(!e)return!1;t.loading=!0,(0,r.updatePass)(t.form).then((function(e){t.resetForm(),t.$notify({title:\"密码修改成功，请重新登录\",type:\"success\",duration:1500}),setTimeout((function(){i.default.dispatch(\"LogOut\").then((function(){location.reload()}))}),1500)})).catch((function(e){t.loading=!1}))}))},resetForm:function(){this.dialog=!1,this.$refs[\"form\"].resetFields(),this.form={oldPass:\"\",newPass:\"\",confirmPass:\"\"}}}};e.default=n},\"8fcc\":function(t,e,a){\"use strict\";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"app-container\"},[a(\"el-row\",{attrs:{gutter:20}},[a(\"el-col\",{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{xs:24,sm:24,md:8,lg:6,xl:5}},[a(\"el-card\",{staticClass:\"box-card\"},[a(\"div\",{staticClass:\"clearfix\",attrs:{slot:\"header\"},slot:\"header\"},[a(\"span\",[t._v(\"个人信息\")])]),t._v(\" \"),a(\"div\",[a(\"div\",{staticStyle:{\"text-align\":\"center\"}},[a(\"el-upload\",{staticClass:\"avatar-uploader\",attrs:{\"show-file-list\":!1,\"on-success\":t.handleSuccess,\"on-error\":t.handleError,headers:t.headers,action:t.updateAvatarApi}},[a(\"img\",{staticClass:\"avatar\",attrs:{src:t.user.avatar?t.baseApi+t.user.avatar:t.Avatar,title:\"点击上传头像\"}})])],1),t._v(\" \"),a(\"ul\",{staticClass:\"user-info\"},[a(\"li\",[a(\"div\",{staticStyle:{height:\"100%\"}},[a(\"svg-icon\",{attrs:{\"icon-class\":\"login\"}}),t._v(\" 登录账号\"),a(\"div\",{staticClass:\"user-right\"},[t._v(t._s(t.user.username))])],1)]),t._v(\" \"),a(\"li\",[a(\"svg-icon\",{attrs:{\"icon-class\":\"user1\"}}),t._v(\" 用户昵称 \"),a(\"div\",{staticClass:\"user-right\"},[t._v(t._s(t.user.nickName))])],1),t._v(\" \"),a(\"li\",[a(\"svg-icon\",{attrs:{\"icon-class\":\"phone\"}}),t._v(\" 手机号码 \"),a(\"div\",{staticClass:\"user-right\"},[t._v(t._s(t.user.phone))])],1),t._v(\" \"),a(\"li\",[a(\"svg-icon\",{attrs:{\"icon-class\":\"email\"}}),t._v(\" 用户邮箱 \"),a(\"div\",{staticClass:\"user-right\"},[t._v(t._s(t.user.email))])],1),t._v(\" \"),a(\"li\",[a(\"svg-icon\",{attrs:{\"icon-class\":\"dept\"}}),t._v(\" 所属部门 \"),a(\"div\",{staticClass:\"user-right\"},[t._v(\" \"+t._s(t.user.dept))])],1),t._v(\" \"),a(\"li\",[a(\"svg-icon\",{attrs:{\"icon-class\":\"role\"}}),t._v(\" 用户角色 \"),a(\"div\",{staticClass:\"user-right\"},[t._v(\" \"+t._s(t.user.roles.map((function(t){return t.name})).join(\",\")))])],1),t._v(\" \"),a(\"li\",[a(\"svg-icon\",{attrs:{\"icon-class\":\"anq\"}}),t._v(\" 安全设置\\n              \"),a(\"div\",{staticClass:\"user-right\"},[a(\"a\",{on:{click:function(e){t.$refs.pass.dialog=!0}}},[t._v(\"修改密码\")]),t._v(\" \"),a(\"a\",{on:{click:function(e){t.$refs.email.dialog=!0}}},[t._v(\"修改邮箱\")])])],1)])])])],1),t._v(\" \"),a(\"el-col\",{attrs:{xs:24,sm:24,md:16,lg:18,xl:19}},[a(\"el-card\",{staticClass:\"box-card\"},[a(\"el-tabs\",{on:{\"tab-click\":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:\"activeName\"}},[a(\"el-tab-pane\",{attrs:{label:\"用户资料\",name:\"first\"}},[a(\"el-form\",{ref:\"form\",staticStyle:{\"margin-top\":\"10px\"},attrs:{model:t.form,rules:t.rules,disabled:\"\",size:\"small\",\"label-width\":\"65px\"}},[a(\"el-form-item\",{attrs:{label:\"昵称\",prop:\"nickName\"}},[a(\"el-input\",{staticStyle:{width:\"35%\"},model:{value:t.form.nickName,callback:function(e){t.$set(t.form,\"nickName\",e)},expression:\"form.nickName\"}}),t._v(\" \"),a(\"span\",{staticStyle:{color:\"#C0C0C0\",\"margin-left\":\"10px\"}},[t._v(\"用户昵称不作为登录使用\")])],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"手机号\",prop:\"phone\"}},[a(\"el-input\",{staticStyle:{width:\"35%\"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,\"phone\",e)},expression:\"form.phone\"}}),t._v(\" \"),a(\"span\",{staticStyle:{color:\"#C0C0C0\",\"margin-left\":\"10px\"}},[t._v(\"手机号码不能重复\")])],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"性别\"}},[a(\"el-radio-group\",{staticStyle:{width:\"178px\"},model:{value:t.form.sex,callback:function(e){t.$set(t.form,\"sex\",e)},expression:\"form.sex\"}},[a(\"el-radio\",{attrs:{label:\"男\"}},[t._v(\"男\")]),t._v(\" \"),a(\"el-radio\",{attrs:{label:\"女\"}},[t._v(\"女\")])],1)],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"\"}},[a(\"el-button\",{attrs:{loading:t.saveLoading,type:\"primary\"},on:{click:t.doSubmit}},[t._v(\"保存配置\")])],1)],1)],1),t._v(\" \"),a(\"el-tab-pane\",{attrs:{label:\"操作日志\",name:\"second\"}},[a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.data}},[a(\"el-table-column\",{attrs:{prop:\"description\",label:\"行为\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"requestIp\",label:\"IP\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"browser\",label:\"浏览器\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"time\",label:\"请求耗时\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[e.row.time<=300?a(\"el-tag\",[t._v(t._s(e.row.time)+\"ms\")]):e.row.time<=1e3?a(\"el-tag\",{attrs:{type:\"warning\"}},[t._v(t._s(e.row.time)+\"ms\")]):a(\"el-tag\",{attrs:{type:\"danger\"}},[t._v(t._s(e.row.time)+\"ms\")])]}}])}),t._v(\" \"),a(\"el-table-column\",{attrs:{align:\"right\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[a(\"span\",[t._v(t._s(t.parseTime(e.row.createTime)))])]}}])},[a(\"template\",{slot:\"header\"},[a(\"div\",{staticStyle:{display:\"inline-block\",float:\"right\",cursor:\"pointer\"},on:{click:t.init}},[t._v(\"创建日期\"),a(\"i\",{staticClass:\"el-icon-refresh\",staticStyle:{\"margin-left\":\"40px\"}})])])],2)],1),t._v(\" \"),a(\"el-pagination\",{staticStyle:{\"margin-top\":\"8px\"},attrs:{total:t.total,\"current-page\":t.page+1,layout:\"total, prev, pager, next, sizes\"},on:{\"size-change\":t.sizeChange,\"current-change\":t.pageChange}})],1)],1)],1)],1)],1),t._v(\" \"),a(\"updateEmail\",{ref:\"email\",attrs:{email:t.user.email}}),t._v(\" \"),a(\"updatePass\",{ref:\"pass\"})],1)},i=[];a.d(e,\"a\",(function(){return s})),a.d(e,\"b\",(function(){return i}))},9705:function(t,e,a){\"use strict\";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticStyle:{display:\"inline-block\"}},[a(\"el-dialog\",{attrs:{visible:t.dialog,\"close-on-click-modal\":!1,\"before-close\":t.cancel,title:t.title,\"append-to-body\":\"\",width:\"475px\"},on:{\"update:visible\":function(e){t.dialog=e},close:t.cancel}},[a(\"el-form\",{ref:\"form\",attrs:{model:t.form,rules:t.rules,size:\"small\",\"label-width\":\"88px\"}},[a(\"el-form-item\",{attrs:{label:\"新邮箱\",prop:\"email\"}},[a(\"el-input\",{staticStyle:{width:\"200px\"},attrs:{\"auto-complete\":\"on\"},model:{value:t.form.email,callback:function(e){t.$set(t.form,\"email\",e)},expression:\"form.email\"}}),t._v(\" \"),a(\"el-button\",{attrs:{loading:t.codeLoading,disabled:t.isDisabled,size:\"small\"},on:{click:t.sendCode}},[t._v(t._s(t.buttonName))])],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"验证码\",prop:\"code\"}},[a(\"el-input\",{staticStyle:{width:\"320px\"},model:{value:t.form.code,callback:function(e){t.$set(t.form,\"code\",e)},expression:\"form.code\"}})],1),t._v(\" \"),a(\"el-form-item\",{attrs:{label:\"当前密码\",prop:\"pass\"}},[a(\"el-input\",{staticStyle:{width:\"320px\"},attrs:{type:\"password\"},model:{value:t.form.pass,callback:function(e){t.$set(t.form,\"pass\",e)},expression:\"form.pass\"}})],1)],1),t._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{attrs:{type:\"text\"},on:{click:t.cancel}},[t._v(\"取消\")]),t._v(\" \"),a(\"el-button\",{attrs:{loading:t.loading,type:\"primary\"},on:{click:t.doSubmit}},[t._v(\"确认\")])],1)],1)],1)},i=[];a.d(e,\"a\",(function(){return s})),a.d(e,\"b\",(function(){return i}))},b99c:function(t,e,a){},cf64:function(t,e,a){\"use strict\";var s=a(\"4ea4\");Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var i=s(a(\"4e4a\")),r=a(\"6d5c\"),o=a(\"4120\"),n=a(\"64b4d\"),l={props:{email:{type:String,required:!0}},data:function(){var t=this,e=function(e,a,s){\"\"===a||null===a?s(new Error(\"新邮箱不能为空\")):a===t.email?s(new Error(\"新邮箱不能与旧邮箱相同\")):(0,r.validEmail)(a)?s():s(new Error(\"邮箱格式错误\"))};return{loading:!1,dialog:!1,title:\"修改邮箱\",form:{pass:\"\",email:\"\",code:\"\"},user:{email:\"\",password:\"\"},codeLoading:!1,codeData:{type:\"email\",value:\"\"},buttonName:\"获取验证码\",isDisabled:!1,time:60,rules:{pass:[{required:!0,message:\"当前密码不能为空\",trigger:\"blur\"}],email:[{required:!0,validator:e,trigger:\"blur\"}],code:[{required:!0,message:\"验证码不能为空\",trigger:\"blur\"}]}}},methods:{cancel:function(){this.resetForm()},sendCode:function(){var t=this;if(this.form.email&&this.form.email!==this.email){this.codeLoading=!0,this.buttonName=\"验证码发送中\",this.codeData.value=this.form.email;var e=this;(0,n.resetEmail)(this.codeData).then((function(a){t.$message({showClose:!0,message:\"发送成功，验证码有效期5分钟\",type:\"success\"}),t.codeLoading=!1,t.isDisabled=!0,t.buttonName=t.time--+\"秒后重新发送\",t.timer=window.setInterval((function(){e.buttonName=e.time+\"秒后重新发送\",--e.time,e.time<0&&(e.buttonName=\"重新发送\",e.time=60,e.isDisabled=!1,window.clearInterval(e.timer))}),1e3)})).catch((function(e){t.resetForm(),t.codeLoading=!1}))}},doSubmit:function(){var t=this;this.$refs[\"form\"].validate((function(e){if(!e)return!1;t.loading=!0,(0,o.updateEmail)(t.form).then((function(e){t.loading=!1,t.resetForm(),t.$notify({title:\"邮箱修改成功\",type:\"success\",duration:1500}),i.default.dispatch(\"GetInfo\").then((function(){}))})).catch((function(e){t.loading=!1}))}))},resetForm:function(){this.dialog=!1,this.$refs[\"form\"].resetFields(),window.clearInterval(this.timer),this.time=60,this.buttonName=\"获取验证码\",this.isDisabled=!1,this.form={pass:\"\",email:\"\",code:\"\"}}}};e.default=l},dc6c:function(t,e,a){\"use strict\";a.r(e);var s=a(\"8fcc\"),i=a(\"6584\");for(var r in i)\"default\"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a(\"ec76\");var o=a(\"2877\"),n=Object(o[\"a\"])(i[\"default\"],s[\"a\"],s[\"b\"],!1,null,null,null);e[\"default\"]=n.exports},e82a:function(t,e,a){\"use strict\";var s=a(\"4ea4\");Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0,a(\"7f7f\");var i=s(a(\"ded3\")),r=a(\"2f62\"),o=s(a(\"f9e2\")),n=s(a(\"2175\")),l=a(\"d0c1\"),c=s(a(\"4e4a\")),u=a(\"6d5c\"),d=a(\"10ef\"),f=s(a(\"1cf4\")),m=a(\"4120\"),p=s(a(\"7c9a\")),v={name:\"Center\",components:{updatePass:o.default,updateEmail:n.default},mixins:[f.default],data:function(){var t=function(t,e,a){e?(0,u.isvalidPhone)(e)?a():a(new Error(\"请输入正确的11位手机号码\")):a(new Error(\"请输入电话号码\"))};return{Avatar:p.default,activeName:\"first\",saveLoading:!1,headers:{Authorization:(0,l.getToken)()},form:{},rules:{nickName:[{required:!0,message:\"请输入用户昵称\",trigger:\"blur\"},{min:2,max:20,message:\"长度在 2 到 20 个字符\",trigger:\"blur\"}],phone:[{required:!0,trigger:\"blur\",validator:t}]}}},computed:(0,i.default)({},(0,r.mapGetters)([\"user\",\"updateAvatarApi\",\"baseApi\"])),created:function(){this.form={id:this.user.id,nickName:this.user.nickName,sex:this.user.sex,phone:this.user.phone},c.default.dispatch(\"GetInfo\").then((function(){}))},methods:{parseTime:d.parseTime,handleClick:function(t,e){\"second\"===t.name&&this.init()},beforeInit:function(){return this.url=\"api/logs/user\",!0},handleSuccess:function(t,e,a){this.$notify({title:\"头像修改成功\",type:\"success\",duration:2500}),c.default.dispatch(\"GetInfo\").then((function(){}))},handleError:function(t,e,a){var s=JSON.parse(t.message);this.$notify({title:s.message,type:\"error\",duration:2500})},doSubmit:function(){var t=this;this.$refs[\"form\"]&&this.$refs[\"form\"].validate((function(e){e&&(t.saveLoading=!0,(0,m.editUser)(t.form).then((function(){t.editSuccessNotify(),c.default.dispatch(\"GetInfo\").then((function(){})),t.saveLoading=!1})).catch((function(){t.saveLoading=!1})))}))}}};e.default=v},ec76:function(t,e,a){\"use strict\";a(\"b99c\")},f9e2:function(t,e,a){\"use strict\";a.r(e);var s=a(\"4d76\"),i=a(\"5ecd\");for(var r in i)\"default\"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var o=a(\"2877\"),n=Object(o[\"a\"])(i[\"default\"],s[\"a\"],s[\"b\"],!1,null,\"c3c7a4a0\",null);e[\"default\"]=n.exports}}]);","extractedComments":[]}