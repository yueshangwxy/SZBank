import store from '@/store'
import checkPermission from '../../utils/permission'

export default {
  inserted(el, binding, vnode) {
    //console.log('=====permesion=>', binding)
    const {value} = binding
    // const authorizes = store.getters && store.getters.authorizes
    if (value && value instanceof Array && value.length > 0) {
      if (value.indexOf('admin') < 0) {
        value.push('admin')
      }
      if (!checkPermission(value)) {
        el.parentNode && el.parentNode.removeChild(el)
      }
    } else {
      throw new Error(`${value},使用方式： v-permission="['admin','editor']"`)
    }
  }
}
