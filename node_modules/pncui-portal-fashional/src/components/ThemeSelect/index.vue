<template>
  <div v-show="showThemeSelect">
    <el-dropdown trigger="click" @command="handleSetTheme">
      <div>
        <el-tooltip :content="currentStyle.name">
          <el-link>
            <svg-icon icon-class="theme"/>
            <!-- {{currentStyle.name}}-->
          </el-link>
        </el-tooltip>
      </div>
      <el-dropdown-menu slot="dropdown">
        <template v-for="layout in data">
          <el-dropdown-item
            v-for="item in layout.style"
            :key="layout.id+'.'+item.id"
            :disabled="item.id == currentTheme"
            :command="{layout:layout.id,style:item.id,name:item.name}"
          >
            {{ layout.name }} - {{ item.name }}
          </el-dropdown-item>
        </template>
      </el-dropdown-menu>
    </el-dropdown>
    <component :is="cstyle"></component>
  </div>
</template>

<script>
  import config from '../../../public/themes/config.json'
  import { mapGetters } from 'vuex'
  import settings from '@public/config/settings.js'
  //import classic$white from '@/layout/classic/styles/white'
  //import default$blue from '@/layout/default/styles/blue'
  // import default$default from '@/layout/default/styles/default'

  export default {
    inject: ['reload'],
    name: 'ThemeSelect',
    data() {
      return {
        currentTheme: '',
        data: config,
        cstyle: () => require(`../../layout/styles/${this.getStyle()['style']}`)
      }
    },
    components: {},
    computed: {
      currentStyle() {
        return this.getStyle()
      },
      showThemeSelect() {
        console.log('========>>>',settings)
        return settings.showThemeSelect
      }
    },
    methods: {
      handleSetTheme(theme) {
        this.$store.dispatch('setStyle', theme)
        //this.$router.push({ path: '/refresh?time=' + new Date() })
        //this.reload()
        window.location.reload(true)
      },
      ...mapGetters(['getStyle'])
    }
  }
</script>
